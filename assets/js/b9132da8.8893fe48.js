"use strict";(self.webpackChunkninjee=self.webpackChunkninjee||[]).push([[5187],{4137:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return N}});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=a.createContext({}),k=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},m=function(e){var n=k(e.components);return a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=k(t),N=l,s=u["".concat(p,".").concat(N)]||u[N]||d[N]||r;return t?a.createElement(s,i(i({ref:n},m),{},{components:t})):a.createElement(s,i({ref:n},m))}));function N(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=u;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:l,i[1]=o;for(var k=2;k<r;k++)i[k]=t[k];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},4375:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return p},default:function(){return N},frontMatter:function(){return o},metadata:function(){return k},toc:function(){return d}});var a=t(7462),l=t(3366),r=(t(7294),t(4137)),i=["components"],o={title:"15. async/await, \u5f02\u6b65\u7f16\u7a0b",sidebar_position:15,date:new Date("2022-08-01T00:00:00.000Z"),tags:["JavaScript"]},p=void 0,k={unversionedId:"frontEnd/JavaScript/async:await, \u5f02\u6b65\u7f16\u7a0b",id:"frontEnd/JavaScript/async:await, \u5f02\u6b65\u7f16\u7a0b",title:"15. async/await, \u5f02\u6b65\u7f16\u7a0b",description:"\u672c\u6587\u662f\u5f02\u6b65\u7f16\u7a0b\uff08\u4e0b\uff09\uff0c\u5185\u5bb9\u4e3b\u8981\u5305\u62ec\uff1a",source:"@site/docs/frontEnd/JavaScript/15-async:await, \u5f02\u6b65\u7f16\u7a0b.md",sourceDirName:"frontEnd/JavaScript",slug:"/frontEnd/JavaScript/async:await, \u5f02\u6b65\u7f16\u7a0b",permalink:"/docs/frontEnd/JavaScript/async:await, \u5f02\u6b65\u7f16\u7a0b",tags:[{label:"JavaScript",permalink:"/docs/tags/java-script"}],version:"current",sidebarPosition:15,frontMatter:{title:"15. async/await, \u5f02\u6b65\u7f16\u7a0b",sidebar_position:15,date:"2022-08-01T00:00:00.000Z",tags:["JavaScript"]},sidebar:"JavaScript",previous:{title:"14. Iterator, Generator.md",permalink:"/docs/frontEnd/JavaScript/Iterator, Generator"},next:{title:"\u6d4f\u89c8\u5668\u76f8\u5173\u95ee\u9898",permalink:"/docs/frontEnd/JavaScript/Js\u9762\u8bd5\u9898\u6574\u7406"}},m={},d=[{value:"0 \u5f15\u5b50",id:"0-\u5f15\u5b50",level:2},{value:"1 \u8fed\u4ee3\u76f8\u5173\uff1a",id:"1-\u8fed\u4ee3\u76f8\u5173",level:4},{value:"2 \u5f02\u6b65\u76f8\u5173\uff1a",id:"2-\u5f02\u6b65\u76f8\u5173",level:4},{value:"3 \u8fed\u4ee3 + \u5f02\u6b65\uff1a",id:"3-\u8fed\u4ee3--\u5f02\u6b65",level:4},{value:"1 iterator \u8fed\u4ee3\u5668",id:"1-iterator-\u8fed\u4ee3\u5668",level:2},{value:"1.1 Iterator \u63a5\u53e3",id:"11-iterator-\u63a5\u53e3",level:3},{value:"1.2 iterable object \u53ef\u8fed\u4ee3\u5bf9\u8c61",id:"12-iterable-object-\u53ef\u8fed\u4ee3\u5bf9\u8c61",level:3},{value:"1.3 \u5185\u7f6e\u53ef\u8fed\u4ee3\u5bf9\u8c61",id:"13-\u5185\u7f6e\u53ef\u8fed\u4ee3\u5bf9\u8c61",level:3},{value:"1.4 <code>return()</code> \u548c <code>throw()</code>",id:"14-return-\u548c-throw",level:3},{value:"1.5 <code>for..of</code> \u904d\u5386 iterator",id:"15-forof-\u904d\u5386-iterator",level:3},{value:"2 generator / yield \u751f\u6210\u5668",id:"2-generator--yield-\u751f\u6210\u5668",level:2},{value:"2.1 generator",id:"21-generator",level:3},{value:"2.2 generator \u65b9\u6cd5",id:"22-generator-\u65b9\u6cd5",level:3},{value:"2.2.1 <code>return()</code>",id:"221-return",level:4},{value:"2.2.2 <code>throw()</code>",id:"222-throw",level:4},{value:"2.3 yield",id:"23-yield",level:3},{value:"2.4 yield*",id:"24-yield",level:3},{value:"2.5 \u5e94\u7528",id:"25-\u5e94\u7528",level:3},{value:"3 Async / await  \u5f02\u6b65\u7f16\u7a0b",id:"3-async--await--\u5f02\u6b65\u7f16\u7a0b",level:2},{value:"3.1 <code>await</code>",id:"31-await",level:3},{value:"3.2 Error \u5904\u7406",id:"32-error-\u5904\u7406",level:3},{value:"<code>try...catch</code>",id:"trycatch",level:4},{value:"4 async generator \u5f02\u6b65\u8fed\u4ee3",id:"4-async-generator-\u5f02\u6b65\u8fed\u4ee3",level:2},{value:"4.1 \u5f02\u6b65\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61 async iterable object",id:"41-\u5f02\u6b65\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61-async-iterable-object",level:3},{value:"4.2 async generator \u5f02\u6b65\u751f\u6210\u5668",id:"42-async-generator-\u5f02\u6b65\u751f\u6210\u5668",level:3},{value:"4.3 <code>async [Symbol.asyncIterator]</code>",id:"43-async-symbolasynciterator",level:3},{value:"4.4 \u603b\u7ed3",id:"44-\u603b\u7ed3",level:3}],u={toc:d};function N(e){var n=e.components,o=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},u,o,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u672c\u6587\u662f\u5f02\u6b65\u7f16\u7a0b\uff08\u4e0b\uff09\uff0c\u5185\u5bb9\u4e3b\u8981\u5305\u62ec\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5f02\u6b65\u7f16\u7a0b\u7684\u6f14\u53d8"),(0,r.kt)("li",{parentName:"ol"},"async / await"),(0,r.kt)("li",{parentName:"ol"},"generator\u3001async \u548c promise")),(0,r.kt)("h2",{id:"0-\u5f15\u5b50"},"0 \u5f15\u5b50"),(0,r.kt)("p",null,"\u7b80\u8981\u4ecb\u7ecd\u5f02\u6b65\u7f16\u7a0b\u76f8\u5173\u7684\u77e5\u8bc6\u70b9\uff1a"),(0,r.kt)("h4",{id:"1-\u8fed\u4ee3\u76f8\u5173"},"1 \u8fed\u4ee3\u76f8\u5173\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Iterator"),"\uff1a\u4e00\u4e2a\u8fed\u4ee3\u5668\u5305\u542b\u4e86\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u5faa\u73af\u8fed\u4ee3\u51fa\u6240\u5728\u5bf9\u8c61\u7684\u6240\u6709\u503c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"iterable object"),"\uff1a\u5f53\u4e00\u4e2a\u5bf9\u8c61\u5305\u542b iterator \u8fed\u4ee3\u5668\u7684\u5bf9\u8c61\uff0c\u540c\u65f6\u62e5\u6709\u4e00\u4e2a  ",(0,r.kt)("inlineCode",{parentName:"p"},"Symbol.iterator")," \u65b9\u6cd5\u540e\uff0c\u5c31\u53ef\u4ee5\u5229\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"for...of")," \u81ea\u52a8\uff0c"),(0,r.kt)("p",null,"\u6216 ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()")," \u624b\u52a8\u8fed\u4ee3\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"generator / yield"),"\uff1a \u662f\u4e00\u4e2a\u751f\u6210\u5668\uff0c\u901a\u8fc7\u8fd9\u4e2a\u751f\u6210\u5668\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u7684\u968f\u65f6\u6682\u505c / \u91cd\u542f\u4e00\u4e2a\u51fd\u6570\u7684\u6267\u884c\uff0c\u540c\u65f6\u5efa\u7acb\u4e86\u4e00\u4e2a\u548c\u8c03\u7528\u8005\u53cc\u5411\u4f20\u9012\u7684\u901a\u9053\uff0c\u53ef\u4ee5\u591a\u6b21\u7684\u4f20\u5165 / \u4f20\u51fa\u503c\u3002generator \u7684\u5b9e\u73b0\u539f\u7406\uff0c\u5c31\u662f\u5229\u7528\u4e86 iterator \u8fed\u4ee3\u5668\u3002\u5f53\u751f\u6210\u5668\u51fd\u6570\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u5904\u6682\u505c\u540e\uff0c\u4f1a\u5904\u4e8e\u6682\u65f6\u6302\u8d77\u72b6\u6001\uff0c\u5176\u51fd\u6570\u672c\u8eab\u4f9d\u7136\u5728\u8c03\u7528\u6808\u4e2d\u5b58\u5728\u3002"),(0,r.kt)("h4",{id:"2-\u5f02\u6b65\u76f8\u5173"},"2 \u5f02\u6b65\u76f8\u5173\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"promise"),"\uff1a\u4f18\u5316\u4e86\u5f02\u6b65\u7f16\u7a0b\u7684\u5f62\u5f0f\uff0c\u4f20\u7edf\u4f9d\u8d56\u56de\u8c03\u7684\u5f02\u6b65\u7f16\u7a0b\uff0c\u7ecf\u5e38\u4f1a\u51fa\u73b0\u56de\u8c03\u5730\u72f1\u3002\u91c7\u7528\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise")," \u540e\uff0c\u5c31\u6709\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"then")," \u94fe\uff0c\u4f7f\u5f02\u6b65\u7f16\u7a0b\u7684\u96be\u5ea6\u5f97\u5230\u7f13\u89e3\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"async / await"),"\uff1a\u662f\u4e00\u4e2a\u8fdb\u4e00\u6b65\u4f18\u5316\u7684\u5f02\u6b65\u7f16\u7a0b\u7684\u5f62\u5f0f\uff0c\u5b83\u672c\u8d28\u662f\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"promise")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"p.then()")," \u7684\u8bed\u6cd5\u7cd6\uff0c\u4f18\u5316\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"then")," \u94fe\u7684\u7f16\u7a0b\u65b9\u5f0f\u3002\u53ef\u4ee5\u96c6\u4e2d\u5904\u7406 rejected promise\u3001\u66f4\u4e13\u6ce8\u4e8e\u5bf9 promise \u6210\u529f\u56de\u8c03\u540e\u7684\u5904\u7406\u3002"),(0,r.kt)("h4",{id:"3-\u8fed\u4ee3--\u5f02\u6b65"},"3 \u8fed\u4ee3 + \u5f02\u6b65\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"async generator"),"\uff1a\u5b9e\u8d28\u4e0a\u662f promise + generator \u7684\u4f18\u5316\u7248\u672c\u3002promise \u4ee4 generator \u62e5\u6709\u4e86\u5f02\u6b65\u8fed\u4ee3\u7684\u80fd\u529b\u3002\u4e5f\u5c31\u662f generator \u6bcf\u6b21\u8fed\u4ee3\u90fd\u662f\u5f02\u6b65\u83b7\u53d6\u503c\u7684\uff0c\u4e00\u65e6\u83b7\u53d6\u5230\u503c\uff0c\u5c31\u81ea\u52a8\u7684\u628a\u503c\u8fd4\u56de\u7ed9\u8c03\u7528\u8005\u3002\u8c03\u7528\u8005\u53ef\u4ee5\u5229\u7528\u5728 async \u73af\u5883\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"for await ...of")," \u6765\u904d\u5386\u51faasync generator \u5f02\u6b65\u83b7\u53d6\u7684\u503c\u3002"),(0,r.kt)("h2",{id:"1-iterator-\u8fed\u4ee3\u5668"},"1 iterator \u8fed\u4ee3\u5668"),(0,r.kt)("p",null,"\u5b9a\u4e49\uff1a"),(0,r.kt)("p",null,"\u8fed\u4ee3\u5668\uff08iterator\uff09\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u7528\u6237\u53ef\u5728\u5bb9\u5668\u5bf9\u8c61\uff08container\uff0c\u4f8b\u5982\u94fe\u8868\u6216\u6570\u7ec4\uff09\u4e0a\u904d\u5386\uff0c\u4f7f\u7528\u8be5\u63a5\u53e3\u65e0\u9700\u5173\u5fc3\u5bf9\u8c61\u7684\u5185\u90e8\u5b9e\u73b0\u7ec6\u8282\u3002 "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u5b9e\u73b0\u4e2d\uff0c\u8fed\u4ee3\u5668\u7684\u5b9e\u73b0\u65b9\u5f0f\u5404\u4e0d\u76f8\u540c\uff0c\u4f46\u662f\u57fa\u672c\u90fd\u6709\u8fed\u4ee3\u5668\uff0c\u6bd4\u5982Java\u3001Python\u7b49\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u8fed\u4ee3\u5668\u662f\u5e2e\u52a9\u6211\u4eec\u5bf9\u67d0\u4e2a\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u904d\u5386\u7684\u5bf9\u8c61\u3002")),(0,r.kt)("p",null,"Js \u4e2d\u7684\u8fed\u4ee3\u5668\uff1a"),(0,r.kt)("p",null,"\u5728 JavaScript \u4e2d\uff0c\u8fed\u4ee3\u5668\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u7b26\u5408\u8fed\u4ee3\u5668\u534f\u8bae iterator protocol"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"iterator protocol \u534f\u8bae\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u503c\u7684\u4ea7\u751f\u6807\u51c6\u65b9\u5f0f\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u5728 JavaScript \u4e2d\uff0c\u8fd9\u4e2a\u6807\u51c6\u5c31\u662f\u4e00\u4e2a\u7279\u5b9a\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()")," \u65b9\u6cd5\u3002")),(0,r.kt)("h3",{id:"11-iterator-\u63a5\u53e3"},"1.1 Iterator \u63a5\u53e3"),(0,r.kt)("p",null,"Iterator \u662f\u4e00\u4e2a\u83b7\u53d6\u5bf9\u8c61\u7684\u65b9\u5f0f\u3002\u6211\u4eec\u628a\u8c03\u7528 iterator \u7684\u4e00\u65b9\u79f0\u4e4b\u4e3a\u6d88\u8d39\u8005\u3002\u5b83\u6d88\u8d39 iterator \u751f\u4ea7\u7684\u503c\uff1b\u628a iterator \u79f0\u4e4b\u4e3a\u751f\u4ea7\u8005\uff0c\u5b83\u4e3a\u6d88\u8d39\u8005\u63d0\u4f9b\u503c\u3002"),(0,r.kt)("p",null,"\u89c4\u8303\u4e2d\uff0cIterator \u63a5\u53e3\u9700\u8981\u5982\u4e0b\u7ed3\u6784\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u65b9\u6cd5\uff1a\u7528\u6765\u53d6\u5f97\u4e0b\u4e00\u4e2a IteratorResult\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4e24\u4e2a\u53ef\u9009\u65b9\u6cd5\uff1a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"return()")," \u65b9\u6cd5\uff1a\u505c\u6b62\u8fed\u4ee3\u5668\uff0c\u5e76\u8fd4\u56de IteratorResult"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"throw()")," \u65b9\u6cd5\uff1a\u62a5\u9519\uff0c\u5e76\u8fd4\u56de IteratorResult"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"IteratorResult \u63a5\u53e3\u3002\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u540e\u5f97\u7684 IteratorResult \u5bf9\u8c61\uff0c\u6709\u4e24\u4e2a\u5c5e\u6027\uff1a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"done\uff1aboolean"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u8fed\u4ee3\u5668\u53ef\u4ee5\u4ea7\u751f\u5e8f\u5217\u4e2d\u7684\u4e0b\u4e00\u4e2a\u503c\uff0c\u5219\u4e3a false\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u8fed\u4ee3\u5668\u5df2\u5c06\u5e8f\u5217\u8fed\u4ee3\u5b8c\u6bd5\uff0c\u5219\u4e3a true\u3002")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"value\uff1a\u8fd4\u56de\u8fed\u4ee3\u7684\u503c\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"done \u4e3a true \u662f\u53ef\u7701\u7565\uff0c\u5982\u679c\u6709\u503c\uff0c\u5219\u4e3a\u8fed\u4ee3\u7ed3\u675f\u4e4b\u540e\u7684\u9ed8\u8ba4\u8fd4\u56de\u503c\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e3a  ",(0,r.kt)("inlineCode",{parentName:"li"},"{done: true, value: undefind}")," \u8868\u793a\u5df2\u7ecf\u5168\u90e8\u904d\u5386\u5b8c\u6bd5\u3002")))))))),(0,r.kt)("p",null,"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7b26\u5408\u6807\u51c6\u7684\u8fed\u4ee3\u5668\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// \u521b\u5efa\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\u6765\u8bbf\u95ee\u6570\u7ec4\nfunction createArrayIterator(arr) {\n  let index = 0\n  return {\n    next: function() {\n      if (index < arr.length) {\n        return { done: false, value: arr[index++] }\n      } else {\n        return { done: true, value: undefined } \n      }\n    }\n  }\n}\n\nconst names = ["abc", "cba", "nba"];\nconst namesIterator = createArrayIterator(names);\nconsole.log(namesIterator.next()) // {done: false, value: \'abc\'}\nconsole.log(namesIterator.next()) // {done: false, value: \'cba\'}\nconsole.log(namesIterator.next()) // { done: false, value: "nba" }\nconsole.log(namesIterator.next()) // { done: true, value: undefined }\nconsole.log(namesIterator.next()) // { done: true, value: undefined }\n')),(0,r.kt)("h3",{id:"12-iterable-object-\u53ef\u8fed\u4ee3\u5bf9\u8c61"},"1.2 iterable object \u53ef\u8fed\u4ee3\u5bf9\u8c61"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"iterator")," \u8fed\u4ee3\u5668\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u7b26\u5408\u8fed\u4ee3\u5668\u534f\u8bae\uff08iterator protocol\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728 JavaScript \u4e2d\u8868\u73b0\u4e3a\uff0c\u5b83\u62e5\u6709\u4e00\u4e2a\u7b26\u5408\u6807\u51c6\u7684  ",(0,r.kt)("inlineCode",{parentName:"li"},"next()")," \u65b9\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5728 ES6 \u4e2d\uff0c\u8fed\u4ee3\u5668\u51fd\u6570\u7684\u540d\u79f0\u89c4\u5b9a\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"Symbol.iterator"),"\u3002")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"iterable object")," \u53ef\u8fed\u4ee3\u7684\u5bf9\u8c61\uff0c\u5b83\u662f\u4e00\u4e2a iterator \u8fed\u4ee3\u5668\u7684\u666e\u901a\u5bf9\u8c61\uff0c\u5b83\u7b26\u5408\u53ef\u8fed\u4ee3\u534f\u8bae\uff08iterable protocol\uff09\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728 JavaScript \u4e2d\u8868\u73b0\u4e3a\uff0c\u5b83\u5fc5\u987b\u5b9e\u73b0 @@itartor \u65b9\u6cd5\uff0c\u901a\u8fc7",(0,r.kt)("inlineCode",{parentName:"li"},"Symbol.iterator")," \u8bbf\u95ee\u3002\t\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u65f6\uff0c\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5bf9\u5916\u8868\u73b0\u4e3a\uff1a\u53ef\u4ee5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"for..of")," \u904d\u5386\u503c\u7684\u5bf9\u8c61\uff0c\u88ab\u79f0\u4e3a\u4e00\u4e2a ",(0,r.kt)("strong",{parentName:"li"},"\u53ef\u8fed\u4ee3\u7684\u5bf9\u8c61"),"\u3002")),(0,r.kt)("p",null,"\u89e3\u91ca ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.iterator]"),"\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[...]")," \u662f\u8ba1\u7b97\u5c5e\u6027\u540d\u3002\u6307\u5b9a\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5e76\u7528\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4f5c\u4e3a\u5c5e\u6027\u7684\u540d\u79f0\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Symbol.iterator")," \u662fES6 \u9884\u5b9a\u4e49\u7684\u7279\u6b8a Symbol \u503c\u4e4b\u4e00\u3002")),(0,r.kt)("p",null,"\u8981\u70b9\uff1a\u53ef\u8fed\u4ee3\u5bf9\u8c61\u5fc5\u987b\u6709\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"Symbol.iterator")," \u65b9\u6cd5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"obj[Symbol.iterator]()")," \u4f1a\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff08iterator\uff09\u51fd\u6570\uff0c\u7531\u5b83\u5904\u7406\u8fdb\u4e00\u6b65\u7684\u8fed\u4ee3\u8fc7\u7a0b\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Symbol.iterator")," \u65b9\u6cd5\u4f1a\u88ab ",(0,r.kt)("inlineCode",{parentName:"p"},"for..of")," \u81ea\u52a8\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u624b\u5de5\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u5b9e\u73b0\u904d\u5386\u3002"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("inlineCode",{parentName:"p"},"for ... of")," \u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u81ea\u52a8 ",(0,r.kt)("inlineCode",{parentName:"p"},"next")," \u7684\u8bed\u6cd5\u7cd6\u3002"),(0,r.kt)("p",{parentName:"blockquote"},"\u6240\u4ee5\u666e\u901a\u5bf9\u8c61\u4e0d\u652f\u6301 for...of \u7684\u539f\u56e0\uff0c\u5c31\u662f\u666e\u901a\u5bf9\u8c61\u4e0d\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\u3002")),(0,r.kt)("p",null,"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u521b\u5efa\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\u6765\u8bbf\u95ee\u6570\u7ec4\nconst iterableObj = {\n  names: [\"abc\", \"cba\", \"nba\"],\n  [Symbol.iterator]: function() {\n    let index = 0\n    return {\n      next: () => {   // next \u65b9\u6cd5\u4f7f\u7528\u7bad\u5934\u51fd\u6570\uff0c\u4f7fthis\u56fa\u5b9a\u6307\u5411iterableObj\n        if (index < this.names.length) {\n          return { done: false, value: this.names[index++] }\n        } else {\n          return { done: true, value: undefined }\n        }\n      }\n    }\n  }\n}\n\n// iterableObj\u5bf9\u8c61\u5c31\u662f\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\nconst iterator = iterableObj[Symbol.iterator]();\niterator.next()   // {done: false, value: 'abc'}\niterator.next()   // {done: false, value: 'cba'}\niterator.next()   // {done: false, value: 'nba'}\niterator.next()   // {done: true, value: undefined}\n\n// \u4f7f\u7528 for..of \u81ea\u52a8\u8fed\u4ee3\nfor (const n of itarableObj) {\n    console.log(n); // abc  cba  nba\n}\n")),(0,r.kt)("h3",{id:"13-\u5185\u7f6e\u53ef\u8fed\u4ee3\u5bf9\u8c61"},"1.3 \u5185\u7f6e\u53ef\u8fed\u4ee3\u5bf9\u8c61"),(0,r.kt)("p",null,"\u53ef\u8fed\u4ee3\u5bf9\u8c61 / \u652f\u6301 Iterable \u63a5\u53e3\u7684\u5185\u7f6e\u7c7b\u578b / \u5b9e\u73b0\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"Symbol.iterator"),"\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"String"),(0,r.kt)("li",{parentName:"ul"},"Array"),(0,r.kt)("li",{parentName:"ul"},"Map\u3001Set\u3001WeakMap\u3001WeakSet"),(0,r.kt)("li",{parentName:"ul"},"arguments \u5bf9\u8c61\uff08\u7c7b\u6570\u7ec4\u5bf9\u8c61\uff09"),(0,r.kt)("li",{parentName:"ul"},"DOM \u7684\u4e00\u4e9b\u96c6\u5408\u7c7b\u578b\uff1aNodeList \u7b49")),(0,r.kt)("p",null,"\u53ef\u4ee5\u5e94\u7528 Iterable \u63a5\u53e3\uff08\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff09\u7684\u7ed3\u6784\u6709\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"JavaScript \u8bed\u6cd5\uff084\uff09",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"for..of")),(0,r.kt)("li",{parentName:"ul"},"generator\u3001yield*"),(0,r.kt)("li",{parentName:"ul"},"\u89e3\u6784\u8fd0\u7b97\uff08\u6570\u7ec4\uff09"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"...")," \u6269\u5c55\u64cd\u4f5c\u7b26\uff08\u6570\u7ec4\uff09",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6ce8\uff1a\u666e\u901a\u5bf9\u8c61\u4e0d\u53ef\u8fed\u4ee3\uff0c\u5bf9\u8c61\u7684\u6269\u5c55 / \u89e3\u6784\uff08ES2018\uff09\u4e0d\u662f\u901a\u8fc7\u8fed\u4ee3\u5668\u5b9e\u73b0\u7684\u3002"))))),(0,r.kt)("li",{parentName:"ul"},"\u5bf9\u8c61\u521b\u5efa\uff084\uff09\uff1aSet\u3001Map \u3001WeakMap\u3001WeakSet"),(0,r.kt)("li",{parentName:"ul"},"\u65b9\u6cd5\u8c03\u7528\uff082\uff09\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Arrray.from()")," \u6570\u7ec4\u8f6c\u5316\u5e76\u521b\u5efa"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Promise.all()")," \u3001",(0,r.kt)("inlineCode",{parentName:"li"},"Promise.race()"),"\u7b49\uff0c\u53c2\u6570\u662f\u7531 Promise \u7ec4\u6210\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\u3002")))),(0,r.kt)("h3",{id:"14-return-\u548c-throw"},"1.4 ",(0,r.kt)("inlineCode",{parentName:"h3"},"return()")," \u548c ",(0,r.kt)("inlineCode",{parentName:"h3"},"throw()")),(0,r.kt)("p",null,"\u904d\u5386\u5668\u5bf9\u8c61\u9664\u4e86\u5177\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \uff0c\u8fd8\u53ef\u4ee5\u5177\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"return()")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"throw()")," \u3002\u5982\u679c\u81ea\u5df1\u5199\u904d\u5386\u5668\u5bf9\u8c61\u751f\u6210\u51fd\u6570\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"next()"),"\u5fc5\u987b\u90e8\u7f72\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"return()")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"throw()")," \u662f\u53ef\u9009\u7684\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6d88\u8d39\u8005\uff1a\u9700\u8981\u503c\u7684\u5bf9\u8c61\uff0c\u8c03\u7528 iterator \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()"),"\uff0c\u6bcf\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()")," \u4f1a\u83b7\u5f97\u4e00\u4e2a IteratorResult \u3002"),(0,r.kt)("li",{parentName:"ul"},"\u751f\u4ea7\u8005\uff1a\u63d0\u4f9b\u503c\u7684\u5bf9\u8c61\u3002\u5c31\u662f\u672c\u8282\u7684 iterator\uff0c\u5b83\u53ef\u4ee5\u4ea7\u751f\u503c\u3002")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"return()")," \uff1a"),(0,r.kt)("p",null,"\u6d88\u8d39\u8005\u63d0\u524d\u7ec8\u6b62 Iterator \u7684\u81ea\u52a8\u904d\u5386\uff0c\u4f1a\u89e6\u53d1 ",(0,r.kt)("inlineCode",{parentName:"p"},"return()"),"\uff0c\u5411\u8fed\u4ee3\u5668\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\uff0c\u8868\u793a\u81ea\u5df1\u4e0d\u518d\u9700\u8981\u8fed\u4ee3\u3002\u4f5c\u4e3a\u751f\u4ea7\u8005\u7684\u8fed\u4ee3\u5668\u6536\u5230\u4fe1\u53f7\u540e\uff0c\u53ef\u4ee5\u5728 return \u4e2d\u6267\u884c\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c\uff0c\u6bd4\u5982\u5173\u95ed\u7f51\u7edc\u3001\u6570\u636e\u5e93\u7b49\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"return()")," \u53ef\u4ee5 ",(0,r.kt)("strong",{parentName:"li"},"\u63d0\u524d\u7ec8\u6b62")," \u8fed\u4ee3\u5668\u7ee7\u7eed\u8fed\u4ee3\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"return()"),"  \u4f1a\u8fd4\u56de\u4e00\u4e2a IteratorResult \u5bf9\u8c61\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"return()")," \u65f6\u7684\u5165\u53c2\u3002\u5c06\u4f1a\u4f5c\u4e3a\u672c\u6b21 IteratorResult \u7684 value \u539f\u8def\u8fd4\u56de\u3002")))),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"throw()")," \uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"throw()")," \u4e0d\u610f\u5473\u7740 iterator \u5b8c\u5168\u505c\u6b62\u8fed\u4ee3\u3002\u800c\u662f\u4f1a\u6839\u636e\u4f20\u9012\u8fc7\u6765\u7684\u5f02\u5e38\uff0c\u7ed9\u51fa\u5bf9\u5e94\u7684\u53cd\u5e94\u3002\u5f02\u5e38\u53ef\u4ee5\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"try...catch")," \u6355\u83b7\uff0c\u672a\u6355\u83b7\u7684\u5f02\u5e38\u5219\u4f1a\u7ec8\u6b62 iterator\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u53c2\u6570\uff0c\u7528\u4e8e\u5411 iterator \u4f20\u9001\u4e00\u4e2a\u5f02\u5e38 / \u9519\u8bef\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u4f1a\u8fd4\u56de\u4e00\u4e2a IteratorResult \u5bf9\u8c61\u3002")),(0,r.kt)("p",null,"\u53e6\uff1a\u63d0\u524d\u7ec8\u6b62 Iterator \u7684\u65b9\u6cd5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"for..of")," \u5faa\u73af\u53ef\u4ee5\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"break"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"continue"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"return"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"throw")," \u63d0\u524d\u9000\u51fa\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u8c03\u7528 iterator \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"return()")," \u65b9\u6cd5 ")),(0,r.kt)("h3",{id:"15-forof-\u904d\u5386-iterator"},"1.5 ",(0,r.kt)("inlineCode",{parentName:"h3"},"for..of")," \u904d\u5386 iterator"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"for..of")," \u53ef\u4ee5\u904d\u5386\u4e00\u4e2a\u7b26\u5408\u89c4\u8303\u7684 iterable \u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"for...of")," \u5faa\u73af\u4f1a\u81ea\u52a8\u8bf7\u6c42\u5bf9\u8c61\u7684  ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.iterator]")," \u51fd\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a iterator \u8fed\u4ee3\u5668\uff1b\u5e76\u4e14\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u81ea\u52a8\u8c03\u7528 iterator \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u6765\u904d\u5386\u8fd9\u4e2a\u5bf9\u8c61\u7684\u503c\uff0c\u5e76\u4e14\u4f1a\u5728\u63a5\u6536\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"done:true")," \u4e4b\u540e\u81ea\u52a8\u505c\u6b62\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u624b\u5de5\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"[Symbol.iterator]")," \u51fd\u6570\uff0c\u7136\u540e\u4f7f\u7528\u5b83\u8fd4\u56de\u7684\u8fed\u4ee3\u5668\uff0c\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()")," \u3002")),(0,r.kt)("p",null,"\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const a = [1, 3, 5, 7, 9]\n\n// for of \u4f7f\u7528 iterator\nfor (let value of a) {\n    console.log(value)  // 1 3 5 7 9\n}\n\n// \u624b\u52a8\u4f7f\u7528 iterator \u7684 next \u65b9\u6cd5\nlet it = a[Symbol.iterator]()\nit.next().value // 1\nit.next().value // 3\nit.next().value // 5\n")),(0,r.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u628a Symbol.iterator \u6307\u5411\u81ea\u8eab\uff0c\u4f7f\u81ea\u5df1\u65e2\u662f\u4e00\u4e2a iterator \u4e5f\u662f\u4e00\u4e2a iterable\uff0c"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"generator \u751f\u6210\u7684 iterator \u5c31\u662f\u65e2\u662f\u4e00\u4e2a iterator \u4e5f\u662f\u4e00\u4e2a iterable\uff0c")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const it = {\n    // for..of \u4f1a\u8c03\u7528 Symbol.iterator\u3002\n    // \u8ba9 Symbol.iterator \u8fd4\u56de\u81ea\u8eab\uff0c\u4f7f\u81ea\u5df1\u6210\u4e3a\u4e00\u4e2a iterable\n    [Symbol.iterator]() { return this }\n    // \u5b9a\u4e49iterator\u7684next\u65b9\u6cd5\n    next(){}\n}\n\nit[Symbol.iterator]() === it   // true\n")),(0,r.kt)("h2",{id:"2-generator--yield-\u751f\u6210\u5668"},"2 generator / yield \u751f\u6210\u5668"),(0,r.kt)("p",null,"\u5e38\u89c4\u51fd\u6570\u7684\u95ee\u9898\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4e00\u65e6\u5f00\u59cb\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\uff0c\u5728\u5b83\u7ed3\u675f\u4e4b\u524d\u4e0d\u4f1a\u88ab\u4efb\u4f55\u4e8b\u60c5\u6253\u65ad\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5916\u90e8\u53ea\u80fd\u5728\u8c03\u7528\u65f6\uff0c\u4f20\u9012\u503c\u5230\u51fd\u6570\u4e2d\uff0c\u4e2d\u95f4\u65e0\u6cd5\u7ee7\u7eed\u4f20\u9012\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5355\u4e00\u503c\uff08\u6216\u8005\u4e0d\u8fd4\u56de\u4efb\u4f55\u503c\uff09\u3002")),(0,r.kt)("p",null,"\u800c ",(0,r.kt)("inlineCode",{parentName:"p"},"function*"),"\uff08\u751f\u6210\u5668\u51fd\u6570\uff09\u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u4e00\u6b21\u6216\u591a\u6b21\u542f\u52a8\u548c\u505c\u6b62\uff0c\u5e76\u4e0d\u4e00\u5b9a\u975e\u5f97\u8981\u5b8c\u6210\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"function*")," \u4f1a\u8fd4\u56de\u4e00\u4e2a Generator \u751f\u6210\u5668\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u5176\u662f\u4e00\u4e2a\u7279\u6b8a\u7684 Iterator\u3002"),(0,r.kt)("li",{parentName:"ul"},"generator \u53ef\u5728\u51fd\u6570\u6267\u884c\u5f53\u4e2d \u6682\u505c / \u6062\u590d \u81ea\u8eab\u7684\u6267\u884c\u3002"),(0,r.kt)("li",{parentName:"ul"},"generator \u6682\u505c / \u6062\u590d\u65f6\uff0c\u63d0\u4f9b\u53cc\u5411\u4fe1\u606f\u4f20\u9012\uff1agenerator \u53ef\u4ee5\u8fd4\u56de\u503c\uff0c\u4e5f\u53ef\u4f20\u9012\u503c\u7ed9\u5b83\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u4e0e iterable \u5b8c\u7f8e\u914d\u5408\u4f7f\u7528\uff0c\u4ece\u800c\u53ef\u4ee5\u8f7b\u677e\u5730\u521b\u5efa\u6570\u636e\u6d41\u3002")),(0,r.kt)("h3",{id:"21-generator"},"2.1 generator"),(0,r.kt)("p",null,"\u8c03\u7528\u4e00\u4e2a\u751f\u6210\u5668\uff0c\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u751f\u6210\u5668\u7684\u8fed\u4ee3\u5668\u5b9e\u4f8b\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u591a\u6b21\u8c03\u7528\u751f\u6210\u5668\uff0c\u4f1a\u8fd4\u56de\u591a\u4e2a\u8fed\u4ee3\u5668\u5b9e\u4f8b\uff0c\u5b83\u4eec\u4e92\u76f8\u4e0d\u53d7\u5f71\u54cd\u3002"),(0,r.kt)("p",null,"\u4ee5\u4e0b\u662f\u8c03\u7528 generator \u7684\u6d41\u7a0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function* gen() {\n  console.log('\u7b2c\u4e00\u6bb5\u4ee3\u7801');\n  const s1 = yield 1;\n  console.log('\u7b2c\u4e8c\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a', s1);\n  const s2 = yield 2;\n  console.log('\u7b2c\u4e09\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a', s2);\n  const s3 = yield 3;\n  console.log('\u7b2c\u56db\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a', s3);\n  return \"over\"\n}\n\nlet it = gen();            // \u4e0d\u4f20\u53c2\nconsole.log(it.next('a')); // \u4e0d\u4f20\u53c2\nconsole.log(it.next('b'));\nconsole.log(it.next('c'));\nconsole.log(it.next('d'));\n\n// \u7b2c\u4e00\u6bb5\u4ee3\u7801\n// {value: 1, done: false}\n// \u7b2c\u4e8c\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a b\n// {value: 2, done: false}\n// \u7b2c\u4e09\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a c\n// {value: 3, done: false}\n// \u7b2c\u56db\u6bb5\u4ee3\u7801\uff0c\u6536\u5230\u4fe1\u606f\uff1a d\n// {value: 'over', done: true}\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u9996\u5148\uff0c\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"gen")," \u83b7\u5f97\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"iterator"),"\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u63a5\u7740\uff0c\u6bcf\u8c03\u7528\u4e00\u6b21 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()"),"\uff0c\u5c31\u4f1a\u6267\u884c\u5230\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u5904\uff0c\u8fd4\u56de\u4e00\u4e2a IteratorResult\uff0c\u5176 ",(0,r.kt)("inlineCode",{parentName:"li"},"value")," \u503c\u4fdd\u5b58\u4e86\u8fd9\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u5904\u4f20\u9012\u8fc7\u6765\u7684\u503c\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6bcf\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"next()"),"\uff0c\u90fd\u4f1a\u6709\u4e09\u4e2a\u8fc7\u7a0b\uff1a",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"next \u4e2d\u7684\u5165\u53c2\uff0c\u8d4b\u503c ",(0,r.kt)("strong",{parentName:"li"},"\u5f53\u524d ",(0,r.kt)("inlineCode",{parentName:"strong"},"yield"))," \u5904\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884c function* \u4e2d\u7684\u4ee3\u7801\uff1b"),(0,r.kt)("li",{parentName:"ol"},"function* \u4e2d\u7684\u4ee3\u7801\u6267\u884c\u5230 ",(0,r.kt)("strong",{parentName:"li"},"\u4e0b\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"strong"},"yield"))," \u5904\uff0c\u7136\u540e\u6682\u505c\u6267\u884c\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u8fd4\u56de\u4e00\u4e2a IteratorResult\uff0c\u628a ",(0,r.kt)("strong",{parentName:"li"},"\u6682\u505c\u5904\u7684 ",(0,r.kt)("inlineCode",{parentName:"strong"},"yield"))," \u5904\u7684\u503c\u653e\u5165\u5176\u4e2d\u3002"))),(0,r.kt)("li",{parentName:"ol"},"\u5f53\u6267\u884c\u6700\u540e\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next()")," \u65f6\uff0c\u4f1a\u8ba9 generator \u6267\u884c\u5230 function* \u672b\u5c3e ",(0,r.kt)("inlineCode",{parentName:"li"},"return")," \u5904\u3002\u6b64\u65f6\u8fd4\u56de\u7684 IteratorResult \u4e2d\uff0c\u4fdd\u5b58\u7684\u503c\u5c31\u662f return \u8fd4\u56de\u7684\u503c\u3002")),(0,r.kt)("p",null,"\u6240\u4ee5\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"next()")," \u603b\u662f\u6bd4 ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u591a\u4e00\u4e2a\u3002\u4e0a\u4f8b\u4e2d\uff0c\u6709 3 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u548c 4 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"next()"),"\u3002"),(0,r.kt)("h3",{id:"22-generator-\u65b9\u6cd5"},"2.2 generator \u65b9\u6cd5"),(0,r.kt)("p",null,"generator \u6709\u4e09\u4e2a\u65b9\u6cd5\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"next\uff1a\u5b9e\u73b0\u4e86 generator \u51fd\u6570\u7684\u5206\u6bb5\u6267\u884c\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f20\u9012\u53c2\u6570\u7ed9 generator \u51fd\u6570\u3002"),(0,r.kt)("li",{parentName:"ul"},"return\uff1a\u7acb\u5373\u7ed3\u675f generator \u51fd\u6570\u7684\u6267\u884c\uff0c\u5e76\u4e14\u5165\u53c2\u7684\u6570\u636e\u4f1a\u539f\u8def\u8fd4\u56de\u3002"),(0,r.kt)("li",{parentName:"ul"},"throw\uff1a\u53ef\u4ee5\u7ed9\u751f\u6210\u5668\u51fd\u6570\u5185\u90e8\u629b\u51fa\u5f02\u5e38\u3002\u8ba9\u5f53\u524d\u6682\u505c\u7684 yield \u5904\u53d1\u751f\u5f02\u5e38\u3002")),(0,r.kt)("p",null,"\u63d0\u524d\u5b8c\u6210\uff1a"),(0,r.kt)("p",null,"\u5728 Iterator \u4e2d\u63d0\u5230\u8fc7\uff0c\u6709\u4e24\u4e2a\u65b9\u6cd5 ",(0,r.kt)("inlineCode",{parentName:"p"},"throw()")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"return()")," \u53ef\u4ee5\u63d0\u524d\u7ec8\u6b62\u4e00\u4e2a\u6682\u505c\u7684 generator\u3002"),(0,r.kt)("h4",{id:"221-return"},"2.2.1 ",(0,r.kt)("inlineCode",{parentName:"h4"},"return()")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function* foo() {\n    yield 1\n    yield 2\n    yield 3\n}\n\nlet it = foo()\nit.next()       // { value: 1, done: false }\nit.return(42)   // { value: 42, done: true }\nit.next()       // { value: undefined, done: true }\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"return(x)")," \u7684\u6548\u679c\u76f8\u5f53\u4e8e\u901a\u8fc7 generator\uff0c\u5f3a\u5236\u7acb\u5373\u6267\u884c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"return x"),"\u3002\u6240\u4ee5\uff0c\u4f20\u9012\u8fc7\u53bb\u7684\u503c ",(0,r.kt)("inlineCode",{parentName:"p"},"x"),"\uff0cgenerator \u4f1a\u5f53\u4f5c\u5b8c\u6210\u503c\u653e\u5728 IteratorResult \u4e2d\u8fd4\u56de\uff0c\u7136\u540e\u7ec8\u6b62\u3002"),(0,r.kt)("p",null,"\u4f5c\u7528\uff1a\u5982\u679c\u4e0d\u518d\u4f1a\u904d\u5386\u7684 generator\uff0c\u4f1a\u4e00\u76f4\u5728\u5185\u5b58\u4e2d\u5360\u7528\u8d44\u6e90\uff0c\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"p"},"return()")," \u63d0\u524d\u7ec8\u6b62\uff0c\u91ca\u653e\u8d44\u6e90\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"for...of"),"\uff0c ",(0,r.kt)("inlineCode",{parentName:"p"},"spread")," \u7b49\uff0c\u5728\u7ed3\u675f\u524d\u4f1a\u81ea\u52a8\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"return"),"\uff0c\u7136\u540e\u6267\u884c ",(0,r.kt)("inlineCode",{parentName:"p"},"finally")," \u4e2d\u7684\u4ee3\u7801\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function* foo() {\n    try{\n        yield 1\n        yield 2\n        yield 3\n    }\n    finally{\n        console.log("cleanup")\n    }\n}\n\nfor (let v of foo()) {\n    console.log(v)\n}\n// 1 2 3\n// cleanup\n\nlet it = foo()\nit.next()       // {value: 1, done: false}\nit.return(42)   // cleanup\n                // {value: 42, done: true}\n')),(0,r.kt)("p",null,"\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"generator")," \u5185\u90e8\u5982\u679c\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"try...finally")," \u8bed\u53e5\uff0c\u5373\u4f7f\u8fed\u4ee3\u5668\u4ece\u5916\u90e8\u7ed3\u675f\uff0c\u4e5f\u4f1a\u6267\u884c ",(0,r.kt)("inlineCode",{parentName:"p"},"finally")," \u4e2d\u7684\u8bed\u53e5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u5728\u7ed3\u675f\u65f6\u7684\u6267\u884c\u987a\u5e8f\uff0c\u5f53\u51fa\u73b0 ",(0,r.kt)("inlineCode",{parentName:"li"},"it.return()")," \u65f6\uff0c\u4f1a\u7acb\u5373\u7ec8\u6b62\u751f\u6210\u5668\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u9996\u5148\uff0c\u6267\u884c ",(0,r.kt)("inlineCode",{parentName:"strong"},"finally")," \u4e2d\u7684\u4ee3\u7801\uff0c")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u63a5\u7740\uff0c\u628a\u8fd4\u56de\u7684 ",(0,r.kt)("inlineCode",{parentName:"strong"},"value")," \u8bbe\u7f6e\u4e3a\u4f20\u5165 ",(0,r.kt)("inlineCode",{parentName:"strong"},"return()")," \u7684\u5185\u5bb9\u3002\u4e5f\u5c31\u662f\u6b64\u65f6 ",(0,r.kt)("inlineCode",{parentName:"strong"},"vlaue")," \u503c\u4e3a  ",(0,r.kt)("inlineCode",{parentName:"strong"},"cleanup")," \u3002"))))),(0,r.kt)("h4",{id:"222-throw"},"2.2.2 ",(0,r.kt)("inlineCode",{parentName:"h4"},"throw()")),(0,r.kt)("p",null,"throw\uff1a\u53ef\u4ee5\u7ed9\u751f\u6210\u5668\u51fd\u6570\u5185\u90e8\u629b\u51fa\u5f02\u5e38\u3002\u8ba9\u5f53\u524d\u6682\u505c\u7684 yield \u5904\u53d1\u751f\u5f02\u5e38\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u629b\u51fa\u5f02\u5e38\u540e\uff0c\u53ef\u4ee5\u5728\u751f\u6210\u5668\u51fd\u6570\u4e2d\uff0c\u7528 try catch \u6355\u83b7\u5f02\u5e38\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5f02\u5e38\u88ab\u6355\u83b7\u540e\uff0ctry \u4e4b\u540e\u7684\u4ee3\u7801\u53ef\u7ee7\u7eed\u6b63\u5e38\u6267\u884c\u3002"),(0,r.kt)("li",{parentName:"ul"},"catch \u8bed\u53e5\u4e2d yield \u4e5f\u4f9d\u7136\u6709\u6548\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function* gen() {\n  console.log("\u4ee3\u7801\u5f00\u59cb\u6267\u884c~");\n\n  try {\n    yield 100;\n        // \u6b64\u5904\u5df2\u51fa\u73b0\u9519\u8bef\uff0c\u4e0d\u4f1a\u6267\u884c\n  } catch (error) {\n    console.log("\u6355\u83b7\u5230\u5f02\u5e38\u60c5\u51b5:", error);\n    yield "abc";\n  }\n\n  console.log("\u7b2c\u4e8c\u6bb5\u4ee3\u7801\u7ee7\u7eed\u6267\u884c");\n  yield 200;\n  console.log("\u4ee3\u7801\u6267\u884c\u7ed3\u675f~");\n  return "over";\n}\n\nconst it = gen();\nconsole.log("\u7b2c 1 \u4e2a next \u8fd4\u56de\u503c", it.next());\nconsole.log("throw \u8fd4\u56de\u503c", it.throw("error message"));\nconsole.log("\u7b2c 2 \u4e2a next \u8fd4\u56de\u503c", it.next());\nconsole.log("\u7b2c 3 \u4e2a next \u8fd4\u56de\u503c", it.next());\n\n// \u4ee3\u7801\u5f00\u59cb\u6267\u884c~\n// \u7b2c 1 \u4e2a next \u8fd4\u56de\u503c {value: 100, done: false}\n// \u6355\u83b7\u5230\u5f02\u5e38\u60c5\u51b5: error message\n// throw \u8fd4\u56de\u503c {value: \'abc\', done: false}\n// \u7b2c\u4e8c\u6bb5\u4ee3\u7801\u7ee7\u7eed\u6267\u884c\n// \u7b2c 2 \u4e2a next \u8fd4\u56de\u503c {value: 200, done: false}\n// \u4ee3\u7801\u6267\u884c\u7ed3\u675f~\n// \u7b2c 3 \u4e2a next \u8fd4\u56de\u503c {value: "over", done: true}\n')),(0,r.kt)("h3",{id:"23-yield"},"2.3 yield"),(0,r.kt)("p",null,"generator \u901a\u8fc7 yield \u6765\u5b9e\u73b0\u6682\u505c / \u6062\u590d\u548c\u53cc\u5411\u4fe1\u606f\u4f20\u9012\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u4ece ",(0,r.kt)("inlineCode",{parentName:"p"},"generator")," \u4e2d\u4f20\u51fa\u6d88\u606f\uff1a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u4f1a\u5bfc\u81f4\u751f\u6210\u5668\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u8fd9\u6709\u70b9\u7c7b\u4f3c\u4e8e\u4e2d\u95f4\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"return"),"\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u4ece\u8c03\u7528\u5904\u4f20\u51fa\u6d88\u606f\uff1a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u8868\u8fbe\u5f0f\u4f1a\u7b49\u5f85\u4e00\u4e2a\u4ece\u8c03\u7528\u5904\u4f20\u9012\u8fc7\u6765\u7684\u7ed3\u679c\u503c\u3002"))),(0,r.kt)("p",null,"\u6240\u4ee5\uff0c\u6ca1\u6709\u503c\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u76f8\u5f53\u4e8e\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield undefined"),"\u3002"),(0,r.kt)("p",null,"\u4e3e\u4f8b\u4e00\u4e2a yield \u53cc\u5411\u4f20\u9012\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function* gen() {\n    let x = 1\n    let y = x + (yield "\u7b2c\u4e00\u6b21\u4e2d\u65ad") * 3\n    console.log(y)\n    y = y + (yield "\u7b2c\u4e8c\u6b21\u4e2d\u65ad")\n    console.log(y)\n    return "\u7ed3\u675f"\n}\n\nlet it = gen()\nconsole.log(it.next().value)\n// \u7b2c\u4e00\u6b21\u4e2d\u65ad     -- \u4ece generator \u4f20\u9012\u6765\u503c\nconsole.log(it.next(3).value)   // \u4ece\u8c03\u7528\u8005\u4f20\u9012\u8fc7\u53bb\u503c\uff1a3\n// 10           \n// \u7b2c\u4e8c\u6b21\u4e2d\u65ad     -- \u4ece generator \u4f20\u9012\u6765\u503c                                \nconsole.log(it.next(2).value)   // \u4ece\u8c03\u7528\u8005\u4f20\u9012\u8fc7\u53bb\u503c\uff1a2\n// 12\n// \u7ed3\u675f          -- \u4ece generator \u4f20\u9012\u6765\u503c              \n')),(0,r.kt)("p",null,"\u6ce8\u610f\u6267\u884c\u6d41\u7a0b\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"let it = gen()"),"\uff1a\u83b7\u5f97\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u7684 iterator\uff1a\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7b2c\u4e00\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()"),"\uff1a\u542f\u52a8\u8fd9\u4e2a iterator \uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u4e2d\u7684\u4ee3\u7801\u4f1a\u6267\u884c\u5230\u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u5904\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6b64\u65f6\u4f1a\u8fd4\u56de\u4e00\u4e2a IteratorResult \u7ed9\u8c03\u7528\u8005\uff0c\u5176 ",(0,r.kt)("inlineCode",{parentName:"li"},"value")," \u4fdd\u5b58\u4e86\u4ece generator \u4e2d\u4f20\u9012\u8fc7\u6765\u7684\u503c ",(0,r.kt)("inlineCode",{parentName:"li"},'"\u7b2c\u4e00\u6b21\u4e2d\u65ad"'),"\u3002"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7b2c\u4e8c\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next(3)"),"\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u4ee3\u7801\u4e2d\u7684\u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u4f1a\u62ff\u5230\u8c03\u7528\u8005\u4f20\u9012\u8fc7\u6765\u7684\u503c ",(0,r.kt)("inlineCode",{parentName:"p"},"3"),"\uff0c\u63a5\u7740\u4f1a\u6267\u884c\u5230\u7b2c\u4e8c\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u5904\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"}," console.log(y)")," \u4ee3\u7801\uff0c\u6240\u4ee5\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"10"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u8fd4\u56de\u4e00\u4e2a IteratorResult \u7ed9\u8c03\u7528\u8005\uff0c\u5176 ",(0,r.kt)("inlineCode",{parentName:"p"},"value")," \u4fdd\u5b58\u4e86\u4ece generator \u4e2d\u4f20\u9012\u8fc7\u6765\u7684\u503c ",(0,r.kt)("inlineCode",{parentName:"p"},'"\u7b2c\u4e8c\u6b21\u4e2d\u65ad"'),"\u3002")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7b2c\u4e09\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next(3)"),"\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"gen")," \u4ee3\u7801\u4e2d\u7684\u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u4f1a\u62ff\u5230\u8c03\u7528\u8005\u4f20\u9012\u8fc7\u6765\u7684\u503c ",(0,r.kt)("inlineCode",{parentName:"p"},"2"),"\uff0c\u63a5\u7740\u4f1a\u6267\u884c\u5230\u6700\u540e\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u5904\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"gen")," \u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6709 ",(0,r.kt)("inlineCode",{parentName:"li"}," console.log(y)")," \u4ee3\u7801\uff0c\u6240\u4ee5\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"12")),(0,r.kt)("li",{parentName:"ul"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"gen")," \u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u8fd4\u56de\u6700\u540e\u4e00\u4e2a IteratorResult \u7ed9\u8c03\u7528\u8005\uff0c\u5176 ",(0,r.kt)("inlineCode",{parentName:"li"},"value")," \u4fdd\u5b58\u4e86\u4ece generator \u4e2d\u4f20\u9012\u8fc7\u6765 ",(0,r.kt)("inlineCode",{parentName:"li"},'return "\u7ed3\u675f"'))))),(0,r.kt)("h3",{id:"24-yield"},"2.4 yield*"),(0,r.kt)("p",null,"yield \u59d4\u6258\uff08yield delegation\uff09\uff0c\u662f\u81ea\u52a8\u8fed\u4ee3 yield \u7684\u8bed\u6cd5\u7cd6\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"yield* ...")," \u8868\u8fbe\u5f0f\u9700\u8981\u4e00\u4e2a iterable obj\uff0c\u5b83\u4f1a\u81ea\u52a8\u8c03\u7528 iterator \u6765\u8fed\u4ee3\u8fd9\u4e2a\u5bf9\u8c61\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u8868\u8fbe\u5f0f\u7684\u5b8c\u6210\u503c\u6765\u81ea\u4e8e\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"it.next()")," \u6062\u590d\u751f\u6210\u5668\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u4f20\u9012\u7684\u53c2\u6570\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u8868\u8fbe\u5f0f\u7684\u5b8c\u6210\u503c\uff0c\u6765\u81ea\u4e8e\u88ab\u59d4\u6258\u7684 iteraable \u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"return")," \u8fd4\u56de\u503c\u3002")),(0,r.kt)("p",null,"\u6240\u4ee5\uff0c"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5bf9\u4e8e ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u6765\u8bf4\uff0c\u5b83\u4e0d\u662f\u4e00\u4e2a\u5916\u90e8\u9700\u8981 ",(0,r.kt)("inlineCode",{parentName:"li"},"it.next()")," \u8fdb\u884c\u542f\u52a8\u7684\u65ad\u70b9\uff0c\u5982\u679c\u4ee3\u7801\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*"),"  \u5904\uff0c\u4f1a\u81ea\u52a8\u7684\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u540e\u7684 iterator\uff0c\u7136\u540e\u4ee3\u7801\u4f1a\u7ee7\u7eed\u6267\u884c\u5230\u8fd9\u4e2a iterator \u7684\u7b2c\u4e00\u4e2a\u65ad\u70b9\u5904\u3002"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u4e0d\u4f1a\u7ed9\u4f60\u8fd4\u56de\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u4e0d\u4f1a\u8fd4\u56de\u7ed9\u5916\u754c\u5b8c\u6210\u503c\uff1b\u5916\u754c\u4e5f\u4e0d\u4f1a\u4f20\u9012\u53c2\u6570\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u3002"),(0,r.kt)("li",{parentName:"ol"},"\u4ece\u8fd9\u4e00\u70b9\u4e0a\u6765\u8bf4\uff0c\u5728\u5916\u90e8\u770b\u6765\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u597d\u4f3c\u900f\u660e\u7684\uff0c\u5b83\u4e0d\u4f1a\u5f62\u6210\u4e00\u4e2a\u65ad\u70b9\uff0c\u4e0d\u9700\u8981 ",(0,r.kt)("inlineCode",{parentName:"li"},"it.next()")," \u53bb\u542f\u52a8\u3002")),(0,r.kt)("p",null,"\u901a\u8fc7\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u6765\u4f53\u4f1a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield*")," \u7684\u6267\u884c\u6d41\u7a0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function* foo() {\n    let x = yield "foo 1";\n    let y = yield "foo 2";\n    let z = yield "foo 3";\n    console.log(x, y, z)\n    return "foo return"\n}\n\nfunction* bar() {\n    let x = yield* foo()\n    console.log("foo return:", x)\n    yield "bar a"\n    return "bar return"\n}\n')),(0,r.kt)("p",null,"\u6211\u4eec\u6765\u5206\u6790\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4e00\u5171\u9700\u8981\u51e0\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()")," \u542f\u52a8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"bar")," \u4e2d\u6709 1 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \uff0c\u6240\u4ee5\u9700\u8981 2 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()"),"\u3002\u800c ",(0,r.kt)("inlineCode",{parentName:"p"},"yield*")," \u4e0d\u662f\u65ad\u70b9\uff0c\u4e0d\u9700\u8981\u542f\u52a8\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"foo")," \u4e2d\u6709 3 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"yield"),"\uff0c\u6240\u4ee5\u9700\u8981 4 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()"),"\u3002\u7531\u4e8e\u662f ",(0,r.kt)("inlineCode",{parentName:"p"},"bar")," \u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"yield*")," \u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"foo")," \u7684 iterator\uff0c\u6240\u4ee5 ",(0,r.kt)("inlineCode",{parentName:"p"},"yield*")," \u4f1a\u81ea\u52a8\u521b\u5efa\u5e76\u542f\u52a8 ",(0,r.kt)("inlineCode",{parentName:"p"},"foo")," \u7684 iterator\uff0c\u7701\u53bb\u4e00\u6b21\u542f\u52a8\uff0c\u5c11 1 \u6b21 ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()")," \u8c03\u7528\u3002"))),(0,r.kt)("p",null,"\u6240\u4ee5\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u4e00\u4e2a\u9700\u8981 5 \u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"it.next()")," \u53bb\u542f\u52a8\u3002"),(0,r.kt)("p",null,"\u5f53\u7a0b\u5e8f\u5904\u5728\u8fd0\u884c\u65f6\uff0c\u4f9d\u6b21\u8f93\u5165\u4ee5\u4e0b\u4ee3\u7801\uff1b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"let = it = bar()"),"\uff1a\u521b\u5efa\u4e00\u4e2a iterator"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"it.next()"),"\uff1a\u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next")," \u4e0d\u4f20\u9012\u53c2\u6570\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u5904\u540e\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," \u7684 iterator\uff0c\u59d4\u6258\u8fd9\u4e2a iterator \u53bb\u751f\u6210\u503c\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u4e0d\u4f1a\u505c\u987f\uff0c\u7ee7\u7eed\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," \u4e2d\u7684\u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield"),"\uff0c\u7136\u540e\u8fd4\u56de ",(0,r.kt)("inlineCode",{parentName:"li"},"foo 1"),"\uff1b"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'it.next("one")'),"\uff1a\u7b2c\u4e8c\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next"),"\uff0c\u53c2\u6570\u4f20\u9012\u7ed9 \u7b2c\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u5904\uff0c\u7136\u540e ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," \u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"x")," \u83b7\u53d6\u5230\u8be5\u503c\uff0c\u7a0b\u5e8f\u7ee7\u7eed\u6267\u884c\u5230\u7b2c\u4e8c\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u5904\uff0c\u7136\u540e\u8fd4\u56de ",(0,r.kt)("inlineCode",{parentName:"li"},"foo 2"),"\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'it.next("two")'),"\uff1a\u7b2c\u4e09\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next"),"\uff0c\u60c5\u51b5\u548c\u4e0a\u4e00\u4e2a\u76f8\u540c\uff0c\u5148\u4f20\u9012\u53c2\u6570\u7ed9\u7b2c\u4e8c\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yidle"),"\uff0c\u7136\u540e\u6267\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," \u4ee3\u7801\uff0c\u6700\u540e\u8fd4\u56de\u7b2c\u4e09\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u7684\u503c\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'it.next("three")'),"\uff1a\u7b2c\u56db\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next"),"\uff0c\u4f20\u9012\u53c2\u6570\u7ed9\u7b2c\u4e09\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield"),"\uff0c\u7a0b\u5e8f\u5f80\u4e0b\u6267\u884c\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"console.log(x, y, z)"),"\uff0c\u63a7\u5236\u53f0\u8f93\u51fa\u4e86 ",(0,r.kt)("inlineCode",{parentName:"li"},"one two three"),"\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},'return "foo return"')," \u5219 ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," \u7684 iterator \u5b8c\u6210\u904d\u5386\uff0c\u628a\u5b8c\u6210\u503c\u8fd4\u56de\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield*"),"\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"yield*")," \u63a5\u6536\u5230\u5b8c\u6210\u503c\uff0c\u8d4b\u503c\u7ed9\u53d8\u91cf ",(0,r.kt)("inlineCode",{parentName:"li"},"x"),"\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u7136\u540e\u7a0b\u5e8f\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},'console.log("foo return:", x)'),"\uff0c\u63a7\u5236\u53f0\u8f93\u51fa\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"foo return: foo return"),"\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u6267\u884c\u5230\u6700\u540e\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u5904\uff0c\u8fd4\u56de\u503c ",(0,r.kt)("inlineCode",{parentName:"li"},"bar a")," \u7ed9\u5916\u90e8\uff0c\u7b49\u5f85\u5916\u90e8\u7ee7\u7eed\u542f\u52a8\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"it.next()"),"\uff0c\u6700\u540e\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"next")," \u6ca1\u6709\u4f20\u9012\u503c\u7ed9 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield"),"\uff0c\u5219\u9ed8\u8ba4\u4f20\u9012 ",(0,r.kt)("inlineCode",{parentName:"li"},"undefined"),"\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u6267\u884c\u5230\u6700\u540e\u4e00\u884c\uff0c ",(0,r.kt)("inlineCode",{parentName:"li"},"bar")," \u4e5f\u6267\u884c\u5b8c\u6bd5\uff0c\u8fd4\u56de\u5b8c\u6210\u503c ",(0,r.kt)("inlineCode",{parentName:"li"},"bar return")),(0,r.kt)("li",{parentName:"ul"},"\u5916\u90e8\u83b7\u53d6\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"bar")," \u7684\u5b8c\u6210\u503c\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"done")," \u5c5e\u6027\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"true"),"\uff0c\u77e5\u6653 ",(0,r.kt)("inlineCode",{parentName:"li"},"bar")," \u904d\u5386\u5b8c\u6bd5\u3002")))))),(0,r.kt)("p",null,"\u4e0b\u56fe\u662f\u5728\u63a7\u5236\u53f0\u4e2d\u8f93\u5165\u7684\u622a\u56fe\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20220701114638804",src:t(6975).Z,width:"410",height:"366"})),(0,r.kt)("h3",{id:"25-\u5e94\u7528"},"2.5 \u5e94\u7528"),(0,r.kt)("p",null,"\u4e3e\u4f8b1\uff1aiterator\u3001generator\u3001yield* \u7684\u4f7f\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'//[1] \u521b\u5efa iterator \u6765\u8bbf\u95ee\u6570\u7ec4\nfunction createArrayIterator(arr) {\n  let index = 0\n  return {\n    next: function() {\n      if (index < arr.length) {\n        return { done: false, value: arr[index++] }\n      } else {\n        return { done: true, value: undefined } \n      }\n    }\n  }\n}\n\n//[2] \u5229\u7528 arr \u5185\u7f6e\u53ef\u8fed\u4ee3\uff0c\u521b\u5efa generator \u51fd\u6570\u6765\u8bbf\u95ee\u6570\u7ec4\nfunction* createArrayIterator(arr) {\n  for (const item of arr) \n    yield item;\n}\n\n//[3] \u4f7f\u7528 yield* \u4f18\u5316 generator \u8fed\u4ee3\nfunction* createArrayIterator(arr) {\n  yield* arr;  // \u76f8\u5f53\u4e8e\u81ea\u52a8 for..of\n}\n\n// test\uff1a\nconst names = ["abc", "cba", "nba"];\nconst namesIterator = createArrayIterator(names);\nconsole.log(namesIterator.next()) // {done: false, value: \'abc\'}\nconsole.log(namesIterator.next()) // {done: false, value: \'cba\'}\nconsole.log(namesIterator.next()) // { done: false, value: "nba" }\nconsole.log(namesIterator.next()) // { done: true, value: undefined }\n')),(0,r.kt)("p",null,"\u4e3e\u4f8b2\uff1a\u521b\u5efa\u4e00\u4e2a\u51fd\u6570, \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u8fed\u4ee3\u4e00\u4e2a\u8303\u56f4\u5185\u7684\u6570\u5b57"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"//[1]\u4f7f\u7528 iterator\nfunction createRangeIterator(start, end) {\n  return {\n    next: function() {\n            return start < end\n        ? { done: false, value: start++ }\n        : { done: true, value: undefined }\n    }\n  }\n}\n\n//[2]\u4f7f\u7528generator function\nfunction* createRangeIterator(start, end) {\n  while (start < end) {\n    yield start++;\n  }\n}\n\nconst rangeIterator = createRangeIterator(10, 20);\nconsole.log(rangeIterator.next());  // {done: false, value: 10}\nconsole.log(rangeIterator.next());  // {done: false, value: 11}\nconsole.log(rangeIterator.next());  // {done: false, value: 12}\n")),(0,r.kt)("p",null,"\u4e3e\u4f8b3\uff1aclass \u4e2d\u4f7f\u7528\u8fed\u4ee3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'class Classroom {\n  constructor(students) {\n    this.students = students;\n  }\n\n  entry(newStudent) {\n    this.students.push(newStudent);\n    return this;\n  }\n\n  // \u65b9\u6cd5[1] \u521b\u5efa\u4e00\u4e2aiterator\n  [Symbol.iterator]() {\n    let index = 0\n    return {\n      next: () => {   // next \u65b9\u6cd5\u4f7f\u7528\u7bad\u5934\u51fd\u6570\uff0c\u4f7fthis\u56fa\u5b9a\u6307\u5411iterableObj\n        if (index < this.students.length) {\n          return { done: false, value: this.students[index++] }\n        } else {\n          return { done: true, value: undefined }\n        }\n      }\n    }\n  }\n  \n  // \u65b9\u6cd5[2] \u5229\u7528arr\u53ef\u8fed\u4ee3\uff0c\u76f4\u63a5\u521b\u5efayield*\n  *[Symbol.iterator]() {\n    yield* this.students;\n  }\n  \n  // \u65b9\u6cd5[2]\u4e5f\u53ef\u4ee5\u8fd9\u4e48\u5199\n  // [Symbol.iterator] = function*() {\n  //   yield* this.students;\n  // }\n}\n\nconst classroom = new Classroom(["001", "002"]);\nclassroom.entry("003").entry("004").entry("005");\n\nfor (const item of classroom) {\n  console.log(item);  // 001 002 003 004 005\n}\n')),(0,r.kt)("h2",{id:"3-async--await--\u5f02\u6b65\u7f16\u7a0b"},"3 Async / await  \u5f02\u6b65\u7f16\u7a0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function foo() {\n    return 1 \n}\n")),(0,r.kt)("p",null,"\u5982\u679c\u51fd\u6570\u524d\u52a0\u5165\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"async")," \u5173\u952e\u5b57\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u6210\u4e3a\u4e86\u4e00\u4e2a Async\u3002Async \u901a\u5e38\u548c Promise \u914d\u5408\u4f7f\u7528\uff0cAsync \u8fdb\u4e00\u6b65\u4f18\u5316\u4e86 promise \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"then")," \u8c03\u7528\u94fe,\u4f7f\u5f02\u6b65\u7f16\u7a0b\u66f4\u8212\u9002\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"async")," \u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u6c38\u8fdc\u662f\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"promise"),"\uff0c\u4e14\u8be5 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise")," \u662f\u5df2\u51b3\u8bae\u7684\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c ",(0,r.kt)("inlineCode",{parentName:"li"},"return")," \u7684\u662f\u4e00\u4e2a\u7acb\u5373\u503c\uff0c\u5219\u5305\u88c5\u4e3a\u4e00\u4e2a rsolved promise \u540e\u8fd4\u56de\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c ",(0,r.kt)("inlineCode",{parentName:"li"},"return")," \u7684\u662f\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"promise"),"\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"promise"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c ",(0,r.kt)("inlineCode",{parentName:"li"},"return")," \u7684\u662f\u4e00\u4e2a thenable\uff0c\u5219\u4f1a\u8fdb\u884c\u5c55\u5f00(\u6267\u884c)\uff0c\u5f97\u5230\u4e00\u4e2a\u7acb\u5373\u503c\u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"promise"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u624b\u52a8 ",(0,r.kt)("inlineCode",{parentName:"li"},"return"),"\uff0c\u4e14\u6ca1\u6709\u9519\u8bef\u7684\u60c5\u51b5\u4e0b\uff0c \u9ed8\u8ba4\u8fd4\u56de\u4e00\u4e2a\u503c\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"undefined")," \u7684 resolved promise\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u624b\u52a8 ",(0,r.kt)("inlineCode",{parentName:"li"},"return"),"\uff0c\u4e14\u6709 ",(0,r.kt)("inlineCode",{parentName:"li"},"reject"),"\uff0c\u5982\u679c\u6ca1\u6709\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"try...catch")," \u6355\u83b7\uff0c\u5c31\u4f1a\u8fd4\u56de\u8fd9\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"rejected promise"),"\u3002")),(0,r.kt)("h3",{id:"31-await"},"3.1 ",(0,r.kt)("inlineCode",{parentName:"h3"},"await")),(0,r.kt)("p",null,"\u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"generator")," / ",(0,r.kt)("inlineCode",{parentName:"p"},"yield")," \u7c7b\u578b\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"async")," / ",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u4e5f\u662f\u76f8\u4e92\u7684\u642d\u6863\u3002",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u53ea\u80fd\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"async")," \u4e2d\u4f7f\u7528\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"await... ")," \u8868\u8fbe\u5f0f\u662f\u4e00\u4e2a\u6682\u505c\u70b9\uff0c\u5176\u53f3\u4fa7\u662f\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"promise"),"\u3002\u5f53\u7a0b\u5e8f\u6267\u884c\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"await..."),"  \u65f6\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u4f1a\u6682\u505c\u51fd\u6570\u7684\u6267\u884c\uff0c\u76f4\u5230 promise \u72b6\u6001\u53d8\u4e3a settled\uff0c\u7136\u540e\u4ee5 promise \u7684\u7ed3\u679c\u7ee7\u7eed\u6267\u884c\u3002\u8fd9\u4e2a\u884c\u4e3a\u4e0d\u4f1a\u8017\u8d39\u4efb\u4f55 CPU \u8d44\u6e90\uff0c\u56e0\u4e3a JavaScript \u5f15\u64ce\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u5176\u4ed6\u4efb\u52a1\uff1a\u6267\u884c\u5176\u4ed6\u811a\u672c\uff0c\u5904\u7406\u4e8b\u4ef6\u7b49\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"await")," \u5b9e\u9645\u4e0a\u5c31\u662f ",(0,r.kt)("inlineCode",{parentName:"li"},"p.then()")," \u7684\u8bed\u6cd5\u7cd6\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u5982\u679c ",(0,r.kt)("inlineCode",{parentName:"strong"},"await")," \u540e\u662f\u4e00\u4e2a\u7acb\u5373\u503c\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2a\u7acb\u5373\u503c\uff0c\u4e0d\u4f1a\u5305\u88c5\u4e3a ",(0,r.kt)("inlineCode",{parentName:"strong"},"promise")," \u3002"))),(0,r.kt)("h3",{id:"32-error-\u5904\u7406"},"3.2 Error \u5904\u7406"),(0,r.kt)("p",null,"\u5982\u679c\u4e00\u4e2a promise \u6b63\u5e38 ",(0,r.kt)("inlineCode",{parentName:"p"},"fulfilled"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"await promise")," \u8fd4\u56de\u7684\u5c31\u662f\u5176\u7ed3\u679c\uff0c\u662f\u4e00\u4e2a\u5df2\u51b3\u8bae\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise"),"\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u8fd9\u4e2a promise \u662f",(0,r.kt)("inlineCode",{parentName:"p"},"rejected"),"\uff0c\u5b83\u5c06 ",(0,r.kt)("inlineCode",{parentName:"p"},"throw")," \u8fd9\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"error")," \uff0c\u63a7\u5236\u53f0\u4e2d\u4f1a\u663e\u793a\u4e00\u4e2a\u672a\u5904\u7406\u7684 promise error\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'async function foo() {\n    let p = await Promise.reject("\u9519\u8bef")\n    return p\n}\nfoo() // \u9519\u8bef\n// Uncaught (in promise) \u9519\u8bef\n')),(0,r.kt)("h4",{id:"trycatch"},(0,r.kt)("inlineCode",{parentName:"h4"},"try...catch")),(0,r.kt)("p",null,"\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"try...catch")," \u53ef\u4ee5\u628a ",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u7b49\u5f85\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise")," \u4e2d\u53d1\u751f\u7684\u9519\u8bef\u6355\u83b7\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'async function foo() {\n    try {\n        let p = await Promise.reject("\u9519\u8bef")\n        } catch (e) {\n            console.log(e)\n        }\n\n}\nfoo() // \u9519\u8bef\n')),(0,r.kt)("p",null,"\u5982\u679c\u6ca1\u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u7b49\u5f85\uff0cpromise \u4e2d\u53d1\u751f\u7684\u9519\u8bef\u5c31\u53ea\u5728 promise \u4e2d\u629b\u51fa\u9519\u8bef\uff0c\u9700\u8981 ",(0,r.kt)("inlineCode",{parentName:"p"},"p.then()")," \u6216 ",(0,r.kt)("inlineCode",{parentName:"p"},"p.catch()")," \u53bb\u63a5\u6536\u9519\u8bef\uff0c\u65e0\u6cd5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"try...catch")," \u6355\u83b7\u9519\u8bef\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'async function foo() {\n    try {\n        let p = Promise.reject("\u9519\u8bef")\n        } catch (e) {\n            console.log(e)\n        }\n\n}\nfoo() // Uncaught (in promise) \u9519\u8bef\n')),(0,r.kt)("p",null,"\u5982\u679c\u4e0d\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"try..catch")," \u53bb\u6355\u83b7 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise")," \u4e2d\u7684\u9519\u8bef\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"async")," \u51fd\u6570\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},".catch()")," \u4f5c\u4e3a\u201c\u515c\u5e95\u201d\uff0c\u5904\u7406 ",(0,r.kt)("inlineCode",{parentName:"p"},"async")," \u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\u3002"),(0,r.kt)("p",null,"\u8fd9\u5c31\u76f8\u5f53\u4e8e\uff0c \u5f02\u6b65\u51fd\u6570 ",(0,r.kt)("inlineCode",{parentName:"p"},"foo()")," \u6700\u7ec8\u8fd4\u56de\u4e86\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"rejected")," \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"promise"),"\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'async function foo() {\n    let p = await Promise.reject("\u9519\u8bef")\n}\n\nfoo().catch(e => {\n    console.log(e)      // \u9519\u8bef\n}) \n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6240\u4ee5\uff0c",(0,r.kt)("inlineCode",{parentName:"strong"},"async")," / ",(0,r.kt)("inlineCode",{parentName:"strong"},"await")," \u662f ",(0,r.kt)("inlineCode",{parentName:"strong"},"promise")," / ",(0,r.kt)("inlineCode",{parentName:"strong"},"p.then()")," \u7684\u8bed\u6cd5\u7cd6\u3002")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u89e3\u51b3\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"then()")," \u957f\u957f\u7684\u4e00\u6761\u94fe\u6761\uff0c\u6211\u4eec\u628a ",(0,r.kt)("inlineCode",{parentName:"p"},"then")," \u4e2d ",(0,r.kt)("inlineCode",{parentName:"p"},"rejected")," \u5931\u8d25\u56de\u8c03\u51fd\u6570\u653e\u5230\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"try...catch")," \u4e2d\u7edf\u4e00\u5904\u7406\u3002\u7136\u540e ",(0,r.kt)("inlineCode",{parentName:"p"},"await")," \u5c31\u53ea\u9700\u7b49\u5f85\u6b63\u786e\u7684 resolve promise \u4e86\u3002"),(0,r.kt)("h2",{id:"4-async-generator-\u5f02\u6b65\u8fed\u4ee3"},"4 async generator \u5f02\u6b65\u8fed\u4ee3"),(0,r.kt)("p",null,"\u58f0\u660e\u4e00\u4e2a\u5f02\u6b65\u8fed\u4ee3\u51fd\u6570\uff0c\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"async ")),(0,r.kt)("p",null,"\u5f02\u6b65\u8fed\u4ee3\u5141\u8bb8\u6211\u4eec\u5bf9\u6309\u9700\u901a\u8fc7\u5f02\u6b65\u8bf7\u6c42\u800c\u5f97\u5230\u7684\u6570\u636e\u8fdb\u884c\u8fed\u4ee3\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u901a\u8fc7\u7f51\u7edc\u5206\u6bb5\uff08chunk-by-chunk\uff09\u4e0b\u8f7d\u6570\u636e\u65f6\u3002\u5f02\u6b65\u751f\u6210\u5668\uff08generator\uff09\u4f7f\u8fd9\u4e00\u6b65\u9aa4\u66f4\u52a0\u65b9\u4fbf\u3002"),(0,r.kt)("h3",{id:"41-\u5f02\u6b65\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61-async-iterable-object"},"4.1 \u5f02\u6b65\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61 async iterable object"),(0,r.kt)("p",null,"\u6211\u4eec\u77e5\u9053\uff0c\u8981\u4f7f\u4e00\u4e2a\u5bf9\u8c61\u53ef\u8fed\u4ee3\uff0c\u6211\u4eec\u9700\u8981\u7ed9\u5b83\u6dfb\u52a0 ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.iterator]"),"\u3002"),(0,r.kt)("p",null,"\u73b0\u8c61\uff0c\u5982\u679c\u4ee4\u4e00\u4e2a\u5bf9\u8c61\u53ef\u5f02\u6b65\u8fed\u4ee3\uff0c\u9700\u8981\u6dfb\u52a0 ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.asyncIterator]"),"\u3002"),(0,r.kt)("p",null,"\u5f53\u8fed\u4ee3\u7684\u503c\u901a\u8fc7\u5f02\u6b65\u5f62\u5f0f\u8f93\u51fa\u65f6\uff0citerator \u7684\u5b9a\u4e49\u548c\u4f7f\u7528\u4ea7\u751f\u4e86\u4ee5\u4e0b\u53d8\u5316\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5f15\u64ce\u4e0d\u518d\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"[Symbol.iterator]")," \u51fd\u6570\u6765\u8fed\u4ee3\uff0c\u800c\u662f\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"[Symbol.asyncIterator]"),"\u3002"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"await it.next()")," \u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a fulfilled promise\uff0c\u4e14\u8fd9\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"promise")," \u643a\u5e26\u6709\u8fd4\u56de\u503c IteratorResult\u3002"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"for...of")," \u5e94\u8be5\u4f7f\u7528\u5f02\u6b65\u8fed\u4ee3\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"for await (let v of iterable)"),"\u3002")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"for...of")," \u901a\u8fc7\u8c03\u7528\u5f02\u6b65\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.iterator]")," \u51fd\u6570\uff0c\u83b7\u5f97\u4e00\u4e2a\u5305\u542b ",(0,r.kt)("inlineCode",{parentName:"p"},"async next()")," \u65b9\u6cd5\u7684\u5bf9\u8c61\u3002\u7136\u540e\u6bcf\u6b21\u8c03\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"async next()")," \u90fd\u4f1a\u83b7\u5f97\u4e00\u4e2a\u5305\u542b\u7ed3\u679c\u503c IteratorResult \u7684 promise\u3002"),(0,r.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u6bcf\u4e2a 1000ms \u540e\uff0c\u8f93\u51fa\u4e00\u4e2a\u6570\u5b57\u7684\u4f8b\u5b50\uff0c\u91c7\u7528\u5f02\u6b65\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let number = {\n    array: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19],\n    [Symbol.asyncIterator]() {\n        return {\n            array: this.array,\n            index: 0,\n            async next() {\n                let num = await new Promise((resolve) => {\n                    setTimeout(() => {\n                            resolve(this.array[this.index++])\n                        }, 1000)\n                });\n\n                return {\n                    done: num === undefined ? true : false,\n                    value: num\n                }\n            }\n        }\n    }\n};\n\n// \u5fc5\u987b\u5305\u542b\u5728\u4e00\u4e2a async \u4e2d\uff0c\u624d\u80fd\u4f7f\u7528 await\n(async () => {\n    for await (let value of number) { // (4)\n        console.log(value)  // 1, 3, 5, 7, 9, 11, 13, 15, 17, 19\n    }\n})()\n")),(0,r.kt)("h3",{id:"42-async-generator-\u5f02\u6b65\u751f\u6210\u5668"},"4.2 async generator \u5f02\u6b65\u751f\u6210\u5668"),(0,r.kt)("p",null,"\u5f53\u6211\u4eec\u60f3\u521b\u5efa\u4e00\u4e2a ",(0,r.kt)("strong",{parentName:"p"},"\u5f02\u6b65\u751f\u6210\u4e00\u7cfb\u5217\u503c\u7684\u5bf9\u8c61")," \u65f6\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65 generator\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function* gen() {\n    for (let i = 0, i < 20; i++) {\n        await new Promise(reslove => setTimeout(reslove, 1000));\n        yield i;\n    }\n};\n\n// for await ...of \u904d\u5386\n(async() => {\n    let it = gen();\n    for await(let v of it) {\n        console.log(v)  // \u95f4\u9694 1s\uff0c\u8f93\u51fa0 ~ 19\n    }\n})();\n")),(0,r.kt)("p",null,"\u5b9a\u4e49\u5f02\u6b65 generator \u65f6\uff0c\u6ce8\u610f\u51e0\u4e2a\u8981\u70b9\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5b9a\u4e49\u5f02\u6b65 generator \uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"async function*"),"\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5728\u5f02\u6b65 generator \u4e2d\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"await")," \u7b49\u5f85\uff0c\u6765\u5f02\u6b65\u83b7\u53d6\u503c\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5728\u5f02\u6b65 generator \u4e2d\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"yield")," \u6765\u548c\u8c03\u7528\u8005\u8fdb\u884c\u53cc\u5411\u4ea4\u4e92\uff0c\u628a\u81ea\u5df1\u83b7\u53d6\u7684\u503c\u4f20\u9012\u51fa\u53bb\u3002")),(0,r.kt)("p",null,"\u4f7f\u7528\u5f02\u6b65 generator \u65f6\uff0c\u6ce8\u610f\u51e0\u4e2a\u8981\u70b9\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u8981\u5f02\u6b65\u73af\u5883\u4e2d\u521b\u5efa\u5e76\u8c03\u7528\u4f7f\u7528\u542f\u52a8\u5668\uff0c\u521b\u5efa\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"async")," \u73af\u5883\u7684 IIFE\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"for await ...of")," \u6765\u9010\u6b21\u7684\u83b7\u53d6\u5f02\u6b65\u503c\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528  ",(0,r.kt)("inlineCode",{parentName:"li"},"for await ...of")," \u539f\u56e0\u662f\uff0c\u5f02\u6b65\u503c\u65f6\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"await it.next()")," \u83b7\u53d6\u7684\u3002")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e0a\u9762\u7684\u7a0b\u5e8f\u8fdb\u884c\u624b\u52a8\u904d\u5386\n// \u8fd0\u884c\u65f6\u8f93\u5165\uff1a\n(async() => {\n    let it = gen();\n    console.log(await it.next())\n    console.log(await it.next())\n    console.log(await it.next())\n    console.log(await it.next())\n    console.log(await it.next())\n})();\n// \u63a7\u5236\u53f0\u4f9d\u6b21\u8f93\u51fa\uff1a\n// {value: 0, done: false}\n// {value: 1, done: false}\n// {value: 2, done: false}\n// {value: 3, done: false}\n// {value: 4, done: false}\n")),(0,r.kt)("h3",{id:"43-async-symbolasynciterator"},"4.3 ",(0,r.kt)("inlineCode",{parentName:"h3"},"async [Symbol.asyncIterator]")),(0,r.kt)("p",null,"\u4f7f\u7528\u5f02\u6b65\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.asyncIterator]"),"\uff0c\u6765\u66ff\u6362\u540c\u6b65\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"[Symbol.asyncIterator]")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let range = {\n  from: 1,\n  to: 5,\n\n  // \u8fd9\u4e00\u884c\u7b49\u4ef7\u4e8e [Symbol.asyncIterator]: async function*() {\n  async *[Symbol.asyncIterator]() {\n    for(let value = this.from; value <= this.to; value++) {\n\n      // \u5728 value \u4e4b\u95f4\u6682\u505c\u4e00\u4f1a\u513f\uff0c\u6a21\u62df\u5f02\u6b65\u83b7\u53d6\u503c\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      // \u901a\u8fc7 yield \u8fd4\u56de\u503c\uff0c\u800c\u4e0d\u518d\u7528 next() \u65b9\u6cd5\n      yield value;\n    }\n  }\n};\n\n(async () => {\n  for await (let value of range) {\n    console.log(value); // \u95f4\u9694 1s \u4f9d\u6b21\u8f93\u51fa\uff1a1, 2, 3, 4, 5\n  }\n})();\n")),(0,r.kt)("h3",{id:"44-\u603b\u7ed3"},"4.4 \u603b\u7ed3"),(0,r.kt)("p",null,"\u5f02\u6b65 iterator \u4e0e\u5e38\u89c4 iterator \u5728\u8bed\u6cd5\u4e0a\u7684\u533a\u522b\uff1a"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"Iterator"),(0,r.kt)("th",{parentName:"tr",align:"left"},"async iterator"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"\u63d0\u4f9b iterator \u7684\u5bf9\u8c61\u65b9\u6cd5\uff1a"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Symbol.iterator")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Symbol.asyncIterator"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"next()")," \u8fd4\u56de\u7684\u503c\u662f\uff1a"),(0,r.kt)("td",{parentName:"tr",align:"left"},"IteratorResult"),(0,r.kt)("td",{parentName:"tr",align:"left"},"promise\uff0c\u51b3\u8bae\u503c\u662f IteratorResult")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"\u8981\u8fdb\u884c\u5faa\u73af\uff0c\u4f7f\u7528\uff1a"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"for..of")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"for await..of"))))),(0,r.kt)("p",null,"\u5f02\u6b65 generator \u51fd\u6570\u4e0e\u5e38\u89c4 generator \u51fd\u6570\u5728\u8bed\u6cd5\u4e0a\u7684\u533a\u522b\uff1a"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"Generator"),(0,r.kt)("th",{parentName:"tr",align:"left"},"\u5f02\u6b65 Generator"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"\u58f0\u660e\u65b9\u5f0f\uff1a"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"function* gen(){..}")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"async function* gen(){..}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"next()")," \u8fd4\u56de\u7684\u503c\u662f"),(0,r.kt)("td",{parentName:"tr",align:"left"},"IteratorResult"),(0,r.kt)("td",{parentName:"tr",align:"left"},"promise\uff0c\u51b3\u8bae\u503c\u662f IteratorResult")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"\u8981\u8fdb\u884c\u5faa\u73af\uff0c\u4f7f\u7528\uff1a"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"for..of")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"for await..of"))))),(0,r.kt)("p",null,"\u5e94\u7528\u80cc\u666f\uff1a"),(0,r.kt)("p",null,"\u5728 Web \u5f00\u53d1\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u9047\u5230\u6570\u636e\u6d41\uff0c\u5b83\u4eec\u5206\u6bb5\u6d41\u52a8\uff08flows chunk-by-chunk\uff09\u3002\u4f8b\u5982\uff0c\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5927\u6587\u4ef6\u3002"),(0,r.kt)("p",null,"\u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65 generator \u6765\u5904\u7406\u6b64\u7c7b\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6d4f\u89c8\u5668\u73af\u5883\u4e0b\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u79f0\u4e3a Streams \u7684 API\uff0c\u5b83\u63d0\u4f9b\u4e86\u7279\u6b8a\u7684\u63a5\u53e3\u6765\u5904\u7406\u6b64\u7c7b\u6570\u636e\u6d41\uff0c\u8f6c\u6362\u6570\u636e\u3001\u5e76\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u6570\u636e\u6d41\u4f20\u9012\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u6d41\uff08\u4f8b\u5982\uff0c\u4ece\u4e00\u4e2a\u5730\u65b9\u4e0b\u8f7d\u5e76\u7acb\u5373\u53d1\u9001\u5230\u5176\u4ed6\u5730\u65b9\uff09\u3002"))}N.isMDXComponent=!0},6975:function(e,n,t){n.Z=t.p+"assets/images/image-20220701114638804-7c68c7a84952d9fb91d43da0bf832575.png"}}]);