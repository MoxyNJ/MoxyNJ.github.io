---
title: 9. åŠ¨æ€è§„åˆ’ï¼ˆ2ï¼‰
sidebar_position: 9.2
date: 2022-06-11
tags: [algorithm]
---

åŠ¨æ€è§„åˆ’ï¼ˆ2ï¼‰ä¸»è¦è®²äº†åŠ¨æ€è§„åˆ’çš„æ‰“å®¶åŠ«èˆç³»åˆ—ã€ä¹°å–è‚¡ç¥¨ç³»åˆ—



## 198. æ‰“å®¶åŠ«èˆ

- [198. æ‰“å®¶åŠ«èˆ](https://leetcode.cn/problems/house-robber/)
- 0613ï¼Œmidï¼Œquick
- åŠ¨æ€è§„åˆ’

#### æ–¹æ³•ä¸€ï¼šäºŒç»´dp

1. ç¡®å®šdp

`dp[i][j]` è¡¨ç¤ºå·çªƒåˆ°ç¬¬ i å·æˆ¿å±‹æ—¶çš„æ”¶ç›Š

- `dp[i][0]` è¡¨ç¤ºä¸å·çªƒ i å·æˆ¿å±‹
- `dp[i][1]` è¡¨ç¤ºå·çªƒ i å·æˆ¿å±‹

2. çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

- æƒ…å†µä¸€ï¼šå½“å‰ðŸ  i ä¸å·ï¼Œåˆ™ä¸Šä¸€ä¸ªæˆ¿å±‹å·ä¹Ÿè¡Œï¼Œä¸å·ä¹Ÿè¡Œï¼Œé€‰æ‹©æœ€å¤§æ”¶ç›Šï¼š`Math.max(dp[i - 1][1], dp[i - 1][0])`ã€‚
- æƒ…å†µäºŒï¼šå½“å‰ðŸ  i å·ï¼šåˆ™åªèƒ½æ˜¯ä¸Šä¸€ä¸ªæˆ¿å±‹ä¸å· => `dp[i - 1][0] + nums[i]`ã€‚

3. åˆå§‹åŒ–
4. éåŽ†

```js
var rob = function (nums) {
  // dp[i][j] è¡¨ç¤ºå·çªƒåˆ°ç¬¬iå·æˆ¿å±‹æ—¶çš„æ”¶ç›Š
  // dp[i][0] è¡¨ç¤ºä¸å·çªƒiå·æˆ¿å±‹
  // dp[i][1] è¡¨ç¤ºå·çªƒiå·æˆ¿å±‹ã€‚
  const dp = Array.from(new Array(nums.length), () => new Array(2).fill(0));
  dp[0][1] = nums[0];

  for (let i = 1; i < nums.length; i++) {
    // iä¸å·ï¼šå‰ä¸€å¤©å·/ä¸å·çš„æœ€å¤§æ”¶ç›Š
    dp[i][0] = Math.max(dp[i - 1][1], dp[i - 1][0]);
    // iå·ï¼š[i-1] æ²¡å·ï¼Œåˆ™ièƒ½å·
    dp[i][1] = dp[i - 1][0] + nums[i];
  }
  // console.log(dp);
  return Math.max(dp[nums.length - 1][0], dp[nums.length - 1][1]);
};
```

#### æ–¹æ³•äºŒï¼šä¸€ç»´dp

1. ç¡®å®šdp

`dp[i]`ï¼šiï¼ˆåŒ…æ‹¬iï¼‰ä»¥å†…çš„æˆ¿å±‹ï¼Œæœ€å¤šå¯ä»¥å·çªƒçš„é‡‘é¢ä¸º`dp[i]`

2. çŠ¶æ€è½¬ç§»æ–¹ç¨‹

æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ i æˆ¿é—´å·è¿˜æ˜¯ä¸å·ï¼š

- å·ç¬¬ i æˆ¿é—´ï¼Œé‚£ä¹ˆ `dp[i] = dp[i - 2] + nums[i]` ï¼Œå³ï¼šç¬¬i-1æˆ¿ä¸€å®šä¸èƒ½å·ï¼Œæœ€å¤šå·çªƒçš„é‡‘é¢ä¸º `dp[i-2]` +  ç¬¬ i æˆ¿é—´å·çš„é’±ã€‚
- ä¸å·ç¬¬ i æˆ¿é—´ï¼Œé‚£ä¹ˆ`dp[i] = dp[i - 1]`ï¼Œå³ï¼šè€ƒè™‘ i-1 æˆ¿å¯ä»¥å·ï¼Œæ”¶ç›Šæ˜¯ i-1æˆ¿çš„æœ€å¤§æ”¶ç›Šï¼ˆä¸ä¸€å®šå·äº† i - 1ï¼‰ã€‚

æœ€åŽï¼Œå–æœ€å¤§å€¼ï¼Œå³ `dp[i] = max(dp[i - 2] + nums[i], dp[i - 1])`ï¼›

3. åˆå§‹åŒ–

- `dp[0]` ä¸€å®šæ˜¯å·ï¼Œæ‰æœ‰æœ€å¤§æ”¶ç›Š nums[0]ï¼Œä¸å·çš„æ”¶ç›Šæ˜¯ 0ï¼›

0 `	dp[1]` å¦‚æžœä¸å·ï¼Œæ”¶ç›Šæ˜¯ nums[0]ï¼›å¦‚æžœå·ï¼Œæ”¶ç›Šæ˜¯ num[1]ã€‚å–æœ€å¤§å€¼ã€‚

```js
var rob = function (nums) {
  const dp = [];
  dp[0] = nums[0];
  dp[1] = Math.max(nums[0], nums[1]);

  for (let i = 2; i < nums.length; i++) {
    // ä¸å· + å·
    dp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[i]);
  }
  // console.log(dp);
  return dp[nums.length - 1];
};
```

#### æ–¹æ³•ä¸‰ï¼šä¸€ç»´dpï½œæ»šåŠ¨æ•°ç»„

å› ä¸º `dp[i]` åªè¢« `i-1` å’Œ`i-2` å½±å“ï¼Œæ‰€ä»¥è®¾ç½®ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„ dp å³å¯ã€‚

æ³¨æ„ï¼šå› ä¸º return çš„ dp ä»Ž dp[length - 1] ä¿®æ”¹ä¸º å›ºå®šçš„ dp[1]ï¼Œæ‰€ä»¥æ³¨æ„ nums é•¿åº¦ä¸º 1 çš„æƒ…å†µã€‚åœ¨å¼€å¤´åˆ¤æ–­ç‰¹ä¾‹ã€‚

```js
var rob = function (nums) {
  if (nums.length === 1) return nums[0];
  const dp = [nums[0], Math.max(nums[0], nums[1])];

  for (let i = 2; i < nums.length; i++) {
    const profit = Math.max(dp[1], dp[0] + nums[i]); // ä¸å· + å·
    [dp[0], dp[1]] = [dp[1], profit];
  }
  return dp[1];
};
```



## 213. æ‰“å®¶åŠ«èˆ II

- [213. æ‰“å®¶åŠ«èˆ II](https://leetcode.cn/problems/house-robber-ii/)
- 0613ï¼Œmidï¼Œanswer
- åŠ¨æ€è§„åˆ’

#### æ–¹æ³•ä¸€ï¼šä¸€ç»´dp

æ ¹æ®åˆ†æžé¢˜æ„ï¼Œå¯ä»¥æ‹†åˆ†å‡ºä¸¤ç§æƒ…å†µï¼š

- å¦‚æžœðŸ  1 å·çªƒäº†ï¼Œæœ€åŽä¸€ä¸ªæˆ¿å±‹å°±ä¸èƒ½å·çªƒï¼Œåˆ¤æ–­å·çªƒçš„æˆ¿å±‹èŒƒå›´æ˜¯ï¼š`[0, len - 1]`ï¼›
- å¦‚æžœðŸ  1 ä¸å·çªƒï¼Œæœ€åŽä¸€ä¸ªæˆ¿å±‹å°±ä¸å—å½±å“ï¼Œæ­£å¸¸å¯å·ã€‚åˆ¤æ–­å·çªƒçš„æˆ¿å±‹èŒƒå›´æ˜¯ï¼š`[1, len]`ï¼›

åˆ™å®šåˆ¶ä¸ªæ–¹æ³• robbingï¼Œå…¥å‚ startï¼Œlenã€‚ç”¨æ¥è¡¨ç¤ºéåŽ†çš„æˆ¿å±‹èŒƒå›´ã€‚

æœ€åŽç»“æžœè¿”å›žä¸¤ä¸ª case çš„è¾ƒå¤§å€¼ã€‚

```js
var rob = function (nums) {
  // ç‰¹ä¾‹ï¼š
  if (nums.length === 1) return nums[0];
  // æƒ…å†µä¸€ï¼šå¦‚æžœç¬¬ä¸€ä¸ªè¢«å·ï¼Œæœ€åŽä¸€ä¸ªä¸èƒ½å·ï¼Œå‰ä¸€ä¸ªå¯ä»¥å·ï¼Œæˆ¿å±‹èŒƒå›´ï¼š[0, len - 1]
  const case1 = robbing(0, nums.length - 1);
  // æƒ…å†µäºŒï¼šå¦‚æžœç¬¬ä¸€ä¸ªæ²¡å·ï¼Œæœ€åŽä¸€ä¸ªå¯ä»¥å·ï¼Œæˆ¿å±‹èŒƒå›´ï¼š[1, len - 2]
  const case2 = robbing(1, nums.length);
  return Math.max(case1, case2);

  function robbing(start, len) {
    // åœ¨[start, len]è¿™ä¸ªèŒƒå›´å†…å·çªƒï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„[0, len]
    const dp = [];
    // åˆå§‹åŒ–
    dp[start] = nums[start];
    dp[start + 1] = Math.max(nums[start], nums[start + 1]);

    for (let i = start + 2; i < len; i++) {
      dp[i] = Math.max(dp[i - 1], dp[i - 2] + nums[i]); // ä¸å· + å·
    }
    return dp[len - 1];
  }
};
```

#### æ–¹æ³•äºŒï¼šä¸€ç»´dpï½œæ»šåŠ¨æ•°ç»„

è¿™é“é¢˜å½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ»šåŠ¨æ•°ç»„ï¼Œå¯¹ robbing ç¨åŠ æ”¹åŠ¨å³å¯ï¼š

- æ³¨æ„ç‰¹ä¾‹è¦å¯¹ nums.length === 2 æ—¶åˆ¤æ–­ã€‚

```js
var rob = function (nums) {
  // ç‰¹ä¾‹ï¼š
  if (nums.length === 1) return nums[0];
  if (nums.length === 2) return Math.max(nums[0], nums[1]);
  // æƒ…å†µä¸€ï¼šå¦‚æžœç¬¬ä¸€ä¸ªè¢«å·ï¼Œæœ€åŽä¸€ä¸ªä¸èƒ½å·ï¼Œæˆ¿å±‹èŒƒå›´ï¼š[0, len - 1]
  const case1 = robbing(0, nums.length - 1);
  // æƒ…å†µäºŒï¼šå¦‚æžœç¬¬ä¸€ä¸ªæ²¡å·ï¼Œæœ€åŽä¸€ä¸ªå¯ä»¥å·ï¼Œæˆ¿å±‹èŒƒå›´ï¼š[1, len - 2]
  const case2 = robbing(1, nums.length);
  return Math.max(case1, case2);

  function robbing(start, len) {
    const dp = [nums[start], Math.max(nums[start], nums[start + 1])];

    for (let i = start + 2; i < len; i++) {
      const profit = Math.max(dp[1], dp[0] + nums[i]); // ä¸å· + å·
      dp[0] = dp[1];
      dp[1] = profit;
    }
    return dp[1];
  }
};
```



## 337. æ‰“å®¶åŠ«èˆ III

- [337. æ‰“å®¶åŠ«èˆ III](https://leetcode.cn/problems/house-robber-iii/)
- 0613ï¼Œmidï¼Œ
- è®°å¿†åŒ–é€’å½’ï¼ŒåŠ¨æ€è§„åˆ’



æ ‘çš„é€’å½’ï¼Œæ˜¯è‡ªä¸‹è€Œä¸ŠåŽ»åšç»Ÿè®¡çš„ã€‚

æ¯”å¦‚åˆ¤æ–­æŸä¸ªèŠ‚ç‚¹ A çš„æœ€å¤§æ”¶ç›Šï¼Œæ˜¯åˆ¤æ–­ A å·²ç»è¿žå¸¦å®ƒçš„å­©å­ã€å­™å­ ... çš„æœ€å¤§æ”¶ç›Šï¼Œæ‰€ä»¥ï¼š

- å¶å­ç»“ç‚¹çš„æœ€å¤§æ”¶ç›Šå°±æ˜¯è‡ªèº« `node.val`ï¼›
- ç©ºèŠ‚ç‚¹æ²¡æœ‰æ”¶ç›Šï¼Œæ”¶ç›Šå€¼ä¸º `0`ï¼›

è¿™å’Œä¼ ç»Ÿçš„ `dp` ä»Žå‰å¾€åŽå åŠ æ”¶ç›Šä¸åŒï¼Œæ˜¯ä»Žåº•å‘ä¸Šå åŠ æ”¶ç›Šã€‚



#### æ–¹æ³•ä¸€ï¼šè®°å¿†åŒ–é€’å½’

å¯¹äºŒå‰æ ‘è€ƒè™‘ dfs é€’å½’ã€‚

- ä½¿ç”¨åŽåºéåŽ†ã€‚ é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›žå€¼æ¥åšä¸‹ä¸€æ­¥è®¡ç®—ã€‚å³ï¼šå…ˆèŽ·å¾—äº†å·¦å³å­©å­çš„å€¼ï¼Œè‡ªèº«çš„å€¼æ‰èƒ½ç¡®å®šã€‚

1. çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

å½“éåŽ†åˆ°æŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œæœ‰ä¸¤ä¸ª caseï¼š

- case1ï¼šå·å½“å‰èŠ‚ç‚¹çš„æˆ¿å­ï¼Œåˆ™æ”¶ç›Šä¸ºï¼šå½“å‰æˆ¿å±‹çš„æ”¶ç›Š + å·¦å³å­©å­å„è‡ªå­©å­çš„æ”¶ç›Šï¼ˆè·³è¿‡å·¦å³ä¸¤ä¸ªå­©å­ï¼Œçœ‹å››ä¸ªå­™å­ï¼‰ï¼›
- case2ï¼šä¸å·å½“å‰èŠ‚ç‚¹çš„æˆ¿å­ï¼Œåˆ™æ”¶ç›Šä¸ºï¼šå·¦å³å­©å­çš„æ”¶ç›Šï¼ˆè·³è¿‡è‡ªèº«æ”¶ç›Šï¼Œçœ‹ä¸¤ä¸ªå­©å­ï¼‰ï¼›

æœ€åŽå½“å‰èŠ‚ç‚¹çš„æœ€ä½³æ”¶ç›Šï¼š`Math.max(case1, case2)`ã€‚

2. è®°å¿†åŒ–é€’å½’ï¼šç”¨ map ç»“æž„æ¥å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—çš„æ”¶ç›Šï¼Œé˜²æ­¢é‡å¤è®¡ç®—ã€‚

- ä¸ºä»€ä¹ˆä¼šé‡å¤è®¡ç®—ï¼Ÿ

- å› ä¸ºè¿™ä¸æ˜¯ä¼ ç»Ÿçš„å…ˆåºã€ä¸­åºã€åŽåºéåŽ†ã€‚

  éåŽ†é“å½“å‰èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬ä¼šç›´æŽ¥éåŽ†å…¶ 2 ä¸ªå­©å­èŠ‚ç‚¹ +  4 ä¸ªå­™å­èŠ‚ç‚¹ï¼›è€ŒéåŽ†åˆ°å·¦å­©å­èŠ‚ç‚¹æ—¶ï¼Œä¹Ÿä¼šéåŽ†å®ƒçš„ä¸¤ä¸ªå­©å­ï¼Œä¹Ÿå°±æ˜¯å½“å‰èŠ‚ç‚¹çš„å­™å­èŠ‚ç‚¹ï¼Œè¿™å°±å‘ç”Ÿäº†é‡å¤ã€‚

```js
var rob = function (root) {
  const map = new Map();
  return dfs(root);

  //  è¡¨è¾¾å½“å‰nodeèŠ‚ç‚¹è¿”å›žçš„æ”¶ç›Š
  function dfs(node) {
    if (node === null) return 0 // éåŽ†åˆ°å¤´ï¼Œæ²¡æœ‰èŠ‚ç‚¹äº†ï¼Œè¿”å›žæ”¶ç›Š0
    if (map.has(node)) return map.get(node); // å¦‚æžœmapå·²ç»ä¿å­˜è¯¥å€¼ï¼Œåˆ™ç›´æŽ¥è¿”å›ž
    // å·è‡ªèº«ï¼Œè·³è¿‡å·¦å³å­èŠ‚ç‚¹ï¼Œç›´æŽ¥èŽ·å¾—å·¦å³å­©å­çš„å­©å­è¿”å›žçš„æ”¶ç›Š
    let profit1 = node.val;
    if (node.left) profit1 += dfs(node.left.left) + dfs(node.left.right);
    if (node.right) profit1 += dfs(node.right.left) + dfs(node.right.right);
    // å·å­èŠ‚ç‚¹ï¼Œè·³è¿‡è‡ªèº«ï¼ŒèŽ·å¾—å·¦å³å­©å­è¿”å›žçš„æ”¶ç›Š
    let profit2 = dfs(node.left) + dfs(node.right);
    map.set(node, Math.max(profit1, profit2));
    return map.get(node);
  }
};
```

#### æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’

**ç›¸æ¯”è®°å¿†åŒ–é€’å½’çš„å¥½å¤„ï¼š**

é¿å…é‡å¤è®¡ç®—èŠ‚ç‚¹ã€‚å› ä¸ºåŠ¨æ€è§„åˆ’æ€æƒ³çš„é€’å½’ï¼Œå¹¶æ²¡æœ‰è·³è¿‡ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œæ˜¯å®Œå…¨æ­£å¸¸çš„æŒ‰åºåŽåºéåŽ†ã€‚

- ä¸ºä»€ä¹ˆå¯ä»¥ä¸ç”¨è·³è¿‡ï¼Ÿ
- å› ä¸ºæ¯æ¬¡é€’å½’çš„è¿”å›žå€¼éƒ½æ˜¯ä¸¤ç§æƒ…å†µï¼šå·å’Œä¸å·ã€‚æ‰€ä»¥å½“å‰èŠ‚ç‚¹æ‹¿åˆ°å­©å­èŠ‚ç‚¹çš„è¿”å›žå€¼ï¼Œæ ¹æ®è‡ªå·± case çš„è¦æ±‚ï¼ŒèŽ·å–ç›¸åº”çš„æ•°å€¼å°±å¯ä»¥ã€‚
  - æ¯”å¦‚åœ¨è®°å¿†åŒ–é€’å½’ä¸­ï¼Œå¦‚æžœå½“å‰èŠ‚ç‚¹é€‰æ‹©ä¸å·ï¼Œé‚£ä¹ˆè¦è·³è¿‡å­©å­ï¼ŒèŽ·å–å››ä¸ªå­™å­çš„æœ€å¤§æ”¶ç›Šã€‚
  - è€Œåœ¨åŠ¨æ€è§„åˆ’ä¸­ï¼Œå¦‚æžœå½“å‰å½“å‰èŠ‚ç‚¹é€‰æ‹©ä¸å·ï¼Œä¸éœ€è¦è·³è¿‡ï¼Œç›´æŽ¥é€‰æ‹©å­©å­èŠ‚ç‚¹ä¸­ä¸å·çš„ç»“æž„å³å¯ `dp[0]`ã€‚

**æ€è·¯ï¼š**

å¯¹æ ‘ç»“æž„çš„åŠ¨æ€è§„åˆ’ï¼Œè¦ç»“åˆäºŒå‰æ ‘ + åŠ¨æ€è§„åˆ’çš„è§£é¢˜æ–¹æ³•ï¼š

- é€’å½’ä¸‰éƒ¨æ›²ï¼šç¡®å®šé€’å½’å‡½æ•°ï¼ˆå…¥å‚ / å‡ºå‚ï¼‰ã€ç¡®å®šç»ˆæ­¢æ¡ä»¶ã€ç¡®å®šéåŽ†é¡ºåº

- åŠ¨å½’äº”éƒ¨æ›²ï¼šç¡®å®š dp å«ä¹‰ã€ç¡®å®šçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€ç¡®å®š dp åˆå§‹åŒ–ã€ç¡®å®šéåŽ†æ¡ä»¶ã€æ‰‹åŠ¨dpä¸€ä¸ªæ¡ˆä¾‹éªŒè¯

1. **ç¡®å®šï¼šé€’å½’å‡½æ•°ï¼ˆå…¥å‚ / å‡ºå‚ï¼‰+ dp å«ä¹‰**

å¯¹æ¯ä¸ªèŠ‚ç‚¹ï¼ˆæˆ¿å±‹ï¼‰æœ‰å· / ä¸å· ä¸¤ä¸ª caseï¼Œåˆ™é€’å½’è¿”å›žå€¼åº”å½“æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ï¼š`[å·ï¼Œä¸å·]`ï¼Œåˆ†åˆ«æ˜¯å·å’Œä¸å·çš„æœ€å¤§æ”¶ç›Šã€‚

- `dp[0]`ï¼šå½“å‰èŠ‚ç‚¹ä¸å·çš„æœ€å¤§æ”¶ç›Šï¼›
- `dp[1]`ï¼šå½“å‰èŠ‚ç‚¹å·çš„æœ€å¤§æ”¶ç›Šã€‚

è¿™å…¶å®žæ˜¯ä¸€ä¸ªäºŒç»´ dpï¼Œè°ƒç”¨æ ˆä¸­çš„æ¯ä¸ªå‡½æ•°éƒ½ä¼šç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ã€‚è¿™ç›¸å½“äºŽ `dp[i][0]` å’Œ `dp[i][1]`ã€‚

2. **ç¡®å®šç»ˆæ­¢æ¡ä»¶**

é‡åˆ°ç©ºèŠ‚ç‚¹åˆ™è¾¾åˆ°è¾¹ç•Œï¼Œè¿”å›ž 0ã€‚

```js
if (node == NULL) return [0, 0];
```

3. **ç¡®å®šéåŽ†é¡ºåº**

åŽåºéåŽ†ã€‚é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›žå€¼æ¥åšä¸‹ä¸€æ­¥è®¡ç®—ã€‚

- å·¦ã€å³ã€æ ¹

4. **çŠ¶æ€è½¬ç§»æ–¹ç¨‹**

```js
// åŽåºéåŽ†ï¼šèŽ·å–å·¦å³èŠ‚ç‚¹å·/ä¸å·çš„æ”¶ç›Š
const left = dfs(node.left);
const right = dfs(node.right);
const val = node.val;
// ä¸å·å½“å‰èŠ‚ç‚¹ï¼šå·¦å³å­©å­éƒ½èƒ½å·ï¼Œåˆ†åˆ«å–ä»–ä»¬çš„è¾ƒå¤§å€¼
const profit1 = Math.max(left[0], left[1]) + Math.max(right[0], right[1]);
// å·å½“å‰èŠ‚ç‚¹ï¼šval
const profit2 = val + left[0] + right[0];
return [profit1, profit2];
```

å¾—ä»£ç ï¼š

```js
var rob = function (root) {
  const [profit1, profit2] = dfs(root);
  return Math.max(profit1, profit2);

  // è¡¨è¾¾å½“å‰nodeèŠ‚ç‚¹è¿”å›žçš„æ”¶ç›Š
  function dfs(node) {
    if (node === null) return [0, 0];
    // åŽåºéåŽ†ï¼šèŽ·å–å·¦å³èŠ‚ç‚¹å·/ä¸å·çš„æ”¶ç›Š
    const left = dfs(node.left);
    const right = dfs(node.right);
    const val = node.val;
    // ä¸å·å½“å‰èŠ‚ç‚¹ï¼šå·¦å³å­©å­éƒ½èƒ½å·ï¼Œåˆ†åˆ«å–ä»–ä»¬çš„è¾ƒå¤§å€¼
    const profit1 = Math.max(left[0], left[1]) + Math.max(right[0], right[1]);
    // å·å½“å‰èŠ‚ç‚¹ï¼šval
    const profit2 = val + left[0] + right[0];
    return [profit1, profit2];
  }
};
```



## 121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº

- [121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/)

- 0613ï¼Œeasyï¼Œnormal

#### æ–¹æ³•ä¸€ï¼šè´ªå¿ƒ

ç»“æžœä¸ºï¼šå³ä¾§æœ€å¤§å€¼ - å·¦ä¾§æœ€å°å€¼ã€‚æœ€å¤§å€¼çš„ä¸‹æ ‡åº”æ¯”æœ€å°å€¼çš„ä¸‹æ ‡é å³ã€‚

- `low` ä¸€ç›´èŽ·å–æ›´é å·¦ä¾§çš„æœ€å°å€¼ï¼›
- `result` ä¸æ–­è®¡ç®—å½“å‰å€¼ - å½“å‰æœ€å°å€¼çš„æ”¶ç›Šã€‚

```js
var maxProfit = function (prices) {
  // è´ªå¿ƒï¼šèŽ·å–æœ€å°å€¼å’Œæœ€å¤§å€¼
  let result = 0;
  let low = prices[0];
  for (let i = 0; i < prices.length; i++) {
    low = Math.min(prices[i], low);
    result = Math.max(result, prices[i] - low);
  }
  return result;
};
```

#### æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’ï½œæ»šåŠ¨æ•°ç»„

ç”¨äºŒç»´ `dp[i][j]` è®°å½•ï¼š

- `dp[i][0]`ï¼šå½“å‰ i ä»·æ ¼ä¸æŒæœ‰è‚¡ç¥¨ï¼›
- `dp[i][1]`ï¼šå½“å‰ i ä»·æ ¼æŒæœ‰è‚¡ç¥¨ï¼›

æ³¨æ„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

- ä¸æŒæœ‰ï¼šå¦‚æžœå‰ä¸€å¤©ä¸æŒæœ‰ï¼Œå°±ä¿æŒä¸å˜ï¼›å¦‚æžœå‰ä¸€å¤©æŒæœ‰ï¼Œå°±å½“å‰å–å‡ºï¼ŒèŽ·å¾—æ”¶ç›Šã€‚
  - `Math.max(dp[0], dp[1] + prices[i]);`
- æŒæœ‰ï¼šå¦‚æžœä¸€ç›´ä¸æŒæœ‰ï¼Œåˆ™å½“å‰ **ç¬¬ä¸€æ¬¡** å½“å‰ä¹°å…¥ï¼›å¦‚æžœå‰ä¸€å¤©æŒæœ‰ï¼Œåˆ™ä¿æŒä¸å˜
  - `Math.max(-prices[i], dp[1]);`
  - æ³¨æ„ï¼šè¿™é‡Œä¸€å®šæ˜¯ç¬¬ä¸€æ¬¡ä¹°å…¥ï¼Œå› ä¸ºé¢˜ç›®ä¸­è¦æ±‚åªèƒ½æœ‰ä¸€æ¬¡ä¹°å…¥ï¼Œæ‰€ä»¥å¦‚æžœåœ¨å½“å‰ä»·æ ¼ä¹°å…¥ï¼Œé‚£æ”¶ç›Šä¸€å®šæ˜¯ `-prices[i]`ï¼Œä¹‹å‰ä¸€å®šæ²¡æœ‰è¿›è¡Œè¿‡ä»»ä½•äº¤æ˜“ã€‚

è¿™é‡Œç›´æŽ¥æŠŠäºŒç»´æ•°ç»„ä¼˜åŒ–ä¸ºé•¿åº¦ä¸º 2 çš„æ»šåŠ¨æ•°ç»„ï¼š

```js
var maxProfit = function (prices) {
  // å½“å‰iä»·æ ¼ï¼šdp[i][0]ä¸æŒæœ‰è‚¡ç¥¨, dp[i][1]æŒæœ‰è‚¡ç¥¨
  const dp = [0, -prices[0]];
  for (let i = 1; i < prices.length; i++) {
    // ä¸æŒæœ‰:å‰ä¸€å¤©ä¸æŒæœ‰,ä¿æŒä¸å˜ + å‰ä¸€å¤©æŒæœ‰,å½“å‰å–å‡º,èŽ·å¾—æ”¶ç›Š
    const unhold = Math.max(dp[0], dp[1] + prices[i]);
    // æŒæœ‰:ä¸€ç›´ä¸æŒæœ‰,å½“å‰ä¹°å…¥ + å‰ä¸€å¤©æŒæœ‰,ä¿æŒä¸å˜
    const hold = Math.max(-prices[i], dp[1]);
    dp[0] = unhold;
    dp[1] = hold;
  }
  return dp[0];
};
```



## 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II

- [122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/)
- 0613ï¼Œmidï¼Œquick
- åŠ¨æ€è§„åˆ’

#### æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’ï½œæ»šåŠ¨æ•°ç»„

å¦‚æžœæƒ³çœ‹ä¼ ç»Ÿçš„äºŒç»´dpè§£æžï¼Œè§ï¼šè´ªå¿ƒç« èŠ‚ä¸­å¯¹è¯¥é¢˜çš„è§£ç­”ã€‚

ä¸Žä¸Šä¸€é¢˜ç›¸æ¯”ï¼Œå¯ä»¥å¤šæ¬¡ä¹°å–ï¼Œæ¯æ¬¡æ˜¯å¦æŒæœ‰å‘ç”Ÿæ”¹å˜ï¼Œéƒ½éœ€è¦å‚è€ƒä¸Šä¸€æ¬¡ï¼ˆ`dp[i-1]`ï¼‰ çš„å€¼ã€‚

è¿™é‡Œç›´æŽ¥æŠŠäºŒç»´æ•°ç»„ä¼˜åŒ–ä¸ºé•¿åº¦ä¸º 2 çš„æ»šåŠ¨æ•°ç»„ï¼š

```js
var maxProfit = function (prices) {
  // dp[i][0] è¡¨ç¤ºç¬¬iå¤©ä¸æŒæœ‰
  // dp[i][1] è¡¨ç¤ºç¬¬iå¤©æŒæœ‰
  const dp = [0, -prices[0]];
  for (let i = 0; i < prices.length; i++) {
    // ä¸æŒæœ‰ï¼šä¹‹å‰ä¸æŒæœ‰ï¼›ä¹‹å‰æŒæœ‰ï¼Œå–å‡º
    const unhold = Math.max(dp[0], dp[1] + prices[i]);
    // æŒæœ‰ï¼šä¹‹å‰ä¸æŒæœ‰ï¼Œä¹°å…¥ï¼›ä¹‹å‰æŒæœ‰
    const hold = Math.max(dp[0] - prices[i], dp[1]);
    dp[0] = unhold;
    dp[1] = hold;
  }
  return dp[0];
};
```



## 123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III

- [123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/)
- 0613ï¼Œhardï¼Œanswer
- åŠ¨æ€è§„åˆ’

æœ¬é¢˜å¯æœ€å¤šäº¤æ˜“2æ¬¡ï¼Œè¿™æ„å‘³ç€å¯ä»¥æœ‰ 1ï½ž2 æ¬¡äº¤æ˜“ï¼Œå…ˆä»ŽçŠ¶æ€æœºè§’åº¦åˆ†æžè¿™äº”ç§çŠ¶æ€ï¼š

- æ²¡æœ‰ä»»ä½•ä¹°å…¥ / å–å‡ºè¡Œä¸ºï¼ŒçŠ¶æ€ä¸€ï¼šä¸æŒæœ‰è‚¡ç¥¨ï¼š`dp[i][0]`

- ç¬¬ä¸€æ¬¡ä¹°å…¥ ===> çŠ¶æ€äºŒï¼ŒæŒæœ‰ç¬¬ä¸€æ”¯è‚¡ç¥¨ï¼š`dp[i][1]`
- ç¬¬ä¸€æ¬¡å–å‡º ===> çŠ¶æ€ä¸‰ï¼Œä¸æŒæœ‰è‚¡ç¥¨ï¼š`dp[i][2]`
- ç¬¬äºŒæ¬¡ä¹°å…¥ ===> çŠ¶æ€å››ï¼ŒæŒæœ‰ç¬¬äºŒæ”¯è‚¡ç¥¨ï¼š`dp[i][3]`
- ç¬¬äºŒæ¬¡å–å‡º ===> çŠ¶æ€äº”ï¼Œä¸æŒæœ‰è‚¡ç¥¨ï¼š`dp[i][4]`

1. å®šä¹‰ dp

æ‰€ä»¥ï¼Œä»Žä¸Šé¢é¡ºä¾¿ä¹Ÿå®šä¹‰äº† dp çš„å«ä¹‰ï¼š`dp[i][j]` è¡¨ç¤ºå½“è‚¡ç¥¨ä»·æ ¼ä¸º i æ—¶çš„çŠ¶æ€ã€‚

2. åˆå§‹åŒ–ï¼š

- `dp[0][0]` æ²¡æœ‰ä»»ä½•äº¤æ˜“ï¼Œä¸€å®šä¸º 0ï¼›
- `dp[0][1]` è´­å…¥ç¬¬ä¸€æ”¯è‚¡ç¥¨ï¼Œæ”¶ç›Šä¸º `-prices[i]`
- `dp[0][2]` å‡ºå”®ç¬¬ä¸€æ”¯è‚¡ç¥¨ï¼Œå¯ä»¥æƒ³è±¡ä¸ºå½“å¤©ä¹°å½“å¤©å–ï¼Œæ”¶ç›Š 0ï¼›
- `dp[0][3]` è´­å…¥ç¬¬äºŒæ”¯è‚¡ç¥¨ï¼Œæƒ³è±¡ä¸ºå½“å¤©ä¹°å–äº†ç¬¬ä¸€æ”¯ï¼Œæ”¶ç›Š 0 ï¼Œä¹°å…¥ç¬¬äºŒæ”¯æ”¶ç›Šä¸º `-prices[i]`
- `dp[0][4]` å‡ºå”®ç¬¬äºŒæ”¯è‚¡ç¥¨ï¼Œå½“å¤©ä¹°çš„å½“å¤©å–ï¼Œæ”¶ç›Š 0ã€‚

```js
var maxProfit = function (prices) {
  const dp = Array.from(new Array(prices.length), () => new Array(5).fill(0));
  dp[0][1] = -prices[0];
  dp[0][3] = -prices[0];

  for (let i = 1; i < prices.length; i++) {
    // æ²¡æœ‰ä¹°å–
    dp[i][0] = dp[i - 1][0];
    // æŒæœ‰ç¬¬ä¸€æ”¯è‚¡ç¥¨:ä»¥å‰æŒæœ‰ + åˆšæŒæœ‰
    dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] - prices[i]);
    // å·²å‡ºå”®ç¬¬ä¸€æ”¯è‚¡ç¥¨:ä»¥å‰å‡ºå”® + åˆšå‡ºå”®
    dp[i][2] = Math.max(dp[i - 1][2], dp[i - 1][1] + prices[i]);
    // æŒæœ‰ç¬¬äºŒæ”¯
    dp[i][3] = Math.max(dp[i - 1][3], dp[i - 1][2] - prices[i]);
    // å·²å‡ºå”®ç¬¬äºŒæ”¯
    dp[i][4] = Math.max(dp[i - 1][4], dp[i - 1][3] + prices[i]);
  }
  return dp[prices.length-1][4];
};
```

#### æ–¹æ³•äºŒï¼šä¸€ç»´dpï½œæ»šåŠ¨æ•°ç»„

1. å½“å‰æ—¶é—´ i çš„æ”¶ç›Šåªå—ä¸Šä¸€ä¸ªæ—¶é—´ i - 1çš„å½±å“ï¼Œæ‰€ä»¥å¯ä»¥ä¼˜åŒ–ä¸ºæ»šåŠ¨æ•°ç»„ã€‚
2. åŒæ—¶å¯ä»¥çœç•¥æƒ…å†µä¸€ï¼Œå› ä¸ºæœ€å¼€å§‹æ²¡æœ‰ä¹°å–ï¼Œæ”¶ç›Šä¸€å®šæ˜¯ä¸€ç›´ä¸º 0 çš„ã€‚

```js
var maxProfit = function (prices) {
  let dp = new Array(4).fill(0);
  dp[0] = -prices[0];
  dp[2] = -prices[0];

  for (let i = 1; i < prices.length; i++) {
    // æŒæœ‰ç¬¬ä¸€æ”¯è‚¡ç¥¨:ä»¥å‰æŒæœ‰ + åˆšæŒæœ‰
    const r0 = Math.max(dp[0], -prices[i]);
    // å·²å‡ºå”®ç¬¬ä¸€æ”¯è‚¡ç¥¨:ä»¥å‰å‡ºå”® + åˆšå‡ºå”®
    const r1 = Math.max(dp[1], dp[0] + prices[i]);
    // æŒæœ‰ç¬¬äºŒæ”¯
    const r2 = Math.max(dp[2], dp[1] - prices[i]);
    // å·²å‡ºå”®ç¬¬äºŒæ”¯
    const r3 = Math.max(dp[3], dp[2] + prices[i]);
    dp = [r0, r1, r2, r3];
  }
  return dp[3];
};
```

































