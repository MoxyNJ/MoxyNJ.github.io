<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-frontEnd/other/webpack">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="ninjee RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="ninjee Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="ninjee JSON Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Ninjee的前端篮子" href="/opensearch.xml">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0930342e569f854bebdeb485c0eac7f8",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<link rel="icon" href="/img/ninjee.jpeg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><title data-rh="true">Webpack - Ninjee的前端篮子</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" name="twitter:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" property="og:url" content="https://ninjee.netlify.app/docs/frontEnd/other/webpack"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="keywords" content="Moxy, Ninjee, blog, javascript, typescript, python ,node, react, vue, web, 前端, 后端"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Webpack - Ninjee的前端篮子"><meta data-rh="true" name="description" content="1. Webpack 定义"><meta data-rh="true" property="og:description" content="1. Webpack 定义"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ninjee.netlify.app/docs/frontEnd/other/webpack"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/other/webpack" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/other/webpack" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AJRH2JRXVY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.cb2f47c4.css">
<link rel="preload" href="/assets/js/runtime~main.05dd1c40.js" as="script">
<link rel="preload" href="/assets/js/main.ab88f873.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Ninjee</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">前端知识</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/frontEnd/JavaScript">JavaScript</a></li><li><a class="dropdown__link" href="/docs/frontEnd/HTML&amp;CSS">HTML &amp; CSS</a></li><li><a class="dropdown__link" href="/docs/frontEnd/React">React</a></li><li><a class="dropdown__link" href="/docs/frontEnd/浏览器原理">浏览器原理</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/frontEnd/other">other</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">敲代码</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/code/algorithm">算法</a></li><li><a class="dropdown__link" href="/docs/code/writtenJs">手写Js</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">面试</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/interview/summary">总结</a></li><li><a class="dropdown__link" href="/docs/interview/iot">物联网</a></li></ul></div><a class="navbar__item navbar__link" href="/project">我的项目</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/javascript">JavaScript</a><button aria-label="打开/收起侧边栏菜单「JavaScript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/html--css">HTML &amp; CSS</a><button aria-label="打开/收起侧边栏菜单「HTML &amp; CSS」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/react">React</a><button aria-label="打开/收起侧边栏菜单「React」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/浏览器原理">浏览器原理</a><button aria-label="打开/收起侧边栏菜单「浏览器原理」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/other">other</a><button aria-label="打开/收起侧边栏菜单「other」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/other">概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/other/Ajax&amp;Axios">Ajax、Axios</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/frontEnd/other/webpack">Webpack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/other/Typescript">Typescript</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/algorithm">algorithm</a><button aria-label="打开/收起侧边栏菜单「algorithm」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/手写-js">手写 Js</a><button aria-label="打开/收起侧边栏菜单「手写 Js」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/总结">总结</a><button aria-label="打开/收起侧边栏菜单「总结」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_FykI"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_DTRl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/other"><span itemprop="name">other</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Webpack</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Webpack</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-webpack-定义">1. Webpack 定义<a class="hash-link" href="#1-webpack-定义" title="标题的直接链接">​</a></h2><p>放到了最下面的问题。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="12-webpack-产生的背景">1.2 webpack 产生的背景<a class="hash-link" href="#12-webpack-产生的背景" title="标题的直接链接">​</a></h3><p>首先，为什么打包？因为：</p><ol><li>各个依赖文件的关系难以梳理，耦合程度较高，代码难以维护。</li><li>把所有依赖包都打包成为一个js文件（bundle.js）文件，会有效降低文件请求次数，一定程度提升性能。</li><li>逻辑多、文件多，项目复杂度提高</li></ol><p>为什么要用webpack？因为：</p><ol><li>webpack 除提供上述功能外，还充当了“翻译官”的角色，例如将 TS、ES6 翻译为低版本的语法，将less、sass 翻译为 css 等功能。</li><li>强大而灵活，plugin 可插拔，按需加载。</li></ol><p>重点：</p><ol><li>理解前端模块化，各种模块化方式是如何实现的；</li><li>理解 Webpack 打包的核心思路；</li><li>理解 Webpack 中的 ‘关键人物’；</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="13-前端模块化">1.3 前端模块化<a class="hash-link" href="#13-前端模块化" title="标题的直接链接">​</a></h3><p>早起模块化的实现方法：</p><p>不同的 module（moduleA.js， moduleB.js，moduleC.js） 会放在不同的 js 文件中。但是如果把所有的 js 文件通过 <code>script</code> 标签引入同一个 HTML 文件中时，这些 js 文件都会绑定到全局作用域中。这就导致了如果在不同的 js 文件中不小心使用了相同的变量名，就会发生命名冲突和值的覆盖。</p><p>为了避免这种命名空间的冲突，会采用模块化封装，下面是一个早期的封装方式，采用立即执行函数 IIFE 和 闭包实现：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 定义模块内的模块作用域</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">window</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;susan&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> sex </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;female&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    functioon </span><span class="token function" style="color:#d73a49">tell</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;im &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">susanModule </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">tell</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">window</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>最终这个 susanModule 绑定在了 window 全局对象中，在 node 环境中是 global 对象。</p><p>封装的好处就是，该暴露的数值可以暴露，想隐藏的数值也隐藏。</p><ul><li>这里的例子中 name  和 sex 的变量就变得无法修改，而只能通过 tell function 去访问，达到了对数据的封装，提升安全性。</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="模块化的优点">模块化的优点<a class="hash-link" href="#模块化的优点" title="标题的直接链接">​</a></h4><ul><li>模块化的封装（该暴露的暴露，该隐藏的隐藏）</li><li>重用性（不同的网页可以通用相同的模块）</li><li>解除耦合（不同的模块之间不会相互关联影响）</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="14-模块化方案进化史">1.4 模块化方案进化史<a class="hash-link" href="#14-模块化方案进化史" title="标题的直接链接">​</a></h3><p>随着模块化优势体现，开发者更倾向于使用模块化协同开发项目，于是在发展过程中形成了很多规范：AMD、COMMONJS、ES6 MODULE</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="141-amd">1.4.1 AMD<a class="hash-link" href="#141-amd" title="标题的直接链接">​</a></h4><p>Asynchronous Module Definition（异步模块定义）
定义最早，目前很少使用。</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 求和模块，参数依次是：当前模块名、依赖的模块、模块内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">define</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;getSum&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;math&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">math</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;sum:&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="142-commonjs">1.4.2 COMMONJS<a class="hash-link" href="#142-commonjs" title="标题的直接链接">​</a></h4><p>2009年出的规范，原本是为服务端的规范，后来 nodejs 采用 commonjs 模块化规范</p><ul><li>模块必须显示的引入</li></ul><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 通过require函数来引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> math </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./math&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 通过exports将其导出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function" style="color:#d73a49">getSum</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="143-es6-module">1.4.3 ES6 MODULE<a class="hash-link" href="#143-es6-module" title="标题的直接链接">​</a></h4><p>目前使用最多的便是这个，JavaScript 提供了原生支持的模块打包方式，使用 <code>import</code> 和 <code>export</code>。</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 通过import函数来引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> math </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./math&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 通过export将其导出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="15-webpack-的打包机制">1.5 Webpack 的打包机制<a class="hash-link" href="#15-webpack-的打包机制" title="标题的直接链接">​</a></h3><p>根据 <code>import</code> 引入等关键字，将依赖文件打包成一个文件。</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="151-输出文件">1.5.1 输出文件<a class="hash-link" href="#151-输出文件" title="标题的直接链接">​</a></h4><p>输出文件的大体结构：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">module</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> installedModules </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__webpack_require__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">moduleId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// SOME CODE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 。。。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__webpack_require__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// entry file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* modules array */</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>上述结构中的核心方法：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__webpack_require__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">moduleId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// check if module is in cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">installedModules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">moduleId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> installedModules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">moduleId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// create a new module (and put into cache)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> installedModules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">moduleId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">i</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> moduleId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">l</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">exports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// exe the module func</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">moduleId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        module</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __webpack_require__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// flag the module as loaded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// return the exxports of the module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="152-webpack打包过程">1.5.2 Webpack打包过程<a class="hash-link" href="#152-webpack打包过程" title="标题的直接链接">​</a></h4><ol><li>从入口文件开始，分析整个应用的依赖树</li><li>将每个依赖模块包装起来，放到一个数组中等待调用</li><li>实现模块加载的方法，并把它放到模块执行的环境中，确保模块间可以互相调用</li><li>把执行入口文件的逻辑放在一个函数表达式中，并立即执行这个函数</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-配置开发环境----npm包管理器">2. 配置开发环境 -- npm、包管理器<a class="hash-link" href="#2-配置开发环境----npm包管理器" title="标题的直接链接">​</a></h2><ul><li>创建一个工程：<code>npm init</code></li><li>也可以使用 <code>npm init -y</code>，直接生成了一个默认配置的 <code>package.json</code>，不需要一路回车。</li></ul><p>分析：<code>package.json</code> 版本信息文件</p><p><img loading="lazy" alt="image-20220630213046661" src="/assets/images/image-20220630213046661-c27df8fc7f4da370756749c890fdeb56.png" width="1079" height="487" class="img_E7b_"></p><ul><li>运行自定义命令：<code>npm run test</code>，就可以运行 <code>test</code> 后面命令的值，类似一个快捷键。这里就执行了后面的 <code>echo..</code> 这个命令。</li></ul><p>安装时的命令：</p><ul><li><code>npm config set registry https://registry.npm.taobao.org</code> 下载包的地址调整为淘宝镜像</li><li><code>npm install loadash --save</code><ul><li><code>--save</code>，npm5xx 以上可省略。下载好包后，还会把这个包放到 <code>package.json</code> 的 <code>dependencies</code> 字段下保存：<code>&quot;loadash: &quot;^1.0.0</code>。</li><li><code>--save-dev</code>，指定当前环境是开发环境。会把这个包放到 <code>package.json</code> 的 <code>devDependencies</code> 字段下保存：<code>&quot;loadash: &quot;^1.0.0</code>。</li><li><code>--only=prod</code>，<code>--only=dev</code> 指定这个包安装在生产环境下 / 开发环境下。如果不指定，则默认会安装在 <code>node_modules</code> 中。在较大的工程项目中会实现环境区分， 比如只安装 <code>dependencies</code> 提升安装速度。</li></ul></li><li><code>npm</code> 安装 <code>webpack-cli</code>，<code>webpack-dev-server</code>。<ul><li>事实上，在 <code>node_modules</code> 中项目已经装好了这些依赖，不需要在重新 <code>npm</code> 安装后才能运行 <code>webpack-dev-server</code> ，可以直接：<code>./node_modules/.bin/webpack-dev-server</code> 运行该依赖。</li></ul></li></ul><p><img loading="lazy" alt="image-20220630213057347" src="/assets/images/image-20220630213057347-aa0c92f5ae5e606e3f58d94f537abfea.png" width="1071" height="671" class="img_E7b_"></p><p>主要有两种依赖：</p><ol><li><code>dependencies</code> 生产环境下的依赖。通常项目迁移到别处时，重现安装依赖会默认 <code>dependencies</code> 中的依赖，这里放和项目习惯的功能模块。</li><li><code>devDependencies</code>  开发环境下的依赖。 通常反正构建工具、质量检测工具</li></ol><p><code>package.json</code> 中的 <code>&quot;scripts&quot;</code> 字段</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo \&quot;Error: no test specifed\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;dev&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>dev</code>：运行 <code>npm run dev</code> 可以原地启动一个 webpack 开发服务器。</p><ul><li>更新：<code>npm run start</code> 是最新的命令</li></ul><p><code>build</code>：运行 <code>npm run build</code> 可以对代码格式做校验，对文件进行打包。</p><p><code>npm install</code> 的过程：</p><ol><li>寻找包版本信息文件 (package.json)，依照它来进行安装；</li><li>查找 <code>package.json</code> 中的依赖，并检查项目中其他的版本信息文件；</li><li>如果发现了新包，就更新版本信息文件； </li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-webpack-核心特性">3. Webpack 核心特性<a class="hash-link" href="#3-webpack-核心特性" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="31-安装和入口">3.1 安装和入口<a class="hash-link" href="#31-安装和入口" title="标题的直接链接">​</a></h3><p>入口文件： <code>src/index.js</code> 当运行 <code>webpack </code> 进行打包后，会把 <code>index</code> 入口文件中引入的全部模块打包起来，放到 <code>dist/main.js</code> 中。</p><p>如果想修改入口文件，就需要自定义配置，通常会在根目录一个定义文件 <code>webpack.config.js</code> 来修改和定义配置：</p><p><img loading="lazy" alt="image-20220630213112204" src="/assets/images/image-20220630213112204-63676675773f6548af27a884beeab143.png" width="1227" height="681" class="img_E7b_"></p><ul><li><code>entry</code> ：工程资源的入口，俗称入口文件，可以理解为依赖树的根，可以有多个入口，每个入口都会有一个对应的打包结果： <code>./app.js</code>。</li><li><code>output</code> ：打包结果，俗称出口文件：<code>dist/bundule.js</code>。<ul><li><code>path</code> ：必须是绝对路径，所以这里用到了 <code>path.join()</code> 校验地址；</li><li><code>filename</code>：打包结果的文件名。</li></ul></li></ul><p><code>webpack-dev-server</code>：监听工程文件的改动，可以自动打包文件，刷新浏览器。</p><ul><li><code>port</code>，修改默认的服务器地址，：<code>localhost:8080</code></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="32-loader---文件加载器">3.2 loader - 文件加载器<a class="hash-link" href="#32-loader---文件加载器" title="标题的直接链接">​</a></h3><p><code>loader</code> 是一个文件维度的操作，通常文件的操作的包，就需要用 loader 加载。比如后面会讲到的 babel 就需要通过 loader 加载。</p><p>接着上文的 webpack.config.js 文件</p><p><img loading="lazy" alt="image-20220630213122115" src="/assets/images/image-20220630213122115-0fbed4113950006127988ede40343f27.png" width="854" height="669" class="img_E7b_"></p><p>可以让 webpack 打包和引入 css、less、scss、png 等各种模块；</p><p><code>npm install css-loader --save-dev</code>，安装可以引入 css 的 loader。</p><p>在 <code>webpack.config.js</code> 使用 <code>loader</code>。</p><ul><li><code>module</code> 下的 <code>rules</code> 中配置。<ul><li><code>test</code>：<code>.css</code> 处理 <code>.css</code> 文件。</li><li><code>use</code>：这个文件需要被哪些 loader 来处理；<ul><li><code>style-loader</code>：自动生成一个样式 style 标签，加载该样式；</li><li><code>css-loader</code>：让  js 可以解析  <code>import sytle.css</code>  这个代码；</li></ul></li></ul></li></ul><p><strong>注意，loader 的实际配置顺序是从下往上的，和书写的方式相反。</strong></p><ul><li>所以我们想优先加载的配置，要放在末尾。这里的顺序是固定的，即，先加载 <code>css-loader</code> 再加载 <code>style-loader</code>。</li></ul><p>生效后，可以解析 js 代码中的 <code>import sytle.css</code> 这类文件了。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="33-plugins---插件">3.3 plugins - 插件<a class="hash-link" href="#33-plugins---插件" title="标题的直接链接">​</a></h3><p>节点维度的处理。</p><p><code>plugin</code> 通过事件监听机制，改变文件打包后的输出结果。</p><ul><li>比如，对资源进行压缩处理，让文件更快的从服务端传递给浏览器。从代码中去掉不需要的内容，如注释、换行、空格等等，减小整体体积。</li></ul><p>安装一个压缩的 plugin：<code>npm install uglifyjs-webpack-plugin --save-dev</code></p><p>安装后，就可以在 <code>webpack.config.js</code> 的 <code>plugin</code> 中引入并生效：</p><ol><li>在文件的开头需要引入这个库：<code>const UglifyJSPlugin = require(&#x27;uglifyjs-webpack-plugin&#x27;)</code> </li><li>在 <code>plugin</code> 字段中创建并引入这个库：</li></ol><p><img loading="lazy" alt="image-20211201120058877" src="/assets/images/image-20211201120058877-89f5df5654e963a3bc9f1ea49a734c61.png" width="1198" height="184" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-webpack-构建工程">4. webpack 构建工程<a class="hash-link" href="#4-webpack-构建工程" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="41-构建">4.1 构建<a class="hash-link" href="#41-构建" title="标题的直接链接">​</a></h3><p>模拟一个 <code>react</code> 项目的构建过程：</p><ul><li><code>npm install react react-dom</code></li><li>安装 webpack 依赖，webpack 和 webpack 的命令行 cil工具。<ul><li><code>npm install webpack webpack-cli -d</code><ul><li>development 开发环境下安装，是 <code>--save-dev</code> 的简写。模块会写入到 <code>devDependencies </code> 字段下，安装在项目的 <code>node_modules</code> 中。需要输入 <code>./node_modules/.bin/webpack</code> 命令使用 webpack。</li></ul></li><li><code>npm install webpack webpack-cli -g</code><ul><li>安装在电脑操作系统的全局中，可以输入 <code>webpack</code> 命令直接启动。一般会安装到AppDataAppData\Roaming\npm目录下</li></ul></li><li><code>npm install webpack webpack-cli</code><ul><li>默认，在生产环境下安装</li></ul></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="42-babel">4.2 babel<a class="hash-link" href="#42-babel" title="标题的直接链接">​</a></h3><p><code>babel</code> 可以把 ES6、Jsx 等形式的 js 文件，转化为 ES5 版本的 js 文件。通常使用 loader 引入。</p><p>相关的常用库有 (5)：</p><ul><li><code>@babel/core</code>、<code>@babel/cil</code>、<code>@babel/preset-env</code>、<code>@babel/preset-react</code>、<code>babel-loader</code></li></ul><ul><li><p><code>npm install @babel/core @babel/cil -g</code></p><ul><li>安装 babel 的核心库 core 和命令行 cil 工具。</li></ul></li><li><p><code>npm install @babel/preset-env @babel/preset-react</code> </p><ul><li><p>安装 babel 的转换规则，这个包可以把高版本的 JS 代码转换为 低版本的 ES5；</p></li><li><p><code>preset-env</code> 可以把高版本 Js 代码转化为 ES5；</p></li><li><p><code>preset-react</code> 可以把 Jsx 格式的文件转化为 Js 文件；</p></li><li><p>安装好后，可以把包含 ES5 的代码 <code>test.js</code> ，通过在命令行运行 <code>babel test.js --presets=@babel/preset-env</code> 直接转化为  ES5 代码:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// test.js 文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="image-20211201122704381" src="/assets/images/image-20211201122704381-a371145ee9f22b89ec5790cbd16cd3cf.png" width="1445" height="280" class="img_E7b_"></p></li></ul></li><li><p><code>npm install babel-loader</code> </p><ul><li>通过 loader 的方式引入 babel，需要这个库的支持。</li></ul></li></ul><p><strong>改进1：</strong>可以在 <code>package.json</code> 中制定 babel 规则：</p><p><img loading="lazy" alt="image-20211201122807296" src="/assets/images/image-20211201122807296-cfacbc9a17b89356601d06b6b1d507d3.png" width="1012" height="135" class="img_E7b_"></p><p>这样就不需要在输入 <code>babel test.js --presets=@babel/preset-env</code>  去寻找规则，直接 <code>babel test.js</code> 就可以了。</p><p><strong>改进2：</strong>直接创建一个独立的文件 <code>.babelrc</code> ，可以更方便的修改 babel 规则。</p><ul><li><code>babel</code> 会优先查找 <code>.babelrc</code> 这个文件，如果不存在就会遍历到 <code>package.json</code> 中去寻找。</li></ul><p><img loading="lazy" alt="image-20211201123112000" src="/assets/images/image-20211201123112000-864084d1329b3bdc063ba48f4ae99073.png" width="1005" height="136" class="img_E7b_"></p><p>在项目中引入 <code>babel</code>，通过文件操作层级的 <code>loader</code>。</p><p>在 <code>webpack.config.js</code> 中自定义：</p><p><img loading="lazy" alt="image-20220630213201704" src="/assets/images/image-20220630213201704-1e8eeb1f76e5ef73ffcbf8540a1fc0ec.png" width="1361" height="627" class="img_E7b_"></p><ul><li>test：通过正则，引入 .js 和 .jsx 格式文件。</li><li>exclude：排除在外的地址，不转换 node_modules 中的文件。</li><li>use：<ul><li>loader：加载方式使用 babel-loader，需要提前 npm 安装 <code>babel-loader</code>。</li></ul></li></ul><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.jsx?</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                         </span><span class="token comment" style="color:#999988;font-style:italic">// 需要转化 .js 和 .jsx 文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">exclude</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">node_modules</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 排除 node_modules 地址的文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token literal-property property" style="color:#36acaa">loader</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;babel-loader&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// 使用babel-loader加载babel规则</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">babelrc</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// 告知babel，没有babelrc规则文件，babel规则都在这里找</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">presets</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">                          </span><span class="token comment" style="color:#999988;font-style:italic">// 引入babel转化规则</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@babel/preset-react&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// 转化jsx语法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@babel/preset-env&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//转化高版本JS语法，</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                                                  </span><span class="token comment" style="color:#999988;font-style:italic">//不转化module规则，因为webpack支持import,export规则</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">cacheDirecrtory</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ture</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">//需要添加缓存，默认是false，添加缓存后可以提升加载速度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="43-html-webpack-plugin">4.3 html-webpack-plugin<a class="hash-link" href="#43-html-webpack-plugin" title="标题的直接链接">​</a></h3><p>插件的基本作用就是转化并生成 html 文件。</p><ul><li>为 html 文件中引入的外部资源如 script、link 动态添加每次 compile 后的 hash，防止引用缓存的外部文件问题；</li><li>可以生成创建 html 入口文件，比如单页面可以生成一个 html 文件入口，配置 N 个 html-webpack-plugin 可以生成 N 个页面入口；</li></ul><p>安装：<code>npm install html-webpack-plugin -d</code></p><p>配置：在 <code>webpack.config.js</code> 中，</p><ol><li><p>引入 <code>const HtmlWebPackPlugin = require(&#x27;html-webpack-plugin&#x27;)</code></p></li><li><p>在 module 中配置：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> HtmlWebPackPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;html-webpack-plugin&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 会把所有路径引入，并转化为绝对路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 上面 babel 相关设置在这里</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">HTMLWebPackPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                                                     </span><span class="token comment" style="color:#999988;font-style:italic">// 引入HTMLWebPackPlugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;src/index.html&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 打包的文件地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">filename</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;index.html&#x27;</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic">// 文件打包完后在目标地址中的名字，通常与原文件名称相同</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><p><code>import</code> 不写后缀：</p><p><code>import ./text.js</code> node.js 中，默认可以不写 .js 文件后缀，在 webpack.consig.js 中可以配置更多的文件：</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resolve</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    extensions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">&#x27;.wasm&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;.mjs&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;.jsx&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;.json&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>指定 jsx 的入口文件：</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  entry</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> path.resolve(__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;src/index.jsx&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="44-wepack-dev-server">4.4 wepack-dev-server<a class="hash-link" href="#44-wepack-dev-server" title="标题的直接链接">​</a></h3><p>webpack-dev-server 是一个小型的node.js Express 服务器。 简单来说，webpack-dev-server就是一个小型的静态文件服务器。使用它，可以为 webpack 打包生成的资源文件提供Web服务。</p><ol><li>webpack-dev-server 有两种模式支持自动刷新——iframe模式和inline模式。<ul><li>在 iframe 模式下：页面是嵌套在一个 iframe 内，在代码发生改动的时候，这个 iframe 会重新加载；</li><li>在 inline 模式下：一个小型的 webpack-dev-server 客户端会作为入口文件打包，这个客户端会在后端代码改变的时候动态刷新页面。</li></ul></li><li>webpac-dev-server 支持 Hot Module Replacement，即模块热替换，在前端代码变动的时候无需整个刷新页面，只把变化的部分替换掉。使用 HMR 功能也有两种方式：命令行方式和 Node.js API。</li></ol><p>使用 HMR 热替换，<code>webpack.config.js</code>：</p><ol><li>引入 <code>webpack</code></li></ol><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> webpack </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;webpack&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ... 其他文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">plygins</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ... 其他文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">HotModuleReplacementPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">devServer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">hot</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ol start="2"><li>对需要热更新的文件添加配置，在 <code>index.jsx</code> 入口文件，添加：</li></ol><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> App </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./App&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 如果发现module中有hot属性，表明已经设置了热替换，则引入热替换功能</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token parameter">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;热替换出BUG了&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ol start="3"><li><code>webpack-dev-server --open</code> 启动服务，查看是否有效果。<ul><li>在 <code>scripts</code> 中，可以配置命令行提升代码效率，不需要再输入一长串的命令了，只需要 <code>npm run start</code>：</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="5-webpack-性能优化">5. webpack 性能优化<a class="hash-link" href="#5-webpack-性能优化" title="标题的直接链接">​</a></h2><ol><li><p>打包结果优化</p></li><li><p>构建过程优化</p></li><li><p>Tree-Shaking</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="51-打包体积优化">5.1 打包体积优化<a class="hash-link" href="#51-打包体积优化" title="标题的直接链接">​</a></h3><p>webpack 自带的压缩方式</p><ol><li>安装 <code>npm install webpack-bundle-analyzer</code> 可视化 webpack 分析器，打包过程中会出现分析后的页面</li><li>在 webpack.config.js 中，开头引入<code>const TerserPlugin = require(&#x27;terser-webpack-plugin&#x27;)</code></li><li>配置：</li></ol><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> TerserPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;terser-webpack-plugin&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">optimization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">minimizer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 使用缓存，加快构建速度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      parallel： </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 开启多线程，提高打包速度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">terserOptions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">compress</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">//  移除无用代码：断点、控制台输出等等</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">unsed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">drop_debugger</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">drop_console</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">dead_code</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>执行后，可以通过 <code>webpack-bundle-analyzer</code> 查看哪些文件体积大，然后针对性的优化。</p><p><img loading="lazy" alt="image-20220630213222846" src="/assets/images/image-20220630213222846-9e307ff33c2fbdee48a83471f44f9ece.png" width="1920" height="1080" class="img_E7b_"></p><p>WebPack 5 自带。</p><p>内部本身就自带 js 压缩功能，他内置了 terser-webpack-plugin 插件，我们不用再下载安装。而且在 mode=“production” 的时候会自动开启 js 压缩功能。</p><blockquote><p>如果你要在开发环境使用，就用下面：</p></blockquote><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// webpack.config.js中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token literal-property property" style="color:#36acaa">optimization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token literal-property property" style="color:#36acaa">usedExports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//只导出被使用的模块</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token literal-property property" style="color:#36acaa">minimize</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 启动压缩</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="52-打包速度优化">5.2 打包速度优化<a class="hash-link" href="#52-打包速度优化" title="标题的直接链接">​</a></h3><p>思路一，减少干活的量：从文件体积上减小。删掉体积大的，用不上的文件，不去打包，比如：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">exclude</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">node_loader</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>思路二，增加干活的人：采用多线程打包，可以根据cpu数量构建线程池，有两种常见的库：</p><ul><li><p><code>HappyPack</code></p></li><li><p><code>thread-loader</code></p></li></ul><p>思路三，提前干活：预编译一些不常变化的模块。</p><p>思路四，缓存：虽然时效性会差，但上次编译过的模块，如果没有修改，应该依然可用。</p><p>思路五，使用更好的库，比如：</p><ul><li><code>fast-sass-loader</code>，快速的处理 sass 文件，比 <code>sass-loader</code> 速度更快。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="53-tree-shaking">5.3 Tree-Shaking<a class="hash-link" href="#53-tree-shaking" title="标题的直接链接">​</a></h3><p>webpack 自带的优化方法，顾名思义，摇晃树把不好的树叶都晃下来，这里的实现原理是把文件中的无用代码全部消除。</p><ul><li>作用：例如定义了一个 util，里面很多公用的方法，但是很多方法没有用到，那么在 dev 环境打包时候，输出文件中就可以看到很多没用到的方法声明，但是在 product 生产环境打包时候，输出文件中就没有这些方法，消除掉这部分没用的代码。</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="6-webpack-相关问题">6 webpack 相关问题<a class="hash-link" href="#6-webpack-相关问题" title="标题的直接链接">​</a></h2><h4 class="anchor anchorWithStickyNavbar_mojV" id="问题webpack-各文件的作用">问题：webpack 各文件的作用？<a class="hash-link" href="#问题webpack-各文件的作用" title="标题的直接链接">​</a></h4><table><thead><tr><th>文件名</th><th></th></tr></thead><tbody><tr><td><code>node_modules</code> 文件夹</td><td>项目引入的模块都放置在这里</td></tr><tr><td><code>dist</code> 文件夹</td><td>打包成功后，文件会放置在这里</td></tr><tr><td><code>dist/index.html</code></td><td>打包后，html 入口文件</td></tr><tr><td><code>dist/main.js</code></td><td>打包后，js 文件</td></tr><tr><td></td><td></td></tr><tr><td><code>src</code> 文件夹</td><td>编写的代码文件都放置在这里</td></tr><tr><td><code>src/App.jsx</code></td><td>React 包裹在最外层的组件</td></tr><tr><td><code>src/index.jsx</code></td><td>React 接入 html 的入口文件</td></tr><tr><td><code>src/index.html</code></td><td>html 入口文件</td></tr><tr><td></td><td></td></tr><tr><td><code>package.json</code></td><td>默认的配置文件</td></tr><tr><td><code>package-lock.json</code></td><td></td></tr><tr><td><code>webpack.config.js</code></td><td>webpack 额外的配置文件，通常在这里调整 webpack 设置</td></tr><tr><td><code>.babelrc</code></td><td>调整 babel 的设置文件</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题plugin-是什么">问题：plugin 是什么<a class="hash-link" href="#问题plugin-是什么" title="标题的直接链接">​</a></h3><p>plugin 是节点纬度的操作。某一个事件节点，会触发特定的 plugin。</p><ul><li>从机制上来说，plugin 基于 <strong>事件监听</strong> 实现。<ul><li>Webpack 运行的生命周期中会广播出许多事件（钩子），Plugin 可以 <strong>监听事件</strong>，在合适的时机通过 Webpack 提供的 API 改变输出结果。</li></ul></li><li>从结果上来说，plugin 是一个 <strong>扩展器 / 拦截器</strong>。<ul><li>webpack 打包的是基于事件驱动的，plugin 通过监听 webpack 打包过程中的某些节点，从而通过 <strong>回调函数</strong> 执行各种任务。</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题loader-是什么">问题：loader 是什么<a class="hash-link" href="#问题loader-是什么" title="标题的直接链接">​</a></h3><p>loader 是文件纬度的操作。通过 loader 可以将各种格式的文件转化为浏览器可识别的格式。</p><p>它具有三个特点：文件加载器、一个函数、单一职责。</p><ul><li><p>它是 <strong>文件加载器</strong>。它能够加载资源文件，并对这些文件进行一些处理，诸如编译、压缩等。</p></li><li><p>它只是 <strong>一个函数</strong>，是一个封装的 JavaScript 模块。它接收其他代码，然后返回将其转化后的结果，并且一个文件还可以链式的经过多个 <code>loader</code> 转化（如 <code> scss-loader =&gt; css-loader =&gt; style-loader</code> ）。</p></li><li><p>一个 <code>Loader</code> 的 <strong>职责是单一的</strong>，只需要完成一种转化。如果一个源文件需要经历多步转化才能正常使用，就通过多个 <code>Loader</code> 去转化。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题区分-loader-和-plugin">问题：区分： loader 和 plugin<a class="hash-link" href="#问题区分-loader-和-plugin" title="标题的直接链接">​</a></h3><p>loader 是文件维度的操作，将 Webpack 不认识的、多种多样的格式内容转化为认识的、低版本的内容。</p><ul><li>比如使用 babel 把所有的 js 文件都进行转化，<code>babel-loader</code></li><li>CSS 相关的引入：<code>css-loader</code>、<code>sass-loader</code>、<code>sass-loader</code><ul><li><code>style-loader</code> 通过动态添加 <code>style</code> 标签的方式，引入样式到节点上。</li><li><code>postcss </code>、<code>postcss-loader</code>、<code>postcss-preset-env</code> 自动添加CSS3属性前缀</li></ul></li><li>导入图片和使用地址：<code>url-loader</code>、<code>file-loader</code></li><li>解析 <code>.vue</code> 文件：<code>vue-loader</code></li></ul><p>plugin 是节点维度的操作，比如 <code>index.html</code> 所谓入口文件，需要引入全部的 js  库等等。插件（Plugin）可以贯穿 Webpack 打包的生命周期，执行不同的任务</p><ul><li><p>使用 <code>html-webpack-plugin</code>，把打包好的 js 和 css 文件自动引入 HTML 中。</p></li><li><p>使用 <code>clean-webpack-plugin</code>，在每次打包前，清空上次打包遗留的历史文件。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题webpack-是什么">问题：Webpack 是什么？<a class="hash-link" href="#问题webpack-是什么" title="标题的直接链接">​</a></h3><p>一个现代 JavaScript 应用程序的静态模块打包器</p><ol><li>默认：只对 js 进行处理，其他类型文件	需要配置 loader 或者插件进行处理。</li><li>打包：将各个依赖文件进行梳理打包，形成一个 JS 依赖文件。</li></ol><p>从历史看来，前端正在经历蓬勃发展：</p><ul><li>更方便的实现 html，出现 jsx</li><li>更好用的实现 css，出现 sass less</li><li>更好的模块化开发，出现 AMD，commonJs，ES6</li><li>把各种新方案应用到支持较旧的浏览器中，出现 babel</li><li>因为文件格式越来越多样，转化方式越来越多，出现了对打包方式、打包速度等优化的需求。</li><li>Webpack 应运而生，是一个模块打包的解决方案，也是一个融合前端新技术的平台；</li></ul><p>只要在 Webpack 中简单配置，就可以使用 jsx、TypeScript、babel 等各种各样的功能，所以，Webpack 是：</p><ul><li>是前端发展的产物：</li><li>模块化打包方案；</li><li>工程化方案。</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="7-包管理工具">7. 包管理工具<a class="hash-link" href="#7-包管理工具" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题包管理工具的作用">问题：包管理工具的作用<a class="hash-link" href="#问题包管理工具的作用" title="标题的直接链接">​</a></h3><p>包管理工具是 JavaScript 模块化功能的延伸。</p><ul><li>工具封装。通过模块化的方式来封装自己的代码，并且封装成一个第三方工具； </li><li>该工具可以让其他开发者通过导入的方式来使用。</li></ul><p>分享第三方工具的方式：</p><ol><li>上传到 GitHub，其他程序员通过 GitHub 下载第三方工具。<ul><li>必须知道包在 GitHub 上的地址，并且从 GitHub 上手动下载。</li><li>不需要使用的时候，需要手动来删除相关的依赖。</li><li>当遇到版本升级或者切换时，需要重复上面的操作。下载最新版本 / 历史版本繁琐。</li></ul></li><li>使用专业的工具来管理我们的代码<ul><li>通过工具将代码发布到特定的位置（如 npm）</li><li>直接通过工具来安装、升级、删除自己项目中的工具代码。</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题npm-的配置文件">问题：npm 的配置文件<a class="hash-link" href="#问题npm-的配置文件" title="标题的直接链接">​</a></h3><p>每个项目都会有一个对应的配置文件，无论是前端项目（Vue、React）还是后端项目 （Node）。</p><p>配置文件 <code>package.json</code>，记录：</p><ul><li>项目的名称、版本号、项目描述等</li><li>项目所依赖的其他库的信息、依赖库的版本号。</li></ul><p>常见属性：</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 必填name、version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name                </span><span class="token comment" style="color:#999988;font-style:italic">// 项目名称 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version         </span><span class="token comment" style="color:#999988;font-style:italic">// 当前项目版本号</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description </span><span class="token comment" style="color:#999988;font-style:italic">// 描述信息，多数是项目的基本描述</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">author          </span><span class="token comment" style="color:#999988;font-style:italic">// 作者相关信息（发布时用到）； </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">license         </span><span class="token comment" style="color:#999988;font-style:italic">// 开源协议（发布时用到）；</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//rivate 属性：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private         </span><span class="token comment" style="color:#999988;font-style:italic">// 项目是否是私有：true时，npm不能发布，防止私有项目或模块不小心发布出去。</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong><code>main</code> 属性</strong></p><p>设置程序引入时的入口</p><ul><li>我们使用 axios 模块的 <code>const axios = require(&#x27;axios&#x27;);</code> </li><li>实际上是找到 <code>axios</code> 中 <code>main</code> 属性查找文件，然后引入的。如果没有 main 属性，npm 会默认导入包的 <code>index.js</code>。</li></ul><p><img loading="lazy" alt="截屏2022-08-16 16.49.07" src="/assets/images/截屏2022-08-16 16.49.07-6cc1e46aa651fd777c9a0d14d38c4293.png" width="1578" height="606" class="img_E7b_"></p><p><strong>scripts 属性</strong></p><p>用于配置一些脚本命令，以键值对的形式存在。方便把常用命令行，缩减为统一的几个单词。</p><ul><li>配置后可以通过 npm run 命令的 key 来执行这个命令</li><li>如：<code>npm start</code> 和 <code>npm run start</code></li><li>对于常用的 start、 test、stop、restart 可以省略掉 <code>run</code> 直接通过 <code>npm xxx</code> 方式运行。</li></ul><p><strong>dependencies 属性</strong></p><p>指定 <strong>开发环境</strong>、<strong>生产环境</strong> 都需要依赖的包。 </p><ul><li>项目实际开发用到的库模块 vue、vuex、vue-router、react、react-dom、axios等</li></ul><p><strong>devDependencies 属性</strong></p><p>仅在 <strong>开发环境</strong> 使用的依赖包。</p><ul><li>一些包在生成环境是不需要的，比如webpack、babel 等；</li><li>通过 <code>npm install webpack --save-dev</code>，将它安装到 devDependencies 属性中。</li></ul><p><strong>peerDependencies 属性</strong></p><p>一种项目依赖关系是 <strong>对等依赖</strong>，也就是你依赖的一个包，它必须是以另外一个宿主包为前提的。</p><ul><li>比如 element-plus 是依赖于 vue3 的，ant design 是依赖于 react、react-dom。</li></ul><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;peerDependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;react&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&gt;=16.9.8&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;react-dom&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&gt;=16.9.0&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题版本依赖规范">问题：版本依赖规范<a class="hash-link" href="#问题版本依赖规范" title="标题的直接链接">​</a></h3><p>npm 的包通常需要遵从 semver 版本规范： </p><ul><li>semver：<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener noreferrer">https://semver.org/lang/zh-CN/</a> </li><li>npm semver：<a href="https://docs.npmjs.com/misc/semver" target="_blank" rel="noopener noreferrer">https://docs.npmjs.com/misc/semver</a></li></ul><p>semver 版本规范是 <code>X.Y.Z</code>： </p><ul><li>X 主版本号（major）：新版本可能存在不兼容的 API 修改。</li><li>Y 次版本号（minor）：新版本新功能增加，但是兼容之前的版本。</li><li>Z 修订号（patch）：新版本没有新功能，修复了之前版本的 bug。</li></ul><p>语义化版本：</p><p>在 <code>dependencies</code> 和 <code>devDependencies</code>  中的依赖，可以使用语义化版本号。重新安装依赖 <code>npm install</code> 后，会实现自动更新小版本或中版本，在不该动大版本的情况下，不需要用户手动修改版本号，就可以尽可能的使最新的版本。<strong>通常 <code>package.json</code> 中的版本会添加一个 <code>^</code>。</strong></p><ul><li><code>^version</code>：会自动更新中版本和小版本；<ul><li><code>^1.0.1</code>  ==&gt; <code>1.x.x</code></li></ul></li><li><code>~version</code>：会自动更新小版本；<ul><li><code>~1.0.1</code> ===&gt; <code>1.0.x</code></li></ul></li><li><code>version</code>：不更新，只安装规定的版本。</li></ul><p>注意： <code>package-lock.json</code> 会锁定版本，<strong>优先级比 <code>package.json</code> 更高</strong>。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题执行-npm-install-xxx--">问题：执行 <code>npm install xxx -???</code><a class="hash-link" href="#问题执行-npm-install-xxx--" title="标题的直接链接">​</a></h3><table><thead><tr><th>npm install xxx +</th><th>[不写]<!-- -->   /  -s  /  --save</th><th>-d  /  --save-dev</th><th>-g  /  --global</th></tr></thead><tbody><tr><td>安装方式</td><td>项目默认安装</td><td>项目默认安装</td><td>操作系统全局安装</td></tr><tr><td>安装位置</td><td>node_modules 文件夹下</td><td>node_modules 文件夹下</td><td>AppDataAppData\Roaming\npm</td></tr><tr><td>模块引入</td><td>dependencies 字段下</td><td>devDependencies 字段下</td><td>dependencies 字段下</td></tr><tr><td>使用</td><td><code>./node_modules/.bin/webpack</code></td><td><code>./node_modules/.bin/webpack</code></td><td><code>webpack</code> 直接启动</td></tr></tbody></table><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 安装全局依赖</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> axios --global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> axios -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 安装开发和生产依赖 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> axios </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i axios</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 开发依赖 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> webpack --save-dev </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> webpack -D </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i webpack –D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 根据package.json中的依赖包 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题npm-install-原理">问题：<code>npm install</code> 原理<a class="hash-link" href="#问题npm-install-原理" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="截屏2022-08-16 17.13.49" src="/assets/images/截屏2022-08-16 17.13.49-1bd88e8534b3c354335cfa219a8eee64.png" width="2748" height="734" class="img_E7b_"></p><p><strong><code>package-lock.json</code> 的作用</strong> </p><p>如果项目没有 <code>package-lock.json</code>，安装是参考 <code>package.json</code>。</p><ul><li>以 <code>&quot;axios&quot;: &quot;^1.23&quot;</code> 为例，在不同的程序员电脑，去下载相同的项目时，由于电脑本地缓存的 axios 版本不一致</li><li>这导致不同环境加载项目的 axios 版本依赖不同，这有可能导致项目运行时的表现不一致。</li></ul><p><strong>流程：没有 <code>package-lock.json</code></strong></p><p>以 <code>install axios</code> 为例。</p><ul><li><strong>构建依赖关系</strong>：查找 axios 会依赖哪些包，并且多个包之间会产生相同依赖的情况；</li><li><strong>registry 下载</strong>：从 registry 仓库中下载压缩包（如果设置镜像，会从镜像服务器下载）</li><li><strong>压缩包缓存</strong>：npm5 开始，会对下载的压缩包进行主机本地缓存，减少重复下载。</li><li><strong>安装</strong>：将压缩包解压到项目的 node_modules 文件夹中。require 导入时会从 node_modules 中查找。</li></ul><p><strong>流程：有 <code>package-lock.json</code></strong></p><ul><li><strong>一致性检查</strong>：检测 lock 中包版本是否和 package.json 中一致（会按照semver版本规范）<ul><li>不一致，重新构建依赖关系，放弃 lock，走顶层的流程； </li><li>一致，<strong>本地查找缓存</strong>：<ul><li>没有找到，从 registry 仓库下载，直接走顶层流程；</li><li>查找到，获取缓存中的压缩文件，并且将压缩文件解压到node_modules文件夹中；</li></ul></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="问题其他包管理工具">问题：其他包管理工具<a class="hash-link" href="#问题其他包管理工具" title="标题的直接链接">​</a></h3><p><strong>yarn</strong></p><p>由 Facebook、Google、Exponent 和 Tilde 联合推出了一个新的 JS 包管理工具</p><ul><li>yarn 是为了弥补 npm 的一些缺陷而出现的；</li><li>早期的 npm 存在很多的缺陷，比如安装依赖速度很慢、版本依赖混乱、没有版本缓存等一系列问题。</li></ul><p><strong>cnpm</strong></p><p>npm 的备胎。由于网络，从 <a href="https://registry.npmjs.org%E4%B8%8B%E8%BD%BD%E5%8C%85%E5%8D%A1%E9%A1%BF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%8A%8A%E9%95%9C%E5%83%8F%E4%BB%A3%E7%90%86%E7%BB%91%E5%AE%9A%E5%88%B0" target="_blank" rel="noopener noreferrer">https://registry.npmjs.org下载包卡顿，可以把镜像代理绑定到</a> cnpm 上。</p><p>解决方式：</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看当前的 npm 镜像：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> config get registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设置 npm 淘宝镜像：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> config </span><span class="token builtin class-name">set</span><span class="token plain"> registry https://registry.npm.taobao.org</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>如果不希望把 npm 镜像全局修改，防止淘宝镜像不稳定。</p><ul><li>可以使用 cnpm，并且将 cnpm 设置为淘宝的镜像：</li></ul><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -g cnpm --registry</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https://registry.npm.taobao.org cnpm config get registry </span><span class="token comment" style="color:#999988;font-style:italic"># https://r.npm.taobao.org/</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>npx</strong></p><p>npx 是 npm5.2 之后自带的一个命令。</p><ul><li>npx 的作用非常多，但是比较常见的是使用它来调用项目中的某个模块的指令。</li><li>如果使用 <code>npx</code>，代替 <code>npm</code> 输入命令，它会到当前目录的 <code>node_modules/.bin</code> 目录下查找对应的命令； </li></ul><p>以 webpack 为例：全局安装的是 webpack5.1.3；项目安装的是 webpack3.6.0。</p><ul><li>如果在终端执行 <code>webpack --version</code>，会通过环境变量里找，找到的是全局的 webpack 5.1.3。</li></ul><p>解决方式：</p><ul><li>方式一：在终端中使用如下命令（在项目根目录下）:<code>./node_modules/.bin/webpack --version</code></li><li>方式二：修改 package.json 中的 scripts：<code>webpack&quot;: &quot;webpack --version&quot;</code></li><li>方式三：使用npx：<code>npx webpack --version</code></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/webpack">webpack</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/frontEnd/other/Ajax&amp;Axios"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Ajax、Axios</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/frontEnd/other/Typescript"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Typescript</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-webpack-定义" class="table-of-contents__link toc-highlight">1. Webpack 定义</a><ul><li><a href="#12-webpack-产生的背景" class="table-of-contents__link toc-highlight">1.2 webpack 产生的背景</a></li><li><a href="#13-前端模块化" class="table-of-contents__link toc-highlight">1.3 前端模块化</a><ul><li><a href="#模块化的优点" class="table-of-contents__link toc-highlight">模块化的优点</a></li></ul></li><li><a href="#14-模块化方案进化史" class="table-of-contents__link toc-highlight">1.4 模块化方案进化史</a><ul><li><a href="#141-amd" class="table-of-contents__link toc-highlight">1.4.1 AMD</a></li><li><a href="#142-commonjs" class="table-of-contents__link toc-highlight">1.4.2 COMMONJS</a></li><li><a href="#143-es6-module" class="table-of-contents__link toc-highlight">1.4.3 ES6 MODULE</a></li></ul></li><li><a href="#15-webpack-的打包机制" class="table-of-contents__link toc-highlight">1.5 Webpack 的打包机制</a><ul><li><a href="#151-输出文件" class="table-of-contents__link toc-highlight">1.5.1 输出文件</a></li><li><a href="#152-webpack打包过程" class="table-of-contents__link toc-highlight">1.5.2 Webpack打包过程</a></li></ul></li></ul></li><li><a href="#2-配置开发环境----npm包管理器" class="table-of-contents__link toc-highlight">2. 配置开发环境 -- npm、包管理器</a></li><li><a href="#3-webpack-核心特性" class="table-of-contents__link toc-highlight">3. Webpack 核心特性</a><ul><li><a href="#31-安装和入口" class="table-of-contents__link toc-highlight">3.1 安装和入口</a></li><li><a href="#32-loader---文件加载器" class="table-of-contents__link toc-highlight">3.2 loader - 文件加载器</a></li><li><a href="#33-plugins---插件" class="table-of-contents__link toc-highlight">3.3 plugins - 插件</a></li></ul></li><li><a href="#4-webpack-构建工程" class="table-of-contents__link toc-highlight">4. webpack 构建工程</a><ul><li><a href="#41-构建" class="table-of-contents__link toc-highlight">4.1 构建</a></li><li><a href="#42-babel" class="table-of-contents__link toc-highlight">4.2 babel</a></li><li><a href="#43-html-webpack-plugin" class="table-of-contents__link toc-highlight">4.3 html-webpack-plugin</a></li><li><a href="#44-wepack-dev-server" class="table-of-contents__link toc-highlight">4.4 wepack-dev-server</a></li></ul></li><li><a href="#5-webpack-性能优化" class="table-of-contents__link toc-highlight">5. webpack 性能优化</a><ul><li><a href="#51-打包体积优化" class="table-of-contents__link toc-highlight">5.1 打包体积优化</a></li><li><a href="#52-打包速度优化" class="table-of-contents__link toc-highlight">5.2 打包速度优化</a></li><li><a href="#53-tree-shaking" class="table-of-contents__link toc-highlight">5.3 Tree-Shaking</a></li></ul></li><li><a href="#6-webpack-相关问题" class="table-of-contents__link toc-highlight">6 webpack 相关问题</a><ul><li><a href="#问题webpack-各文件的作用" class="table-of-contents__link toc-highlight">问题：webpack 各文件的作用？</a></li><li><a href="#问题plugin-是什么" class="table-of-contents__link toc-highlight">问题：plugin 是什么</a></li><li><a href="#问题loader-是什么" class="table-of-contents__link toc-highlight">问题：loader 是什么</a></li><li><a href="#问题区分-loader-和-plugin" class="table-of-contents__link toc-highlight">问题：区分： loader 和 plugin</a></li><li><a href="#问题webpack-是什么" class="table-of-contents__link toc-highlight">问题：Webpack 是什么？</a></li></ul></li><li><a href="#7-包管理工具" class="table-of-contents__link toc-highlight">7. 包管理工具</a><ul><li><a href="#问题包管理工具的作用" class="table-of-contents__link toc-highlight">问题：包管理工具的作用</a></li><li><a href="#问题npm-的配置文件" class="table-of-contents__link toc-highlight">问题：npm 的配置文件</a></li><li><a href="#问题版本依赖规范" class="table-of-contents__link toc-highlight">问题：版本依赖规范</a></li><li><a href="#问题执行-npm-install-xxx--" class="table-of-contents__link toc-highlight">问题：执行 <code>npm install xxx -???</code></a></li><li><a href="#问题npm-install-原理" class="table-of-contents__link toc-highlight">问题：<code>npm install</code> 原理</a></li><li><a href="#问题其他包管理工具" class="table-of-contents__link toc-highlight">问题：其他包管理工具</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">分享</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/frontEnd/JavaScript">前端</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/code/algorithm">算法笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/project">我的项目</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/moxyNJ" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/user/2005151873514024" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a href="https://www.ninjee.co" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ninjee 的前端篮子</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p>Copyright © 2022 Ninjee Built with Docusaurus.</p><p><a href="http://beian.miit.gov.cn/">晋ICP备2021017941号-2</a></p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.05dd1c40.js"></script>
<script src="/assets/js/main.ab88f873.js"></script>
</body>
</html>