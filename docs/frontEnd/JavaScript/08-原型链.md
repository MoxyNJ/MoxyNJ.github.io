---
title: 8. åŸå‹é“¾
sidebar_position: 8
date: 2022-07-25
tags: [JavaScript]
---

## 1 ç±»ã€æ„é€ å‡½æ•°ã€prototype åŸå‹å¯¹è±¡å’Œå®ä¾‹å¯¹è±¡

é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€

-   å°è£…ï¼šå°†ç»“æ„ç›¸ä¼¼çš„å±æ€§å’Œæ–¹æ³•éƒ½å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºå°è£…ï¼›
-   ç»§æ‰¿ï¼šé€šè¿‡åŸå‹é“¾å®ç°å­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°é‡å¤ä»£ç é‡çš„å‡å°‘ï¼›
-   å¤šæ€ï¼šä¸åŒçš„å¯¹è±¡åœ¨æ‰§è¡Œæ—¶è¡¨ç°å‡ºä¸åŒçš„å½¢æ€ã€‚

å…ˆçœ‹ä¸€æ®µä»£ç ï¼š

```js
function Person(name) {
    this.name = name;
}
Person.prototype.printName = function () {
    console.log(this.name);
};

let instance1 = new Person("Moxy");
let instance1 = new Person("Ninjee");
```

### 1.1 åè¯

ç±»ã€æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡å’Œå®ä¾‹å¯¹è±¡ã€‚

1. ç±»ï¼šä¸æ„é€ å‡½æ•°åŒåï¼Œä»£ç ä¸­ç±»åå³ä¸º Personã€‚
2. æ„é€ å‡½æ•°ï¼šåœ¨ä»£ç ä¸­ Person å‡½æ•°é€šå¸¸è¢«ç§°ä¹‹ä¸ºæ„é€ å‡½æ•°ã€‚å‡½æ•°æœ¬èº«ä¸æ˜¯æ„é€ å‡½æ•°ï¼Œåªæœ‰åœ¨ä¸€ä¸ªæ™®é€šå‡½æ•°è°ƒç”¨å‰ï¼ŒåŠ ä¸Š new å…³é”®å­—åï¼Œå°±ä¼šæŠŠè¿™ä¸ªå‡½æ•°è°ƒç”¨å˜æˆä¸€ä¸ª â€œæ„é€ å‡½æ•°è°ƒç”¨â€ã€‚
3. åŸå‹å¯¹è±¡ï¼šæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æ‹¥æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ã€‚ `æ„é€ å‡½æ•°.prototype` æŒ‡å‘äº†åŸå‹å¯¹è±¡ã€‚åœ¨ä»£ç ä¸­ï¼Œå³ä¸º `Person.pototype`ã€‚
4. å®ä¾‹å¯¹è±¡ï¼šé€šè¿‡è°ƒç”¨ new + æ„é€ å‡½æ•°è€Œåˆ›å»ºçš„å®ä¾‹åŒ–å¯¹è±¡ï¼Œå°±æ˜¯å®ä¾‹å¯¹è±¡ã€‚ä»£ç ä¸­ instance1 å’Œ instance2 å°±æ˜¯å®ä¾‹å¯¹è±¡ã€‚

### 1.2 å…³ç³»

ä»‹ç»ä¸Šè¿°å››ä¸ªåè¯ä¹‹é—´çš„å…³ç³»ï¼Œå³å®ƒä»¬æ˜¯å¦‚ä½•è”ç³»åœ¨ä¸€èµ·çš„ã€‚

#### æŒ‡å‘åŸå‹å¯¹è±¡

åœ¨ä»£ç ä¸­ï¼ŒåŸå‹å¯¹è±¡æ˜¯åŒ¿åçš„ï¼Œæ²¡æœ‰ä¸€ä¸ªå¯ä»¥ç›´è§‚çœ‹åˆ°çš„ç§°å‘¼ã€‚æ‰€ä»¥é€šå¸¸æ¥è®²ï¼ŒåŸå‹å¯¹è±¡çš„è¡¨è¿°å½¢å¼æ˜¯é€šè¿‡æ„é€ å‡½æ•°åï¼š`Person.prototype`ã€‚åŸå‹å¯¹è±¡çš„è¿™ä¸ªè¡¨è¿°æ–¹å¼ä¹Ÿé˜è¿°äº†æ„é€ å‡½æ•°å’ŒåŸå‹å¯¹è±¡çš„å…³ç³»ï¼š

1. `Person.prototype` ï¼Œå³æ„é€ å‡½æ•°çš„ `.prototype` å±æ€§ï¼ŒæŒ‡å‘äº†åŸå‹å¯¹è±¡ã€‚
2. `instance1.__proto__` ï¼Œå³å®ä¾‹å¯¹è±¡çš„ `.__proto__` å±æ€§ï¼ŒæŒ‡å‘äº†åŸå‹å¯¹è±¡ã€‚

#### æŒ‡å‘æ„é€ å‡½æ•°

è¢«åˆ›å»ºçš„åŸå‹å¯¹è±¡ï¼Œé»˜è®¤ä¼šæ‹¥æœ‰ä¸€ä¸ªå…¬æœ‰ã€ä¸”ä¸å¯æšä¸¾çš„å±æ€§ `.constructor` æŒ‡å‘æ„é€ å‡½æ•°ã€‚

1. `Person.prototype.constructor`ï¼Œå³åŸå‹å¯¹è±¡çš„ `.constructor` å±æ€§æŒ‡å‘äº†æ„é€ å‡½æ•°ã€‚
2. `instance1.constroctor`ï¼Œå³å®ä¾‹å¯¹è±¡çš„ `.constroctor` å±æ€§æŒ‡å‘äº†æ„é€ å‡½æ•°ã€‚
    - æ³¨ï¼šäº‹å®ä¸Šï¼Œå®ä¾‹å¯¹è±¡æ˜¯æ²¡æœ‰ `.constroctor` å±æ€§ã€‚å¯ä»¥é€šè¿‡ `.constroctor` è®¿é—®åˆ°æ„é€ å‡½æ•°ï¼Œæ˜¯å› ä¸ºé€šè¿‡åŸå‹é“¾è®¿é—®åˆ°äº†åŸå‹å¯¹è±¡çš„ `.constroctor` å±æ€§ï¼Œå³çœŸæ­£çš„è®¿é—®é“¾æ˜¯ï¼š`instance1.__proto__.constroctor`ã€‚å…³äºåŸå‹é“¾åæ–‡ä¼šè¿›ä¸€æ­¥è®²è¿°ã€‚

## 2 åŸå‹é“¾

å¯¹è±¡çš„åŸå‹ï¼š `[[prototype]]` ã€‚

JavaScript ä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å†…ç½®å±æ€§ï¼ŒæŒ‡å‘äº†æŸä¸ªå¯¹è±¡æˆ–å‡½æ•°ã€‚

-   `[[prototype]]` å±æ€§ï¼ŒæŒ‡å‘äº†å®ƒçš„åŸå‹å¯¹è±¡ã€‚
-   `.constructor` å±æ€§ï¼ŒæŒ‡å‘äº†å®ƒçš„æ„é€ å‡½æ•°ï¼ˆenumberable é»˜è®¤ä¸º falseï¼‰ã€‚

**å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡** åœ¨åˆ›å»ºæ—¶ï¼Œå…¶è‡ªèº«çš„ `[[prototype]]` å±æ€§éƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªå€¼ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚

-   ç”±äº `[[prototype]]` æ˜¯å†…ç½®å±æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½æ˜¾å¼çš„æ„ŸçŸ¥åˆ°å®ƒï¼Œå› æ­¤æµè§ˆå™¨å®šä¹‰äº†ä¸€ä¸ªéæ ‡å‡†çš„ `.__proto__` å±æ€§ï¼Œè¯¥å±æ€§å°±ä»£è¡¨äº† `[[prototype]]` ã€‚äº‹å®ä¸Šï¼Œ `.__proto__` å¹¶ä¸æ˜¯ä¸€ä¸ªå±æ€§ï¼Œè€Œæ˜¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥ç†è§£ä¸º `__proto__()`ï¼Œè¿™ä¸ªè¿‡ç¨‹æ›´åƒæ˜¯ä¸€æ¬¡ `[[Get]]`ï¼Œåœ¨åæ–‡ â€æ£€æŸ¥ç±»çš„å…³ç³»â€œä¸­ï¼Œä¼šè¿›ä¸€æ­¥è§£é‡Šã€‚
-   ä¸Šæ–‡è¯´åˆ°çš„ â€œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡â€ï¼Œå”¯ä¸€ä¾‹å¤–çš„æ˜¯ `Object.create(null)` æ–¹æ³•ï¼Œä¸‹æ–‡ä¼šè§£é‡Šã€‚
-   ES5 æ¨å‡ºäº†è·å–åŸå‹é“¾çš„ APIï¼š`Object.getPrototypeOf(obj1)`ã€‚

A å¯¹è±¡çš„ `[[prototype]]` å†…ç½®å±æ€§æŒ‡å‘äº† B å¯¹è±¡ï¼ŒB å¯¹è±¡çš„ `[[prototype]]` å†…ç½®å±æ€§æŒ‡å‘äº† C å¯¹è±¡ ... ï¼Œæœ€ç»ˆä¼šæŒ‡å‘ `Object.prototype`ã€‚è¿™æ ·ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªç»„æˆçš„å¸¸å¸¸é“¾æ¡ï¼Œå°±æ˜¯äººä»¬æ‰€è¯´çš„ **åŸå‹é“¾**ã€‚

ä»æ•°æ®ç»“æ„çš„è§’åº¦åˆ†æï¼ŒåŸå‹é“¾å…¶å®å°±æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ã€‚

### 2.1 ç±»çš„åŸå‹é“¾

é€šè¿‡å››å¼ å›¾ç‰‡ï¼Œæè¿°åŸå‹é“¾çš„å…·ä½“è¿‡ç¨‹ã€‚

é¦–å…ˆè§£é‡Šä¸€ä¸‹å›¾ç‰‡ä¸­æ¶‰åŠåˆ°çš„æ¨¡å‹ï¼š

1. ä¸€å…±æœ‰ 3 ä¸ªç±»ï¼ŒJavaScript å†…ç½® `Object`ã€çˆ¶ç±» `Father`ã€å­ç±» `Son`ï¼Œä¸‰è€…ä¹‹é—´å­˜åœ¨ç»§æ‰¿å…³ç³»ã€‚
2. ç±»çš„åŸå‹å¯¹è±¡æ²¡æœ‰ç”¨ `Object.prototype` çš„è¡¨è¿°å½¢å¼ï¼Œè€Œæ˜¯ç”¨äº† "Object çš„åŸå‹å¯¹è±¡" ã€‚
3. æ¯ä¸ªæ„é€ å‡½æ•°åˆ—ä¸¾äº† 3 ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå‘½åæ–¹å¼ä¸º æ„é€ å‡½æ•°å + æ•°å­—ï¼Œå¦‚ï¼š`object1`

![åŸå‹é“¾1](images/08-%E5%8E%9F%E5%9E%8B%E9%93%BE.assets/%E5%8E%9F%E5%9E%8B%E9%93%BE1.png)

ä¸Šå›¾è§£é‡Šäº†å®ä¾‹å¯¹è±¡æ˜¯å¦‚ä½•é€šè¿‡ `.__proto__` ä¸€æ­¥æ­¥éå†è‡ªå·±çš„åŸå‹é“¾çš„ï¼Œå›¾ç‰‡çš„ä¸»è§’æ˜¯ `.__proto__` å±æ€§ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„å®ä¾‹å¯¹è±¡éƒ½é€šè¿‡ `.__proto__` å±æ€§ï¼ŒæŒ‡å‘äº†è‡ªå·±çš„åŸå‹å¯¹è±¡ã€‚ç„¶åå„ä¸ªåŸå‹å¯¹è±¡å› ä¸ºç»§æ‰¿å…³ç³»ï¼Œé€šè¿‡ `.__proto__` å±æ€§æŒ‡å‘äº†å¦ä¸€ä¸ªåŸå‹å¯¹è±¡ã€‚è¿™æ ·ä¸€ä¸ªä¸ªä¸²è”èµ·æ¥ï¼Œå½¢æˆäº†å®Œæ•´çš„åŸå‹é“¾ã€‚æœ€ç»ˆï¼Œæ‰€æœ‰åŸå‹å¯¹è±¡éƒ½ä¼šæŒ‡å‘ Object çš„åŸå‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯`Object.prototype`ã€‚è€Œä¸ºäº†è¡¨è¾¾`Object.prototype` æ˜¯æ‰€æœ‰åŸå‹é“¾çš„æ ¹ï¼Œå®ƒçš„ `.__proto__` å±æ€§æŒ‡å‘äº† `null`ã€‚

-   å¹¶ä¸æ˜¯æ‰€æœ‰å¯¹è±¡ï¼Œæœ€ç»ˆéƒ½ä¼šæŒ‡å‘ `Object.prototype`ã€‚é€šè¿‡ `Object.create(null)` åˆ›å»ºçš„å¯¹è±¡ï¼Œæ˜¯ä¸ä¼šç»§æ‰¿ Object çš„ï¼Œè€Œæ˜¯å…¶åŸå‹å¯¹è±¡çš„ `.__proto__` ä¼šæ˜¾ç¤º `undefined`ã€‚

    ```js
    function Father(name) {
        this.name = name;
        this.colors = ["red", "blue", "green"];
    }
    Father.prototype.__proto__ === Object.prototype; // trueï¼ŒåŸå‹å¯¹è±¡é»˜è®¤æŒ‡å‘äº† Object.prototype

    // é€šè¿‡Object.create(null)ï¼Œæ–­å¼€åŸå‹é“¾æŒ‡å‘
    Father.prototype = Object.create(null);
    Father.prototype.__proto__ === Object.prototype; // falseï¼ŒåŸå‹å¯¹è±¡çš„åŸå‹é“¾è¢«æ”¹å˜äº†ã€‚
    Father.prototype.__proto__; // undefinedï¼Œäº‹å®ä¸Šï¼ŒåŸå‹å¯¹è±¡çš„åŸå‹é“¾ .__proto__ æ˜¯è¢«åˆ é™¤äº†ã€‚
    ```

> `Object.create()`
>
> å®ƒä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶æŠŠè¿™ä¸ªå¯¹è±¡çš„ `[[prototype]]` åŸå‹é“¾å…³è”åˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚

äº‹å®ä¸Šï¼Œé€šè¿‡åŸå‹é“¾æ¥å®ç°ç»§æ‰¿å…³ç³»ï¼Œæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ª â€œç”µæ¢¯â€ï¼š

åŸå‹é“¾éƒ½é€šè¿‡ `__proto__` å±æ€§æ¥å®ç°ä¸²è”ã€‚ä¹Ÿå°±æ˜¯å†…ç½®å±æ€§ `[[prototype]]`ã€‚

ç»§æ‰¿å…³ç³»çš„åŸå‹å¯¹è±¡ï¼Œå°±æ˜¯æ¯ä¸€å±‚çš„ç”µæ¢¯ï¼šSon çš„åŸå‹å¯¹è±¡åœ¨ 1 å±‚ï¼ŒFather çš„åŸå‹å¯¹è±¡åœ¨ 2 å±‚ã€‚è€Œ Object çš„åŸå‹å¯¹è±¡æ€»æ˜¯åœ¨é¡¶å±‚ï¼Œå› ä¸ºå®ƒä»£è¡¨çš„åŸå‹é“¾çš„æ ¹èŠ‚ç‚¹ã€‚å…¶ `.__proto__` æ°¸è¿œæŒ‡å‘ `null`ã€‚

ç±»åï¼Œæˆ–è€…è¯´æ„é€ å‡½æ•°ï¼Œå°±æ˜¯æ¯å±‚æ¥¼çš„åç§°ï¼›å®ä¾‹å¯¹è±¡åˆ™æ˜¯æ¯å±‚æ¥¼çš„ä¸åŒæˆ¿é—´ã€‚è¿™æ ·å°±å½¢æˆäº†å¦‚ä¸‹æ¨¡å‹ï¼Œä¸€ä¸ªæ¸å˜çº¢è‰²çš„ç®­å¤´ä»£è¡¨äº†æœ€åº•å±‚å®ä¾‹å¯¹è±¡æ˜¯å¦‚ä½•é€šè¿‡ `[[prototype]]` åŸå‹é“¾ä¸€æ­¥æ­¥å‘ä¸Šéå†çš„ã€‚

![image-20220725220105616](images/08-%E5%8E%9F%E5%9E%8B%E9%93%BE.assets/image-20220725220105616.png)

ä¸‹å›¾è§£é‡Šäº†ï¼š

1. æ„é€ å‡½æ•°é€šè¿‡ new æ“ä½œç¬¦åˆ›å»ºäº†å®ä¾‹å¯¹è±¡ã€‚
2. æ„é€ å‡½æ•°çš„ `.prototype` å±æ€§å€¼æŒ‡å‘äº† `Object.prototype` å³æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚

![image-20220725220116007](images/08-%E5%8E%9F%E5%9E%8B%E9%93%BE.assets/image-20220725220116007.png)

## 3 new è¿ç®—ç¬¦

new ä¸€ä¸ªæ–°å¯¹è±¡çš„è¿‡ç¨‹ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

```js
let person1 = new Person("Moxy", 15);
```

è¦åˆ›å»º Person çš„æ–°å®ä¾‹ï¼Œå¿…é¡»ä½¿ç”¨ new æ“ä½œç¬¦ã€‚ä»¥è¿™ç§æ–¹å¼è°ƒç”¨æ„é€ å‡½æ•°å®é™…ä¸Šä¼šç»å†ä»¥ä¸‹ 5 ä¸ªæ­¥éª¤ï¼š

1. åˆ›å»ºä¸€ä¸ª **æ–°å¯¹è±¡** `{}`ï¼›
2. ä¸ºæ–°å¯¹è±¡ç»‘å®š **åŸå‹é“¾**ï¼š`{}.__proto__ = Person.prototype`ï¼›
3. å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸ **`this`** èµ‹ç»™æ–°å¯¹è±¡ `{}`ï¼›
4. æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼Œä¸º `{}` æ·»åŠ å±æ€§ï¼š`Person.call(this)`ï¼›
5. è¿”å›å¯¹è±¡ï¼š
    - å¦‚æœæ„é€ å‡½æ•°æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°±è¿”å› **æ„é€ å‡½æ•°ä¸­çš„å¯¹è±¡**ã€‚
    - å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œå°±ä¼šè¿”å› **æ–°å¯¹è±¡**ã€‚

æœ€ç»ˆï¼Œä»£ç ä¸­å·¦ä¾§çš„ `person1` å˜é‡æ¥æ”¶åˆ°äº†æ–°åˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡ã€‚

## 4 å±æ€§çš„è®¾ç½®å’Œå±è”½

> ä¸ºä»€ä¹ˆè¦ç»™å¯¹è±¡å®šä¹‰ä¸€ä¸ªåŸå‹ï¼ŒåŸå‹é“¾çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ
>
> ç»™å¯¹è±¡æ›´æ”¹æŸä¸ªå±æ€§ï¼ŒJavaScript å¦‚ä½•åˆ¤æ–­è¯¥å±æ€§æ˜¯å¦æ˜¯å·²ç»å­˜åœ¨çš„è‡ªæœ‰å±æ€§ï¼Ÿæˆ–è€…æ˜¯åŸå‹é“¾ä¸Šå­˜åœ¨çš„ç»§æ‰¿å±æ€§ï¼Ÿ

`person.name = "Moxy"` ä¼šè§¦å‘ `[[Put]]` ï¼Œæ“ä½œçš„å®Œæ•´è¿‡ç¨‹æ˜¯ï¼š

é¦–å…ˆä¼šåˆ¤æ–­å¯¹è±¡ä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥å±æ€§å€¼ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šæ‰§è¡Œ 1ï¼›ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ‰§è¡Œ 2ã€‚

1. åˆ¤æ–­è‡ªæœ‰å±æ€§ã€‚å¦‚æœ person å¯¹è±¡ä¸­å­˜åœ¨ä¸€ä¸ªåŒåçš„ **æ•°æ®å±æ€§**ï¼Œåˆ™è¯¥è¯­å¥å‘ç”Ÿèµ‹å€¼è¡Œä¸ºï¼Œä¿®æ”¹å·²æœ‰çš„è¿™ä¸ªå±æ€§ã€‚
2. åˆ¤æ–­ç»§æ‰¿å±æ€§ã€‚éå† person å¯¹è±¡çš„åŸå‹é“¾ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šæ‰§è¡Œ 2.1ï¼›ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ‰§è¡Œ 2.2ã€‚
    1. **æ‰¾å¾—åˆ°**ã€‚å¦‚æœåœ¨åŸå‹é“¾ä¸Šæ‰¾å¾—åˆ°åŒåçš„ name å±æ€§ï¼Œåˆ†ä¸ºä¸‹é¢ 3 ç§æƒ…å†µï¼š
        1. **å¯å†™**ã€‚å¦‚æœæ‰¾åˆ°çš„åŒåå±æ€§æ˜¯ **æ•°æ®å±æ€§**ï¼Œä¸”å¯å†™ **`writable:true`** ã€‚åˆ™å‘ç”Ÿåˆ›å»ºè¡Œä¸ºï¼Œåœ¨ person ä¸Š **åˆ›å»ºæ–°å±æ€§** nameï¼›
        2. **ä¸å¯å†™**ã€‚å¦‚æœæ‰¾åˆ°çš„åŒåå±æ€§æ˜¯ **æ•°æ®å±æ€§**ï¼Œä½†ä¸å¯å†™ **`writable:false`**ã€‚åˆ™è¯¥è¯­å¥ä¼šè¢« **é™é»˜å¿½ç•¥**ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æŠ¥é”™ï¼š`TypeError`ï¼›
        3. **setter**ã€‚å¦‚æœæ‰¾åˆ°çš„åŒåå±æ€§æ˜¯ä¸€ä¸ªæœ‰ setter å‡½æ•° **è®¿é—®å™¨å±æ€§**ã€‚åˆ™è¯¥è¯­å¥ä¼šå‘ç”Ÿ setter å‡½æ•°çš„è°ƒç”¨ã€‚
    2. **æ‰¾ä¸åˆ°**ã€‚å¦‚æœåœ¨åŸå‹é“¾ä¸Šæ‰¾ä¸åˆ°åŒåçš„ name å±æ€§ï¼Œåˆ™è¯¥è¯­å¥å‘ç”Ÿåˆ›å»ºè¡Œä¸ºï¼Œåœ¨ person ä¸Šåˆ›å»ºæ–°è‡ªæœ‰å±æ€§ nameã€‚

æ€»ç»“ï¼š

1. æ‰€è°“å±æ€§çš„è®¾ç½®ï¼Œå°±æ˜¯ä¿®æ”¹äº†ä¸€ä¸ªå·²å­˜åœ¨çš„å±æ€§å€¼ï¼›
   æ‰€è°“å±æ€§çš„å±è”½ï¼Œå°±æ˜¯å·²çŸ¥ç›®æ ‡å¯¹è±¡çš„åŸå‹é“¾ä¸Šå­˜åœ¨ä¸€ä¸ªåŒåå±æ€§ï¼Œä¾ç„¶åœ¨ç›®æ ‡å¯¹è±¡ä¸Šæ–°å»ºä¸€ä¸ªåŒåå±æ€§ï¼Œåˆ™åŸå‹é“¾ä¸Šçš„åŒåå±æ€§è¢«å±è”½ã€‚
2. æ‰€æœ‰ â€œæ•°æ®å±æ€§â€ éƒ½é€‚ç”¨ä¸è¯¥è§„åˆ™ä¸­ï¼ŒåŒ…æ‹¬ **åŸºæœ¬æ•°æ®ç±»å‹** å’Œ **å¼•ç”¨å±æ€§ç±»å‹**ï¼ˆæ–¹æ³•ã€æ•°ç»„ã€ç­‰ç­‰å„ç§å¯¹è±¡ï¼‰ã€‚å¦‚æœçˆ¶ç±»å­˜åœ¨ä¸€ä¸ªåŒåçš„ name æ•°ç»„ï¼Œæ‰§è¡Œ `person.name = "Moxy"` ï¼Œåœ¨ person å¯¹è±¡ä¸­åˆ›å»ºçš„åŒåå±æ€§ name ï¼Œæ­¤æ—¶ä¸å†æ˜¯ä¸€ä¸ªå¼•ç”¨å±æ€§ç±»å‹æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹å­—ç¬¦ä¸²ã€‚
3. å±æ€§åœ¨çˆ¶ç±»ä¸å…è®¸å†™ï¼Œåˆ™ç»§æ‰¿çš„å­ç±»ä¹Ÿä¸å…è®¸å†™ï¼ˆè§„åˆ™ 2.1.2 â€œä¸å¯å†™â€çš„æƒ…å†µï¼‰ã€‚
   å±æ€§åœ¨çˆ¶ç±»æœ‰ setterï¼Œåˆ™å­ç±»çš„èµ‹å€¼ä¹Ÿè¦è°ƒç”¨è¿™ä¸ª setterï¼ˆè§„åˆ™ 2.1.3 â€œsetterâ€çš„æƒ…å†µï¼‰ã€‚

## 5 åŸå‹å¼ç»§æ‰¿

> æ›´å¤šç›¸å…³å†…å®¹è§ï¼š**ç»§æ‰¿** ç¯‡ç« çš„ **åŸå‹å¼ç»§æ‰¿**ã€‚

```js
// å®šä¹‰çˆ¶ç±»ï¼šå®ä¾‹å±æ€§ + å…¬æœ‰æ–¹æ³•
function Father(name) {
    this.name = name;
}
Father.prototype.printName = function () {
    console.log(this.name);
};

// å®šä¹‰å­ç±»ï¼šå®ä¾‹å±æ€§ + å…¬æœ‰æ–¹æ³•ã€‚ç°åœ¨å…±æœ‰æ–¹æ³•å¯ä»¥ç´§æ¥ç€å®ä¾‹å±æ€§å»å®šä¹‰äº†
function Son(name, age) {
    Father.call(this, name);
    this.age = age;
}
Son.prototype.printAge = function () {
    console.log(this.age);
};
// æ–¹æ³•ä¸‰ï¼šåŸå‹å¼ç»§æ‰¿ã€‚ä½¿ç”¨ES6æ–¹æ³•ï¼Œ
Object.setPrototypeOf(Son.prototype, Father.prototype);

// å®ä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 99); // SonÂ {name: "Moxy", age: 99}
let instance2 = new Son("Ninjee", 5); // SonÂ {name: "Ninjee", age: 5}
instance1.printName === instance2.printName; // true
Son.prototype.__proto__ === Father.prototype; // true
```

## 6 ç±»çš„å…³ç³»åˆ¤æ–­

> æ›´å¤šå…³äºç±»å‹åˆ¤æ–­çš„çŸ¥è¯†ï¼šè§ **ç±»å‹** ç¯‡ç« çš„ **ç±»å‹åˆ¤æ–­** ç« èŠ‚ã€‚
>
> æ›´å¤šå…³äºå¯¹è±¡å±æ€§çš„åˆ¤æ–­ï¼šè§ **åŸå‹é“¾** ç¯‡ç« çš„ **åˆ¤æ–­å¯¹è±¡çš„å±æ€§** ç« èŠ‚ã€‚

å…³è”ï¼šç±»å‹åˆ¤æ–­ã€ç»§æ‰¿åˆ¤æ–­ã€ç»§æ‰¿å…³ç³»åˆ¤æ–­ã€åŸå‹é“¾åˆ¤æ–­

ç±»å‹åˆ¤æ–­çš„æ–¹æ³•ï¼š

-   `typeof` æ“ä½œç¬¦ã€‚å¯ä»¥åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹å€¼ã€‚
-   `instenceof` æ“ä½œç¬¦ã€‚å¯ä»¥åˆ¤æ–­å¼•ç”¨ç±»å‹å€¼ï¼Œä½†ä¸å¥½ç”¨ã€‚
-   `Object.prototype.toString()`å‡½æ•°ã€‚å¯ä»¥åˆ¤æ–­å¼•ç”¨ç±»å‹å€¼ï¼Œæ›¿ä»£`instanceof` æ“ä½œç¬¦ã€‚
-   `in` / `for in` æ“ä½œç¬¦ / éå†ã€‚

> åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»ç¯å¢ƒä¸­ï¼Œæ£€æŸ¥ä¸€ä¸ªå®ä¾‹ ï¼ˆJavaScript ä¸­çš„å¯¹è±¡ï¼‰çš„ç»§æ‰¿ç¥–å…ˆï¼ˆJavaScript ä¸­çš„å§”æ‰˜å…³è”ï¼‰é€šå¸¸è¢«ç§°ä¸ºå†…çœï¼ˆæˆ–è€…åå°„ï¼‰
>
> æ³¨ï¼šå§”æ‰˜å…³è”ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ç»§æ‰¿å…³ç³»ã€‚

æ–¹æ³•ä¸€ï¼š`instanceof` æ“ä½œç¬¦

`instance1 instanceof Father`ï¼Œè¿™æ®µä»£ç å›ç­”çš„é—®é¢˜æ˜¯ï¼š

-   åœ¨å®ä¾‹å¯¹è±¡ instance1 çš„æ•´æ¡åŸå‹é“¾ä¸­ï¼Œæ˜¯å¦æœ‰ `Father.prototype` åŸå‹å¯¹è±¡å‘¢ï¼Ÿ

æ³¨æ„ï¼šä»£ç ä¸­ "Father" æ˜¯æ„é€ å‡½æ•° `Father`ï¼Œè€Œä»£ç çœŸæ­£å»å¯»æ‰¾çš„æ˜¯æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ `Father.prototype`ï¼Œå®¹æ˜“ææ··æ³¨æ„åŒºåˆ†ã€‚

æ–¹æ³•äºŒï¼š`isPrototypeOf()`

`Father.protoype.isProtoypeOf( instance1 )`ï¼Œè¿™æ®µä»£ç å›ç­”çš„é—®é¢˜æ˜¯ï¼š

-   åœ¨å®ä¾‹å¯¹è±¡ instance1 çš„æ•´æ¡åŸå‹é“¾ä¸­ï¼Œæ˜¯å¦æœ‰ `Father.prototype` åŸå‹å¯¹è±¡å‘¢ï¼Ÿ

å¯ä»¥çœ‹åˆ°è¯¥æ–¹æ³•çš„ä½œç”¨å’Œ`instanceof` æ“ä½œç¬¦æ˜¯ä¸€æ‘¸ä¸€æ ·çš„ã€‚å…¶å¥½å¤„å°±æ˜¯æ’é™¤äº†æ„é€ å‡½æ•° `Father` çš„å¹²æ‰°ã€‚ç›´æ¥å»åˆ¤æ–­åŸå‹å¯¹è±¡ `Father.prototype`ï¼Œè¡¨æ„æ›´æ˜ç¡®äº†ã€‚

æ–¹æ³•ä¸‰ï¼š`Object.getPrototypeOf()`

`Object.getPrototypeOf( instance1 )`ï¼Œè¿™æ®µä»£ç è§£å†³çš„æ˜¯ï¼š

-   è·å–å®ä¾‹å¯¹è±¡ `instance1 ` çš„åŸå‹å¯¹è±¡ã€‚

æ³¨æ„ï¼šè¯¥æ–¹æ³•è¿”å›çš„æ˜¯å…¶åŸå‹å¯¹è±¡ã€‚ä¸èƒ½è¿”å›å®Œæ•´çš„åŸå‹é“¾ã€‚å¦‚æœæƒ³è·å¾—ä¸€ä¸ªå®Œæ•´çš„åŸå‹é“¾ï¼Œå¯ä»¥åå¤çš„è°ƒç”¨è¯¥æ–¹æ³•ï¼Œéå†æ•´æ¡åŸå‹é“¾ç›´åˆ° `null` æˆªæ­¢ã€‚

```js
function getProto(obj) {
    if (obj === null) return;
    console.log(obj);
    return Object.getPrototypeOf(obj);
}
```

æ–¹æ³•å››ï¼š`.__proto__`

`instance1.__proto__ === Son.prototype`ï¼Œè¿™æ®µä»£ç æ˜¯åˆ¤æ–­ï¼š

-   å®ä¾‹å¯¹è±¡ `instance1 ` çš„åŸå‹å¯¹è±¡æ˜¯ `Son.prototype` å—ï¼Ÿ

è¯¥å±æ€§æ˜¯æµè§ˆå™¨å…¬è®¤å±æ€§ï¼Œè€Œä¸æ˜¯ JS çš„å®˜æ–¹æ ‡å‡†ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªå±æ€§åæ›´åƒæ˜¯ä¸€ä¸ªç±»ä¼¼ getter çš„æ–¹æ³•ã€‚å…¶å†…éƒ¨çš„æ˜¯ä¾èµ– `Object.getPrototypeOf()` æ–¹æ³•å®ç°çš„ï¼Œä¸æ¨èä½¿ç”¨ã€‚

```js
// é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥éå†åŸå‹é“¾ã€‚
instance1.__proto__.__proto__ ....
```

## 7 é¢˜ç›®ï¼š

> é¢˜ç›®å‡æ˜¯ä»å…¶ä»–ä½œè€…çš„æ–‡ç« ä¸­æ‘˜æ¥ï¼Œå¯¹æ­¤è¡¨ç¤ºæ„Ÿè°¢ã€‚

### **ğŸŠ å…³ç³»ï¼šObject å’Œ Function**

-   `Function` æ˜¯æ‰€æœ‰å‡½æ•°çš„æ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±

    -   `Function.__proto__ === Function.prototype`
    -   æ‰€æœ‰å‡½æ•°éƒ½ç»§æ‰¿è‡ª `Function.prototype`
    -   æ‰€ä»¥ `Object` æ„é€ å‡½æ•°æ˜¯ `Function` ç±»å‹

-   æ‰€æœ‰åŸå‹é“¾æœ€ç»ˆæŒ‡å‘ `Object.prototype`
    -   `Object.prototype` æ˜¯æ‰€æœ‰å¯¹è±¡çš„åŸå‹ç»ˆç‚¹ï¼Œå®ƒçš„ `.__proto__` æŒ‡å‘ `null`ã€‚

```js
// ObjectåŸå‹å¯¹è±¡æ˜¯é¡¶å±‚å¯¹è±¡ï¼Œå®ƒçš„.constrocturæŒ‡å‘Objectæ„é€ å‡½æ•°ï¼Œ.__proto__æŒ‡å‘ null
Object.prototype.constructor === Object; // true
Object.prototype.__proto__ === null; // true

// FunctionåŸå‹å¯¹è±¡æ˜¯Objectç±»å‹ï¼Œæ‰€ä»¥å…¶åŸå‹é“¾.__proto__æŒ‡å‘ObjectåŸå‹å¯¹è±¡
Function.prototype.__proto__ === Object.prototype; // true

// Objectæ„é€ å‡½æ•°æ˜¯å‡½æ•°ï¼Œæ˜¯Functionç±»å‹ï¼Œæ‰€ä»¥å…¶åŸå‹é“¾.__proto__æŒ‡å‘FunctionåŸå‹å¯¹è±¡
Object.__proto__ === Function.prototype; // true
```

è®©æˆ‘ä»¬çœ‹çœ‹é¡¶å±‚å¯¹è±¡ Object.prototype æœ‰ä»€ä¹ˆå†…ç½®å±æ€§å’Œæ–¹æ³•ï¼š

```js
Object.getOwnPropertyDescriptors(Object.prototype); // é€šè¿‡APIå¯ä»¥æ‰“å°å‡ºæ‰€æœ‰å±æ€§ï¼Œä¸è®ºæ˜¯å¦å¯æšä¸¾

// chromeä¸­ï¼Œç”¨console.log(Object.prototype)ä¹Ÿå¯æ‰“å°ã€‚å…¶å±æ€§åé¢œè‰²å˜æ·¡ï¼Œæ ‡æ˜Object.prototypeæ‰€æœ‰å±æ€§éƒ½ä¸å¯æšä¸¾
console.log(Object.prototype);
```

![æˆªå±2022-07-25 22.26.11](images/08-%E5%8E%9F%E5%9E%8B%E9%93%BE.assets/%E6%88%AA%E5%B1%8F2022-07-25%2022.26.11.png)

```js
1. `å®ä¾‹å¯¹è±¡.xxx`æ¥è°ƒç”¨ï¼š
// åˆ¤æ–­å±æ€§
// hasOwnProperty: 	booleanï¼Œåˆ¤æ–­å®ä¾‹å¯¹è±¡ä¸Šæ˜¯å¦å­˜åœ¨â€˜å…¥å‚â€™å±æ€§
// propertyIsEnumerable: booleanï¼Œåˆ¤æ–­â€˜å…¥å‚â€™å±æ€§æ˜¯å¦å¯æšä¸¾ï¼Œä¸å¯æšä¸¾æˆ–å±æ€§ä¸å­˜åœ¨è¿”å›false

// åˆ¤æ–­åŸå‹é“¾
// isPrototypeOf: 	booleanï¼Œåˆ¤æ–­â€˜å…¥å‚â€™å¯¹è±¡æ˜¯å¦åœ¨å®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Š

// æ˜¾ç¤ºè¾“å‡º/ç±»å‹åˆ¤æ–­
// toString: è¿”å›è¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚
// valueOf:  æŒ‡å®šè¯¥å¯¹è±¡çš„åŸå§‹å€¼ã€‚
// toLocaleString: è¿”å›å®ä¾‹å¯¹è±¡ï¼ˆæ•°å­—çš„åŒ…è£…å¯¹è±¡ï¼‰åœ¨ç‰¹å®šè¯­è¨€ç¯å¢ƒä¸‹çš„è¡¨ç¤ºå­—ç¬¦ä¸²ï¼šæ¯”å¦‚äºŒè¿›åˆ¶ã€å…‹/ç£…

2. æ™®é€šå¯¹è±¡å±æ€§ï¼š
// constructor: è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°

// __defineGetter__: get çš„éæ ‡å‡†ç”¨æ³•ï¼Œä¸ºå±æ€§ï¼ˆå…¥å‚1ï¼‰ç»‘å®šä¸€ä¸ªgetterï¼ˆå…¥å‚2ï¼‰
// __defineSetter__: set çš„éæ ‡å‡†ç”¨æ³•ï¼Œä¸ºå±æ€§ï¼ˆå…¥å‚1ï¼‰ç»‘å®šä¸€ä¸ªsetterï¼ˆå…¥å‚2ï¼‰
// __lookupGetter__: è¿”å›å®ä¾‹å¯¹è±¡ä¸ŠæŸå±æ€§ï¼ˆå…¥å‚ï¼‰çš„ getter
// __lookupSetter__: è¿”å›å®ä¾‹å¯¹è±¡ä¸ŠæŸå±æ€§ï¼ˆå…¥å‚ï¼‰çš„ setter
```

**ï¼ˆ1ï¼‰çœ‹ä»£ç è¯†ç»“æœ**

```js
var A = function () {};
A.prototype.n = 1;
var a1 = new A();
A.prototype = {
    n: 2,
    m: 3,
};
var a2 = new A();

console.log(a1.n);
console.log(a1.m);

console.log(a2.n);
console.log(a2.m);
```

**è§£ç­”**ï¼š

åœ¨åˆ›å»ºå®ä¾‹å¯¹è±¡ `a1` åï¼Œæ‰§è¡Œäº†å¦‚ä¸‹ä»£ç ï¼š`A.prototype = { n:2. m:3 }`ã€‚

è¿™å¯¼è‡´äº†æ„é€ å‡½æ•° A çš„åŸå‹å¯¹è±¡å‘ç”Ÿäº†æ”¹å˜ï¼šä¸å†æ˜¯ä»¥å‰çš„ `{ n:1 }` äº†ï¼Œè€Œæ˜¯å˜æˆä¸€ä¸ªæ–°çš„å¯¹è±¡â€”â€” `{ n:2. m:3 }`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ°å€å€¼ä¸å†æ˜¯ä»¥å‰çš„é‚£ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯æŒ‡å‘äº†æ–°å¯¹è±¡ã€‚

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ new è¿ç®—ç¬¦å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šæŠŠè¯¥å®ä¾‹å¯¹è±¡çš„ `__proto__`å±æ€§æŒ‡å‘ **æ­¤æ—¶** æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œ

-   `a1.__proto__` æŒ‡å‘çš„æ˜¯æ—§å¯¹è±¡ `{n:2}`ï¼›
-   `a2.__proto__` æŒ‡å‘çš„æ˜¯æ–°å¯¹è±¡ `{n:2, m:3}`ã€‚

è¿™ä¸¤ä¸ªå®ä¾‹å¯¹è±¡åˆ†åˆ«æŒ‡å‘äº†ä¸åŒçš„å¯¹è±¡ï¼Œä¾ç…§åŸå‹é“¾æŸ¥æ‰¾çš„ç»“æœè‡ªç„¶ä¹Ÿä¸åŒã€‚

**ç»“è®º**ï¼š

ä¸è¦è½»æ˜“çš„é‡å®šä¹‰ `prototype` åŸå‹å¯¹è±¡ã€‚è¿™ä¼šå¯¼è‡´:

1. åŸå‹å¯¹è±¡çš„ `constructor` å±æ€§ä¸¢å¤±ã€‚å®ƒåŸæœ¬æŒ‡å‘äº†æ„é€ å‡½æ•°ï¼Œåœ¨é‡å®šä¹‰åŸå‹å¯¹è±¡åï¼Œéœ€è¦æ‰‹åŠ¨å†æŒ‡å®šä¸€ä¸‹ `constructor` å±æ€§ã€‚
2. é‡å®šä¹‰åŸå‹å¯¹è±¡çš„å‰åï¼Œå®ä¾‹åŒ–å¯¹è±¡ä¼šæŒ‡å‘ä¸åŒçš„åŸå‹å¯¹è±¡ï¼Œé€ æˆè¡¨ç°ä¸ä¸€è‡´ã€‚

```js
// ä¸è¦ä¸‹é¢è¿™æ ·é‡å®šä¹‰åŸå‹å¯¹è±¡ï¼š
A.prototype = {
    n: 2,
    m: 3,
};
// è¦åƒè¿™æ ·ç»™åŸå‹å¯¹è±¡æ·»åŠ å±æ€§ã€æ–¹æ³•
A.prototype.n = 2;
A.prototype.m = 3;
```

**ç­”æ¡ˆ**ï¼š

```js
console.log(a1.n); // 1
console.log(a1.m); // undefined

console.log(a2.n); // 2
console.log(a2.m); // 3
```

**ï¼ˆ2ï¼‰çœ‹ä»£ç è¯†ç»“æœ**

```js
var F = function () {};

Object.prototype.a = function () {
    console.log("a");
};

Function.prototype.b = function () {
    console.log("b");
};

var f = new F();

f.a();
f.b();

F.a();
F.b();
```

**è§£ç­”**ï¼š

1. `F` æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå±äºå‡½æ•°ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼›
2. `f` æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå±äº `F` ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚

æ‰€æœ‰å¯¹è±¡ï¼Œéƒ½æ˜¯ `Object` å¯¹è±¡ã€‚æ‰€ä»¥æ‰€æœ‰å¯¹è±¡éƒ½ç»§æ‰¿è‡ª `Object`ï¼ŒåŒ…æ‹¬äº†é¢˜ä¸­çš„ `F` å’Œ `f`ã€‚é‚£ä¹ˆåœ¨ `Object` åŸå‹é“¾ä¸Šçš„ a æ–¹æ³•ï¼Œf å’Œ F éƒ½å¯ä»¥è°ƒç”¨ï¼›

æ„é€ å‡½æ•° Fï¼Œæ˜¯ä¸€ä¸ª `Function` å‡½æ•°ç±»å‹ã€‚è€Œå®ä¾‹å¯¹è±¡ f ä¸æ˜¯ `Function` ã€‚æ‰€ä»¥åœ¨ `Function` åŸå‹é“¾ä¸Šçš„ b æ–¹æ³•ï¼Œåªæœ‰ F å¯ä»¥è°ƒç”¨ï¼Œ f æ— æ³•è°ƒç”¨ã€‚

**ç­”æ¡ˆ**ï¼š

```js
f.a(); // a
f.b(); // f.b is not a function

F.a(); // a
F.b(); // b
```

**ï¼ˆ3ï¼‰çœ‹ä»£ç è§£ç­”**

```js
function Person(name) {
    this.name = name;
}
let p = new Person("Tom");
```

é—®é¢˜ 1ï¼š `p.__proto__ `ç­‰äºä»€ä¹ˆï¼Ÿ

é—®é¢˜ 2ï¼š `Person.__proto __` ç­‰äºä»€ä¹ˆï¼Ÿ

**è§£ç­”**ï¼š

å’Œç¬¬äºŒé¢˜æ˜¯ä¸€è‡´çš„ï¼š

`Person` æ˜¯ `Function` ç±»ï¼Œæ‰€ä»¥å…¶åŸå‹é“¾æŒ‡å‘äº† `Function` çš„åŸå‹å¯¹è±¡ `Function.prototype`ï¼›

`p` æ˜¯ `Person` ç±»ï¼Œå…¶åŸå‹é“¾æŒ‡å‘äº† `Person` çš„åŸå‹å¯¹è±¡ `Person.prototype`ï¼›

**å¼•ç”³**ï¼š

`p.__proto__.__proto__ === Person.__proto__.__proto__  // true`

-   `Function.prototype`ï¼Œæ˜¯ `Object` ç±»ï¼Œæ‰€ä»¥å…¶åŸå‹é“¾æŒ‡å‘äº† `Object.prototype`ï¼›

-   `Person.prototype`ï¼Œæ˜¯ `Object` ç±»ï¼Œæ‰€ä»¥å…¶åŸå‹é“¾æŒ‡å‘äº† `Object.prototype`ï¼›

ä¹Ÿå°±æ˜¯è¯´ï¼ŒPerson å’Œ Function çš„åŸå‹å¯¹è±¡ï¼ŒæŒ‡å‘äº†åŒä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯ Object çš„åŸå‹å¯¹è±¡ã€‚

**ç­”æ¡ˆ**ï¼š

`p.__proto__` æŒ‡å‘ï¼šPerson åŸå‹ï¼Œä¹Ÿå°±æ˜¯`Person.prototype`ã€‚

`Person.__proto__` æŒ‡å‘ï¼šFunction åŸå‹ï¼Œä¹Ÿå°±æ˜¯ `Function.prototype`ã€‚

```js
// æ§åˆ¶å°çš„è¾“å‡ºç»“æœï¼š
p.__proto__; // {constructor: Æ’}
Person.__proto__; // Æ’ () { [native code] }
```

**ï¼ˆ4ï¼‰çœ‹ä»£ç è¯†ç»“æœ**

```js
function fn1() {
    console.log(1);
    this.num = 111;
    this.sayHey = function () {
        console.log("say hey.");
    };
}

function fn2() {
    console.log(2);
    this.num = 222;
    this.sayHello = function () {
        console.log("say hello.");
    };
}
fn1.call(fn2); // è¿™é‡Œæœ‰è¾“å‡ºå—ï¼Ÿ

fn1();
fn1.num;
fn1.sayHey();

fn2();
fn2.num;
fn2.sayHello();
fn2.sayHey();
```

**è§£ç­”**ï¼š

1. fn1 å’Œ fn2 æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ `fn1` å½“æˆå¯¹è±¡çœ‹ã€ `fn1()` å½“æˆå‡½æ•°çœ‹ã€‚
2. `fn1.call(fn2)`ï¼Œ æ˜¯æ‰§è¡Œäº† `fn1()`ã€‚åŒæ—¶ï¼Œ `fn1` å†…éƒ¨çš„ this å€¼ï¼ŒæŒ‡å‘äº† `fn2` å¯¹è±¡ã€‚
3. è¿™å°±å¯¼è‡´äº† numã€sayHey è¿™ä¸¤ä¸ªå±æ€§éƒ½èµ‹å€¼ç»™äº† å¯¹è±¡ fn2ã€‚æ‰€ä»¥ fn2 ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶æ‹¥æœ‰äº† num å’Œ sayHey è¿™ä¸¤ä¸ªå±æ€§ã€‚
4. fn1 æ­¤æ—¶æ²¡æœ‰èµ‹å€¼å…¶ä»–å±æ€§ã€‚æ‰€ä»¥ `fn1.xxx` éƒ½æœªå®šä¹‰ï¼›`fn2.num` å’Œ `fn2.sayHey` å­˜åœ¨ã€‚

**ç­”æ¡ˆ**ï¼š

```js
fn1.call(fn2); // 1 ï¼Œè¿™é‡Œæ‰§è¡Œäº† fn1() è‡ªç„¶ä¼šè¾“å‡ºæ•°å­—1.

fn1(); // 1
fn1.num; // undefined
fn1.sayHey(); // fn1.sayHey is not a function

fn2(); // 2
fn2.num; // 111
fn2.sayHello(); // fn2.sayHello is not a function
fn2.sayHey(); //say hey.
```

**å¼•ç”³**ï¼š

`apply()` å’Œ `call()` éƒ½æ˜¯ä¸ºäº†æ”¹å˜æŸä¸ªå‡½æ•° **è¿è¡Œæ—¶** çš„ä¸Šä¸‹æ–‡è€Œå­˜åœ¨çš„ã€‚

-   æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä¸ºäº†æ”¹å˜å‡½æ•°å†…éƒ¨çš„ `this` æŒ‡å‘ã€‚

```js
let a1 = add.call(son, 4, 2); // å‚æ•°ä¾æ¬¡æ˜¯ï¼šaddçš„thisï¼Œaddçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œaddçš„ç¬¬äºŒä¸ªå‚æ•°
let a1 = add.apply(son, [4, 2]); // å‚æ•°ä¾æ¬¡æ˜¯ï¼šaddçš„thisï¼Œaddçš„å‚æ•°æ•°ç»„é›†åˆ
```

å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•ä¼šç«‹å³è°ƒç”¨ï¼Œæ‰€ä»¥ä¸ºäº†å¼¥è¡¥å®ƒä»¬çš„ç¼ºå¤±ï¼Œè¿˜æœ‰ä¸ªæ–¹æ³• `bind()`ï¼Œå®ƒä¸ä¼šç«‹å³è°ƒç”¨ï¼š

bind ä¸ä¼šæ‰§è¡Œæ–¹æ³•ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªæ–°æ–¹æ³•ã€‚è¿™ä¸ªæ–°æ–¹æ³•çš„ this æŒ‡å‘è¢«å›ºå®šä¸º bind çš„å‚æ•°ã€‚

åŸæ–¹æ³•ä¸å—å½±å“ã€‚

```js
let newAdd = add.bind(son); // è¿”å›ä¸€ä¸ªæ–°æ–¹æ³• newAddï¼Œè¯¥æ–¹æ³•çš„thisè¢«å›ºå®šæŒ‡å‘son
```

**ï¼ˆ5ï¼‰çœ‹ä»£ç è§£ç­”**

```js
Object.prototype.__proto__; // null
Function.prototype.__proto__; // Object.prototype
Object.__proto__; // Function.prototype
```

-   `Object.prototype` åŸå‹é“¾çš„æ ¹èŠ‚ç‚¹ã€‚`Object.prototype` çš„åŸå‹å¯¹è±¡ä¸º `null`ã€‚
-   `Function.prototype` æ˜¯åŸå‹å¯¹è±¡ã€‚æ‰€ä»¥æ˜¯ `Object` ç±»çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚åŸå‹é“¾æŒ‡å‘ `Object.prototype`ã€‚
-   `Object` æ˜¯æ„é€ å‡½æ•°ã€‚æ‰€ä»¥æ˜¯ `Function` å‡½æ•°ç±»çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚åŸå‹é“¾è‡ªç„¶æŒ‡å‘ `Function.prototype`ã€‚

**ï¼ˆ6ï¼‰çœ‹ä»£ç è§£ç­”**

æŒ‰ç…§å¦‚ä¸‹è¦æ±‚å®ç° Person å’Œ Student å¯¹è±¡

-   Student ç»§æ‰¿ Personï¼›
-   Person åŒ…å«ä¸€ä¸ªå®ä¾‹å˜é‡ nameï¼Œ åŒ…å«ä¸€ä¸ªæ–¹æ³• printNameï¼›
-   Student åŒ…å«ä¸€ä¸ªå®ä¾‹å˜é‡ scoreï¼Œ åŒ…å«ä¸€ä¸ªæ–¹æ³• printScoreï¼›
-   æ‰€æœ‰ Person å’Œ Student å¯¹è±¡ä¹‹é—´å…±äº« printName æ–¹æ³•ï¼›

```js
// ç”¨æ„é€ å‡½æ•°å®ç°ï¼š
function Person(name) {
    this.name = name;
}
Person.prototype.printName = function () {
    console.log(this.name);
};

function Student(name, score) {
    Person.call(this, name);
    this.score = score;
}
// é‡‡ç”¨åŸå‹å¼ç»§æ‰¿
Student.prototype = Object.create(Person.prototype);
Student.prototype.constructor = Student;

Student.prototype.printScore = function () {
    console.log(this.score);
};

// ç”¨ç±»å®ç°ï¼š
class Person {
    constructor(name) {
        this.name = name;
    }
    printName() {
        console.log(this.name);
    }
}
class Student extends Person {
    constructor(name, score) {
        super(name);
        this.score = score;
    }
    printScore() {
        console.log(this.score);
    }
}

// å®ä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Student("Moxy", 99); // StudentÂ {name: "Moxy", score: 99}
let instance2 = new Student("Ninjee", 5); // StudentÂ {name: "Ninjee", score: 5}
instance1.printName === instance2.printName; // true
```

é™„ï¼šåŸå‹é“¾ç»å…¸å›¾è§£

Foo æ„é€ å‡½æ•°çš„ç‰¹æ€§ï¼š

-   Foo æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæœ‰ä¸€ä¸ªæ˜¾å¼åŸå‹å¯¹è±¡ï¼š`Foo.prototype`ï¼›
-   Foo æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ªéšå¼åŸå‹å¯¹è±¡ï¼ˆåŸå‹é“¾ï¼‰ï¼š`Foo.__proto__`ï¼›

![jsobj_full](images/08-%E5%8E%9F%E5%9E%8B%E9%93%BE.assets/jsobj_full.jpg)

# å¼•ç”¨ï¼š

> ã€Šä½ ä¸çŸ¥é“çš„ JavaScript ä¸Šã€‹
>
> ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ ç¬¬å››ç‰ˆã€‹
>
> http://www.mollypages.org/
>
> [ğŸ­ å›¾è§£åŸå‹å’ŒåŸå‹é“¾ (juejin.cn)](https://juejin.cn/post/6844903797039300615)
