<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-frontEnd/JavaScript/执行上下文">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="ninjee RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="ninjee Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="ninjee JSON Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Ninjee的前端篮子" href="/opensearch.xml">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0930342e569f854bebdeb485c0eac7f8",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<link rel="icon" href="/img/ninjee.jpeg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><title data-rh="true">2. 执行上下文 - Ninjee的前端篮子</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" name="twitter:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" property="og:url" content="https://ninjee.netlify.app/docs/frontEnd/JavaScript/执行上下文"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="keywords" content="Moxy, Ninjee, blog, javascript, typescript, python ,node, react, vue, web, 前端, 后端"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2. 执行上下文 - Ninjee的前端篮子"><meta data-rh="true" name="description" content="1 执行上下文 Execution Context"><meta data-rh="true" property="og:description" content="1 执行上下文 Execution Context"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/执行上下文"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/执行上下文" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/执行上下文" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AJRH2JRXVY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.cb2f47c4.css">
<link rel="preload" href="/assets/js/runtime~main.6ed7c867.js" as="script">
<link rel="preload" href="/assets/js/main.ab88f873.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Ninjee</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">前端知识</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/frontEnd/JavaScript">JavaScript</a></li><li><a class="dropdown__link" href="/docs/frontEnd/HTML&amp;CSS">HTML &amp; CSS</a></li><li><a class="dropdown__link" href="/docs/frontEnd/React">React</a></li><li><a class="dropdown__link" href="/docs/frontEnd/浏览器原理">浏览器原理</a></li><li><a class="dropdown__link" href="/docs/frontEnd/other">other</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">敲代码</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/code/algorithm">算法</a></li><li><a class="dropdown__link" href="/docs/code/writtenJs">手写Js</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">面试</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/interview/summary">总结</a></li><li><a class="dropdown__link" href="/docs/interview/iot">物联网</a></li></ul></div><a class="navbar__item navbar__link" href="/project">我的项目</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/javascript">JavaScript</a><button aria-label="打开/收起侧边栏菜单「JavaScript」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript">概述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/frontEnd/JavaScript/DOM&amp;BOM/1 Document &amp; 事件">BOM &amp; DOM</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/JavaScript的执行过程">1. JavaScript的执行过程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/frontEnd/JavaScript/执行上下文">2. 执行上下文</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/作用域链和闭包">3. 作用域链和闭包</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/this与箭头函数">4. this与箭头函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/提升与暂时性死区">5. 提升与暂时性死区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/函数与函数式编程">6. 函数与函数式编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/对象">7. 对象</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/原型链">8. 原型链</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/继承和类">9. 继承和类</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/ES6+基础">10. ES6+ 基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/Symbol, Set, Map">11. Symbol, Set, Map</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/Proxy, Reflect">12. Proxy, Reflect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/Promise">13. Promise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/async:await, 异步编程">15. 迭代, 异步编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/模块化">16. 模块化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/z-ArrayAPI">Array API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/z-类型判断">类型判断与类型转换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/frontEnd/JavaScript/z-执行上下文-ES3">执行上下文(ES3)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/html--css">HTML &amp; CSS</a><button aria-label="打开/收起侧边栏菜单「HTML &amp; CSS」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/react">React</a><button aria-label="打开/收起侧边栏菜单「React」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/浏览器原理">浏览器原理</a><button aria-label="打开/收起侧边栏菜单「浏览器原理」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/other">other</a><button aria-label="打开/收起侧边栏菜单「other」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/algorithm">algorithm</a><button aria-label="打开/收起侧边栏菜单「algorithm」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/手写-js">手写 Js</a><button aria-label="打开/收起侧边栏菜单「手写 Js」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/总结">总结</a><button aria-label="打开/收起侧边栏菜单「总结」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_FykI"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_DTRl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/javascript"><span itemprop="name">JavaScript</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">2. 执行上下文</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>2. 执行上下文</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-执行上下文-execution-context">1 执行上下文 Execution Context<a class="hash-link" href="#1-执行上下文-execution-context" title="标题的直接链接">​</a></h2><p>JavaScript 标准把一段代码（包括函数），在 Js 引擎执行所需的所有信息定义为：“执行上下文”。</p><p>通过上文了解的 Js 执行过程我们知道，Js 引擎的代码执行是以块为单位的，每个块划分为 <strong>编译时</strong> 和 <strong>运行时</strong> 两个阶段。 </p><p>这个块是按照 <strong>词法作用域（函数作用域、全局作用域）</strong>来划分，每个词法作用域也是一个运行环境。当 JS 引擎要执行某个运行环境时，这个运行环境就会创建一个登记相关信息的资料表，这个表就是 <strong>执行上下文</strong>。执行上下文整理了该运行环境内所有的信息：声明的变量、函数、外部作用域、this、内部属性 <code>[[scope]]</code> 等等。</p><p>所以，执行上下文就是一个登记信息的资料表，这个表整理了一个运行环境，或者是一个函数作用域（或全局作用域）要执行时的全部信息。</p><p>在运行环境的编译时，会创建执行上下文，Js 引擎会根据代码中变量、函数来初始化执行上下文；在运行时，会随时读取执行上下文中的信息，并根据代码更新执行上下文中的信息；当该运行环境中的代码全部执行完毕后，则会这个销毁执行上下文。</p><p>JS 的 <strong>运行环境</strong> 主要有 3 种：</p><ol><li>全局环境。在开始执行代码时，最先进入的就是全局环境，这也是全局作用域；</li><li>函数环境。函数调用的时候，进入到这个函数环境，这也是函数作用域；</li><li>eval 环境。用的很少，存在安全和性能问题，这其实也一个函数作用域。</li></ol><p>对应的，当运行环境即将执行时，会创建 <strong>执行上下文</strong>：</p><ol><li>全局执行上下文。调用栈最底层的执行上下文，伴随着调用栈的创建而入栈，调用栈的销毁而出栈。</li><li>函数执行上下文。函数调用的时候，进入到这个函数环境，这也是函数作用域；</li><li>eval 函数执行上下文。</li></ol><p><strong>以下摘抄自 winter 重学前端</strong></p><p>因为这部分术语经历了比较多的版本和社区的演绎，所以定义比较混乱，这里我们先来理一下 JavaScript 中的概念。</p><p><strong>执行上下文</strong> 在 <strong>ES3</strong> 中，包含三个部分。</p><ul><li>scope：作用域，也常常被叫做作用域链。</li><li>variable object：（VO） 变量对象，用于存储变量的对象。</li><li>this value：this 值。</li></ul><p>在 <strong>ES5</strong> 中，我们改进了命名方式，把执行上下文最初的三个部分改为下面这个样子。</p><ul><li>variable environment：变量环境，当声明变量时使用。</li><li>lexical environment：词法环境，当获取变量时使用。</li><li>this value：this 值。</li></ul><p>在 <strong>ES2018</strong> 中，执行上下文又变成了这个样子，this 值被归入 lexical environment，但是增加了不少内容。</p><ul><li>variable environment：变量环境，当声明变量时使用。</li><li>lexical environment：词法环境，当获取变量或者 this 值时使用。</li><li>code evaluation state：用于恢复代码执行位置。</li><li>Function：执行的任务是函数时使用，表示正在被执行的函数。</li><li>ScriptOrModule：执行的任务是脚本或者模块时使用，表示正在被执行的代码。</li><li>Realm：使用的基础库和内置对象实例。</li><li>Generator：仅生成器上下文有这个属性，表示当前生成器。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="11-基本模型">1.1 基本模型<a class="hash-link" href="#11-基本模型" title="标题的直接链接">​</a></h3><p>所以，本文是基于引入块作用域的 ES6 规则，来描述执行上下文的，更接近 ES5 标准。</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210905222654919-cb15e763b53d94c677f0b133b63dfcb0.png" width="771" height="746" class="img_E7b_"></p><p>在 JavaScript 引擎内部，每次调用执行上下文，会分为两个阶段：</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="一编译阶段">一：编译阶段<a class="hash-link" href="#一编译阶段" title="标题的直接链接">​</a></h4><p>引擎创建执行上下文，编译器逐行扫描代码片段，根据需要把对应的声明、作用域、this值等信息登记到执行上下文中。扫描完毕后，会把代码片段转化为运行时可执行的代码。</p><p><strong>创建执行上下文</strong>，并把创建好的执行上下文压入调用栈中。此时函数被调用，但未执行任何其内部代码，依次创建：</p><ol><li><strong>variable environment 变量环境</strong>：参与 <strong>函数作用域</strong> 的 (<code>var</code>)变量和 (<code>function</code>)函数的相关声明和初始化。更多相关信息，参考 <strong>”变量环境“</strong> 章节。<ul><li><strong>outer 外部环境</strong>：指向了外部的 <strong>函数作用域（或全局作用域）</strong>，或者说外部的执行上下文。根据 outer 的引用关系，形成了一个 <code>[[scope]]</code> 链。更多相关信息，参考 <strong>”作用链“</strong> 章节。</li></ul></li><li><strong>lexical environment 词法环境</strong>：参与 <strong>块级作用域</strong> 的变量 <code>let</code> 、 <code>const</code> 和 <code>class</code>的相关声明。词法环境中，是一个栈，保存了块作用域的结构。更多相关信息，参考 <strong>”词法环境“</strong> 章节。</li><li><strong>this value</strong>：保存 this 值。更多相关信息，参考 <strong>”this“</strong> 章节。</li></ol><h4 class="anchor anchorWithStickyNavbar_mojV" id="二运行阶段">二：运行阶段<a class="hash-link" href="#二运行阶段" title="标题的直接链接">​</a></h4><p>运行阶段时，引擎会逐行运行可执行代码，根据代码来对执行上下文的信息进行读取、更新。</p><p>当遇到一个新的代码块时（一个新的函数作用域），会暂停对当前代码的运行时，进入这个代码块儿的编译时，创建对应的执行上下文。直到新代码块儿的代码经历了编译时、运行时，全部执行完毕后。恢复当前代码的继续执行。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="12-全局执行上下文">1.2 全局执行上下文<a class="hash-link" href="#12-全局执行上下文" title="标题的直接链接">​</a></h3><p>ES3 版本：</p><p>在执行代码前，引擎会预先创建好基本的对象，放入 globalObject，也就是在全局执行上下文中：</p><ul><li>类：String、Date、Window（指向 globalObject）；</li><li>函数：setTimeout ...</li></ul><p>他们通过原型链的形成继承关系，最终都指向了 Object 对象。</p><p>在全局作用域内的变量声明，都会放在 globalObject（GO）中。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-调用栈-call-stack">2 调用栈 Call Stack<a class="hash-link" href="#2-调用栈-call-stack" title="标题的直接链接">​</a></h2><p>调用栈是一个机制，用来让 JavaScript 引擎方便地去追踪函数执行。当一次有多个函数被调用时，通过调用栈就能够追踪到哪个函数正在被执行，以及查看各函数之间的调用关系。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="流程">流程<a class="hash-link" href="#流程" title="标题的直接链接">​</a></h3><p>上文提到，执行上下文是一个收集信息的表，收集了即将要执行的运行环境  / 函数或全局作用域所需要的全部信息。</p><p>在 JS 执行阶段时，会逐块识别载入的代码。这些代码根据 <strong>词法作用域</strong>（有全局作用域、函数作用域，这里没有块作用域）划分，区分出一块块的代码块。这些代码块也称之为 <strong>运行环境</strong>。</p><p>之后全部代码的执行，都是按照个一块块代码块为单位，来逐块儿往下执行的。</p><p>每个代码块儿，在引擎要执行它的时候，都有一个登记代码块中相关信息的表需要维护。这个表存放了代码块中的全部变量、函数、作用域、this 等各种需要在引擎执行该代码块儿时用到的信息。而这个存放信息的表，称之为这个代码块儿的 <strong>执行上下文</strong>。</p><ul><li>需要强调的是，只有当代码块儿需要执行的时候，才会创建 <strong>执行上下文</strong>，尚未执行到的代码，不会创建执行上下文。一个代码块儿可能会经历多个执行上下文的创建，比如 <code>foo()</code> 函数调用，在代码中执行了两次。每次执行函数调用，都会创建一个 <strong>foo 执行上下文</strong>。</li></ul><p>引擎在词法/语法分析阶段结束后，创建一个 <strong>执行上下文栈</strong>，也称为 <strong>调用栈</strong>。然后，引擎开始执行 JavaScript 代码，遇到一个要执行的词法作用域，在编译阶段，就会给他创建一个执行上下文，然后放入执行上下文栈中。在运行阶段，就会更新和调用执行上下文中的信息。</p><ul><li>如果当前 <strong>执行上下文</strong> 对应的代码全部执行完毕，该执行上下文就会出栈；</li><li>如果当前 <strong>执行上下文</strong> 对应的代码中，有新的函数作用域，就会继续创建一个与这个函数作用域对应的执行上下文，放入栈中。 JS 引擎开始执行这个运行环境的编译时、运行时。</li></ul><p><img loading="lazy" alt="image-20210905222747993" src="/assets/images/image-20210905222747993-540b6b1f77a262e858f1820ad2d40904.png" width="2078" height="1593" class="img_E7b_"></p><p>JS 引擎会以栈的数据结构对执行上下文进行处理，形成<strong>执行上下文栈（ECStack）</strong>。就像 stack overflow 的logo 那样：</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210902160113488-64068f0e0e908510980b7c84ac6dd498.png" width="1679" height="599" class="img_E7b_"></p><p>栈底是 <strong>全局执行上下文（global execution context）</strong>，栈顶时是当前的执行上下文。</p><p>全局执行上下文，在运行时会最先被放入栈底，且一直存在，直到代码全部执行完毕才会出栈。</p><ul><li>在全局执行上下文中，Js 引擎会在堆内存中创建全局对象： Global Object（GO）这其实是一个闭包的形式。然后在全局执行上下文中引用这个堆内存的对象。<ul><li>该对象所有的作用域都可以访问的到；</li><li>里面会预先定义：<ul><li>引用类型：Date、Array、String、Number；</li><li>函数：setTimeout、setInterval；</li><li>window：指向自己。</li></ul></li></ul></li></ul><p>入栈：当正在执行的代码中，出现函数调用，即会对应的创建一个新的执行上下文，把该执行上下文压入栈中。活跃指针指向了这个新建的执行上下文。开始执行新执行上下文中的代码。</p><p>出栈：当执行上下文中的代码全部执行完毕，执行上下文会从栈中弹出。活跃指针指向上一个执行上下文。</p><p>另：JavaScript 的引用数据存储，是在一个堆结构中。包括 function、 array 等各种对象，都保存在堆内存中。栈中的变量中，保存的是这些数据在堆内存的地址。所以才会把引用数据类型的值，称之为”地址值“。相反，基本数据类型的值，就是具体的值。因为 string、number 等数据，都是直接保存在栈中的（具体来讲，是栈中每一个执行上下文内）。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="如何查看调用栈">如何查看调用栈：<a class="hash-link" href="#如何查看调用栈" title="标题的直接链接">​</a></h3><ol><li>使用 <code>console.trace()</code> 打印当前函数的调用关系；</li><li>使用 <code>debugger</code> 打断点，然后通过开发者工具中，<code>call stack</code> 查看当前函数的调用关系。</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-变量环境-variable-environment">3 变量环境 Variable Environment<a class="hash-link" href="#3-变量环境-variable-environment" title="标题的直接链接">​</a></h2><p>本小节详细剖析环境变量内部的结构。</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210905222654919-cb15e763b53d94c677f0b133b63dfcb0.png" width="771" height="746" class="img_E7b_"></p><p>根据 ECMA 标准规定，环境变量主要分为两个内容，即：</p><ul><li>登记当前函数 (全局) 作用域内的全部变量和函数；</li><li>外部环境 <code>outer</code> 属性指向当前执行上下文的父函数 (全局) 作用域。如果是全局执行上下文，则 <code>outer</code> 的值为 <code>null</code>。</li></ul><p><code>outer</code> 属性和 <strong>作用域</strong> 紧紧挂钩，它和 <strong>调用栈</strong> 不是一套规则，更多 <code>outer</code> 属性的相关内容，参见 <strong>“作用域链 Scope Chain”</strong> 章节。</p><p>在代码的编译阶段，JS 引擎会对变量进行提升。而变量环境内部，就是承接 <code>var</code> 声明的变量和 <code>function</code> 声明的函数。更多相关内容，参见 <strong>“提升 Hoisting”</strong>  和 <strong>“词法环境 Lexical Environment”</strong> 章节。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-词法环境-lexical-environment">4 词法环境 Lexical Environment<a class="hash-link" href="#4-词法环境-lexical-environment" title="标题的直接链接">​</a></h2><p>引，块级作用域：</p><p>任何用大括号括起来的区域，都是一个块级作用域：</p><ul><li>if else、function、switch ...</li></ul><p>ES6 标准规定：<code>const</code>、<code>let</code>、<code>function</code>、<code>class</code> 都受块级作用域的限制，意思是仅有 <code>var</code> 不受限制。</p><p>但大多数浏览器为了兼容旧代码，对 <code>function</code> 不受限制，所以仅有 <code>const</code>、<code>let</code>、<code>class</code>受到约束。</p><p>本小节详细剖析词法环境内部的结构。</p><p>上文我们了解到，ES6 的执行上下文模型中，词法环境用来登记 <code>let</code> 和 <code>const</code> 关键词声明的变量，用来记录块作用域。在词法环境中，实际上是一个类似调用栈一样的小型 <strong>栈</strong> 结构。调用栈内，是按照函数作用域划分的不同栈元素；而词法环境内，小型栈是按照词法作用域划分的不同栈元素。</p><p>一个词法环境的作用域范围，就是一个函数作用域（或全局作用域）。</p><p>为了更好的讲解词法环境中，栈的具体结构，我们要先回顾一下块作用域中 <code>let</code> 和 <code>const</code> 的变量提升问题。</p><p>关于变量提升，ECMAScript 规定：</p><ul><li><code>var</code> 和 <code>function</code> 声明的变量，只在函数 / 全局作用域中提升。</li><li><code>let</code> 和 <code>const</code> 声明的变量，不会提升。（事实上，在运行时的块作用域中 “创建提升”）。</li></ul><p>更多关于提升 Hoisting 的知识，请参考 <strong>“提升 Hoisting”</strong> 章节。</p><p>上文说过，在执行上下文中的词法环境，是一个类似执行下文栈的小型栈。这个小型栈维护了该运行环境内的所有块作用域，自然也维护了块作用域内声明的 <code>let</code> 和 <code>const</code> 变量。</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210903225021362-6b225597f852d980e585318733a8cda9.png" width="764" height="738" class="img_E7b_"></p><p>所以，面对块作用域，Js 引擎的执行流程是这样的：</p><p>JS 引擎进入当前运行环境的 <strong>编译时</strong>，</p><ol><li>提升全部的 <code>function</code> 函数，放在 <strong>变量环境</strong> 中；</li><li>提升全部的 <code>var</code> 变量，放在 <strong>变量环境</strong> 中；</li><li>只提升最外层的 <code>let</code> 和 <code>const</code> 变量，放在 <strong>词法环境</strong> 中。</li></ol><p>JS 引擎进入当前运行环境的 <strong>运行时</strong>，</p><ol><li>开始逐行执行代码；</li><li>当读取到一个块作用域，会暂停对后面代码的执行。</li><li>首先在词法环境中创建一个属于这个块作用域区域，然后对该块作用域内声明的 <code>let</code> 和 <code>const</code> 进行 <strong>变量创建提升</strong>，并 <strong>初始化</strong>。</li><li>当变量提升完成后，才会恢复对后面代码的执行。</li></ol><p>需要注意的是，在真实的浏览器 V8 引擎中， <code>let</code> 和 <code>const</code> 变量进行提升时，不仅 <strong>创建</strong> 了变量，也对变量进行了 <strong>初始化</strong>。这和 ECMA 的标准不符。为了保证和标准的表现一致，这些变量在执行赋值操作前，V8引擎被禁止对其读取。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="5-函数如何参与">5. 函数如何参与<a class="hash-link" href="#5-函数如何参与" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="51-函数的声明和执行">5.1 函数的声明和执行<a class="hash-link" href="#51-函数的声明和执行" title="标题的直接链接">​</a></h3><p>函数创建时，会从内存中新建一块堆内存来存储代码块。在函数执行时，会从堆中取出代码字符串，存放在新建的栈中。</p><p>在堆内存中，会存储：</p><ul><li><code>[[scope]]</code> 父级作用域，形成一个作用域链；</li><li>函数的执行体（代码块），以 string 的形式保存。</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="53-函数声明">5.3 函数声明<a class="hash-link" href="#53-函数声明" title="标题的直接链接">​</a></h4><ol><li>申请空间。开辟堆内存（16进制），得到内存地址；</li><li>声明环境。声明当前函数的作用域；</li><li>存储代码。把函数代码以字符串的形式存储在堆内存中；<ul><li>函数在不执行的情况下，在堆内存中以字符串形式存储。</li></ul></li><li>指针引用。将函数堆的地址，放在栈中供变量调用（函数名）；</li></ol><h4 class="anchor anchorWithStickyNavbar_mojV" id="54-执行函数">5.4 执行函数<a class="hash-link" href="#54-执行函数" title="标题的直接链接">​</a></h4><ol><li>创建一个当前函数的执行上下文，入调用栈。</li><li>初始化作用域链；</li><li>初始化 this（箭头函数没有this）；</li><li>初始化 arguments 实参集合（箭头函数没有arguments），存储在堆内存中；<ul><li>形参赋值，对 arguments 内的参数进行初始化赋值；</li></ul></li><li>变量提升，函数代码中的变量（函数）进行变量提升；</li><li>代码执行，在函数堆中存储的字符串在当前上下文中执行；</li></ol><p>所以，函数的入参是保存在堆内存中的。</p><ul><li>具体是保存在堆内存中的 arguments 对象下；</li><li>不论入参是否是基本类型，都在堆内存中保存；</li><li>入参在代码执行之前、在变量提升之前，已经完成初始化赋值了。</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="6-举例">6. 举例<a class="hash-link" href="#6-举例" title="标题的直接链接">​</a></h2><p>举个例子来体现这个问题：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">debugger</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> a1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> a2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> a11 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a11&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> a22 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a22&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> a111 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a111&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> a222 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a222&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>首先分析这段代码的作用域：全局作用域 &lt;---- <code>foo</code> 函数作用域， <code>foo</code> 函数作用域内部又因为一个大括号分隔开内外两个块作用域。</p><p>然后分析这代段代码的运行环境，一共有两个运行环境，全局运行环境和 foo 函数运行环境。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="第一步">第一步<a class="hash-link" href="#第一步" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210904202426916-fa701f6a334d394f0fdffdb9ca7bec21.png" width="1795" height="1005" class="img_E7b_"></p><p>当代码执行到第一行 <code>debugger</code> 时，已经完成了对全局执行上下文的创建。此时 V8 引擎对 <code>a1</code> 变量声明，且初始化为 <code>undefined</code>，对 <code>a2</code> 变量也进行了声明且初始化为 <code>undefined</code>。但是，为了和标准表现一致（<code>let</code> 声明的变量只能声明提升，不能初始化提升），这里没有允许引擎对 <code>a2</code> 变量进行访问，把它放在了一个单独的区域内。</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210904104935615-9c5ef47c5a6a30b3e30f52990c558554.png" width="1032" height="1426" class="img_E7b_">
<img loading="lazy" alt="imgx" src="/assets/images/image-20210904105018586-38ab185fed2f48645ffca1a22fdd3ded.png" width="1029" height="1450" class="img_E7b_"></p><p>左图可以看到，此时 Call Stack 调用栈中，压入了匿名的全局执行上下文。<code>var</code> 声明的 <code>a1</code> 变量在 Global，初始化为 <code>undefined</code>； <code>let</code> 声明的变量 <code>a2</code> 在 Script 中放置，也已经初始化为 <code>undefined</code>。</p><p>右图可以看到，在执行上下文创建完成，刚进入运行阶段时，a1 输出 <code>undefined</code>，a2 报错。虽然 <code>a2</code> 已经被初始化，但最终效果和标准一致，在尚未执行第 6 行的赋值语句之前，<code>a2</code> 不允许被访问，报错。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="第二步">第二步<a class="hash-link" href="#第二步" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20210907160558431" src="/assets/images/image-20210907160558431-56fb1dcc16ab28bb995dc163ea2b9ba1.png" width="1575" height="844" class="img_E7b_"></p><p>当代码执行到第7行时，进入 foo 的函数执行上下文。</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210904111643797-976c2ba284b392ff12d4d8ea6ad25fc2.png" width="1033" height="1156" class="img_E7b_"></p><p>上图可以看到，当代码执行到第 11 行，<code>foo</code> 执行上下文的编译阶段已经完成，刚进入运行阶段。此时已经完成对执行上下文的创建和初始化。此时，不仅处在 <code>foo</code> 函数作用域内，还处在 <code>foo</code> 内第一个块作用域中，所以也会对第一个块作用域中的变量进行提升。此时对 <code>a11</code>，<code>a22</code>，和 <code>a111</code> 进行声明和初始化。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="第三步">第三步<a class="hash-link" href="#第三步" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20210907160613446" src="/assets/images/image-20210907160613446-5a1c706163014fb9d6d9f14164946466.png" width="1504" height="859" class="img_E7b_"></p><p>当代码执行到第12行时，执行到第二个块级作用域时，对第二个块作用域中的变量进行提升。可以看到上图中，词法环境中，是一个块作用域的栈。第二个块作用域中的 <code>let</code> 变量已经声明，然后入栈。</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210904111720844-21eec010023760e7985ba619193cae2a.png" width="1037" height="1118" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="第四步">第四步<a class="hash-link" href="#第四步" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20210907160627847" src="/assets/images/image-20210907160627847-ce308d46f5f481ffb4c5e52c7960b920.png" width="1500" height="858" class="img_E7b_"></p><p>当全部代码执行完毕，即将完成 foo 函数执行上下文的运行阶段，以及全局执行上下文的运行阶段时，可以看到调用栈如上图所示。</p><h1>引用</h1><blockquote><p>《你不知道的JavaScript》</p><p>winter - 重学前端</p><p>李兵 - 浏览器工作原理与实战</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/java-script">JavaScript</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/frontEnd/JavaScript/JavaScript的执行过程"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">1. JavaScript的执行过程</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/frontEnd/JavaScript/作用域链和闭包"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">3. 作用域链和闭包</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-执行上下文-execution-context" class="table-of-contents__link toc-highlight">1 执行上下文 Execution Context</a><ul><li><a href="#11-基本模型" class="table-of-contents__link toc-highlight">1.1 基本模型</a><ul><li><a href="#一编译阶段" class="table-of-contents__link toc-highlight">一：编译阶段</a></li><li><a href="#二运行阶段" class="table-of-contents__link toc-highlight">二：运行阶段</a></li></ul></li><li><a href="#12-全局执行上下文" class="table-of-contents__link toc-highlight">1.2 全局执行上下文</a></li></ul></li><li><a href="#2-调用栈-call-stack" class="table-of-contents__link toc-highlight">2 调用栈 Call Stack</a><ul><li><a href="#流程" class="table-of-contents__link toc-highlight">流程</a></li><li><a href="#如何查看调用栈" class="table-of-contents__link toc-highlight">如何查看调用栈：</a></li></ul></li><li><a href="#3-变量环境-variable-environment" class="table-of-contents__link toc-highlight">3 变量环境 Variable Environment</a></li><li><a href="#4-词法环境-lexical-environment" class="table-of-contents__link toc-highlight">4 词法环境 Lexical Environment</a></li><li><a href="#5-函数如何参与" class="table-of-contents__link toc-highlight">5. 函数如何参与</a><ul><li><a href="#51-函数的声明和执行" class="table-of-contents__link toc-highlight">5.1 函数的声明和执行</a><ul><li><a href="#53-函数声明" class="table-of-contents__link toc-highlight">5.3 函数声明</a></li><li><a href="#54-执行函数" class="table-of-contents__link toc-highlight">5.4 执行函数</a></li></ul></li></ul></li><li><a href="#6-举例" class="table-of-contents__link toc-highlight">6. 举例</a><ul><li><a href="#第一步" class="table-of-contents__link toc-highlight">第一步</a></li><li><a href="#第二步" class="table-of-contents__link toc-highlight">第二步</a></li><li><a href="#第三步" class="table-of-contents__link toc-highlight">第三步</a></li><li><a href="#第四步" class="table-of-contents__link toc-highlight">第四步</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">分享</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/frontEnd/JavaScript">前端</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/code/algorithm">算法笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/project">我的项目</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/moxyNJ" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/user/2005151873514024" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a href="https://www.ninjee.co" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ninjee 的前端篮子</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p>Copyright © 2022 Ninjee Built with Docusaurus.</p><p><a href="http://beian.miit.gov.cn/">晋ICP备2021017941号-2</a></p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.6ed7c867.js"></script>
<script src="/assets/js/main.ab88f873.js"></script>
</body>
</html>