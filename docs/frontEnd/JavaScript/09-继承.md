---
title: 9. ç»§æ‰¿çš„å®žçŽ°
sidebar_position: 9
date: 2022-07-25
tags: [JavaScript]
---



## ç»§æ‰¿

ä¸‹é¢æ•´ç†å¸¸è§çš„ç»§æ‰¿æ–¹å¼ï¼š

1. ç»å…¸ç»§æ‰¿  / å€Ÿç”¨æž„é€ å‡½æ•°
2. ç»„åˆç»§æ‰¿
3. åŽŸåž‹ç»§æ‰¿
4. å¯„ç”Ÿç»§æ‰¿
5. å¯„ç”Ÿç»„åˆç»§æ‰¿
6. æœ€ä½³å®žè·µ



ç®€å•æ•´ç†ï¼š

```js
// 1 åŽŸåž‹é“¾ç»§æ‰¿:å­ç±»åŽŸåž‹ç»§æ‰¿çˆ¶ç±»å±žæ€§
Son.prototype = new Father();
// 2 ç»å…¸ç»§æ‰¿ / å€Ÿç”¨æž„é€ å‡½æ•°:åœ¨Sonå†…ä¸ç”¨newç›´æŽ¥è°ƒç”¨Fatheræž„é€ å‡½æ•°
Function Son(name) {Father.call(this, arguments);}
// 1å’Œ2ä¼˜ç¼ºç‚¹æ˜¯äº’æ–¥çš„ï¼Œç”±æ­¤å¼•å‡ºæ–¹æ³•3ï¼š
// 	 ã€ŒåŽŸåž‹é“¾ç»§æ‰¿ã€è§£å†³äº†çˆ¶ç±» **æ–¹æ³•å¤ç”¨** çš„é—®é¢˜ï¼Œå‡ºçŽ°äº†çˆ¶ç±» **å±žæ€§ä¸ç‹¬ç«‹** çš„é—®é¢˜ã€‚
// 	 ã€Œå€Ÿç”¨æž„é€ å‡½æ•°ã€è§£å†³çˆ¶ç±» **å±žæ€§ç‹¬ç«‹** çš„é—®é¢˜ï¼Œå‡ºçŽ°äº†çˆ¶ç±» **æ–¹æ³•æ— æ³•å¤ç”¨** çš„é—®é¢˜ã€‚

// 3 ç»„åˆç»§æ‰¿:è°ƒç”¨2æ¬¡ new Father() => Sonå†…éƒ¨è°ƒç”¨(ç»§æ‰¿å±žæ€§), Son.prototypeç»‘å®šè°ƒç”¨(ç»§æ‰¿æ–¹æ³•)
function Son(name,age){ Father.call(this,name) }
Son.prototype = new Father()

// 4 åŽŸåž‹å¼ç»§æ‰¿:è‡ªå®šä¹‰objetï¼Œçˆ¶ç±»å­ç±»æ‰€æœ‰æ–¹æ³•éƒ½å…±ç”¨
// ES5-
function object(obj) {
  function Son() {}
  Son.prototype = obj;
  return new Son() 
}
// ES5
Student.prototype = Object.create(Person.prototype)   // StudentåŽŸåž‹è¢«é‡å®šä¹‰ï¼Œconstructoréœ€è¦é‡æ–°æŒ‡å‘ã€‚
// ES6
Object.setPrototypeOf(Son.prototype, Father.prototype)

// 5 å¯„ç”Ÿå¼ç»§æ‰¿ï¼šæ˜¯åŽŸåž‹å¼çš„å‡çº§ç‰ˆï¼Œæœ‰object()çš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ createSon()å®žçŽ°Sonå¢žæ·»æ–°å±žæ€§å’Œæ–¹æ³•ã€‚
function createSon(original) {
    // let Son = Object.create(original); 
    let son = object(original);
    son.sayHi = function () {
        console.log('hi')
    }
    return son
}

// 4 å’Œ 5 éƒ½ä¸ä¼šç”Ÿæˆæž„é€ å‡½æ•°å’Œç±»çš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æŽ¥æž„é€ äº†å®žä¾‹å¯¹è±¡ï¼š
let son1 = object(father);      // åŽŸåž‹å¼
let son1 = createSon(father);   // å¯„ç”Ÿå¼

// 6 å¯„ç”Ÿç»„åˆå¼ï¼Œç»§æ‰¿çˆ¶ç±»æ–¹æ³•è°ƒç”¨inheritePrototypeç»‘å®šåŽŸåž‹é“¾ï¼Œç»§æ‰¿çˆ¶ç±»æ–¹æ³•ç”¨new Father()è°ƒç”¨æž„é€ å‡½æ•°ã€‚
function inheritPrototype(Sub, Super) {
    let subPrototype = Object.create(Super.prototype)
    subPrototype.constructor = Sub
    Sub.prototype = subPrototype
}
```



### å¼•å­1ï¼šnew è¿ç®—ç¬¦

new ä¸€ä¸ªæ–°å¯¹è±¡çš„è¿‡ç¨‹ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

```js
let person1 = new Person("Moxy", 15);
```

è¦åˆ›å»º Person çš„æ–°å®žä¾‹ï¼Œå¿…é¡»ä½¿ç”¨ new æ“ä½œç¬¦ã€‚ä»¥è¿™ç§æ–¹å¼è°ƒç”¨æž„é€ å‡½æ•°å®žé™…ä¸Šä¼šç»åŽ†ä»¥ä¸‹ 5 ä¸ªæ­¥éª¤ï¼š

1. åˆ›å»ºä¸€ä¸ª **æ–°å¯¹è±¡** `{}`ï¼›
2. ä¸ºæ–°å¯¹è±¡ç»‘å®š **åŽŸåž‹é“¾**ï¼š`{}.__proto__ = Person.prototype`ï¼›
3. å°†æž„é€ å‡½æ•°çš„ä½œç”¨åŸŸ **`this`** èµ‹ç»™æ–°å¯¹è±¡ `{}`ï¼›
4. æ‰§è¡Œæž„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼Œä¸º `{}` æ·»åŠ å±žæ€§ï¼š`Person.call(this)`ï¼›
5. å¦‚æžœæž„é€ å‡½æ•°æœ€ç»ˆä¼šè¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå°±è¿”å›ž **æž„é€ å‡½æ•°ä¸­çš„å¯¹è±¡**ã€‚
6. å¦‚æžœæž„é€ å‡½æ•°æ²¡æœ‰è¿”å›žå…¶ä»–å¯¹è±¡ï¼Œå°±ä¼šè¿”å›ž **æ–°å¯¹è±¡**ã€‚

æœ€ç»ˆï¼Œä»£ç ä¸­å·¦ä¾§çš„ `person1` å˜é‡æŽ¥æ”¶åˆ°äº†æ–°åˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡ã€‚



### å¼•å­2ï¼šåˆ†æžè§’åº¦

ä¸åŒç»§æ‰¿æ–¹æ³•çš„åŒºåˆ«ï¼Œä¸»è¦ä»Žä»¥ä¸‹å‡ ä¸ªè§’åº¦åˆ†æžï¼š

1. ç»§æ‰¿çš„ç±»åž‹ä¸»è¦æœ‰ 3 ç§ï¼šåŸºæœ¬æ•°æ®ç±»åž‹ã€å¼•ç”¨æ•°æ®ç±»åž‹ã€æ–¹æ³•ï¼›
2. å®žçŽ°ç»§æ‰¿çš„æ–¹å¼ä¸»è¦æœ‰ 3 ç§ï¼šåŽŸåž‹é“¾å¼ã€æž„é€ å‡½æ•°å¼ã€åŽŸåž‹å¼ã€‚
   é€šè¿‡è¿™ 3 ç§çš„ç›¸äº’å€Ÿé‰´ / å¼•ç”³ ï¼Œè¡ç”Ÿäº†ï¼š
   - ç»„åˆå¼ï¼ˆåŽŸåž‹é“¾ + æž„é€ å‡½æ•°ï¼‰ï¼›
   - å¯„ç”Ÿå¼ï¼ˆåŽŸåž‹å¼è¡ç”Ÿï¼‰ï¼›
   - å¯„ç”Ÿç»„åˆå¼ï¼ˆå¯„ç”Ÿ + åŽŸåž‹é“¾ + æž„é€ å‡½æ•°ï¼‰ã€‚
3. ç»§æ‰¿æ–¹æ³•çš„è®°å¿†é¡ºåºï¼šåŽŸåž‹é“¾ã€æž„é€ å‡½æ•°ã€åŽŸåž‹ã€ç»„åˆã€å¯„ç”Ÿã€å¯„ç”Ÿç»„åˆã€‚ä¸€å…±æœ‰ 6 ç§ã€‚



ä¸‹é¢ä»‹ç»çš„å„ç§ç»§æ‰¿å½¢å¼çš„æ•´ä½“æ¨¡åž‹ï¼Œå­ç±» Son åŽ»ç»§æ‰¿çˆ¶ç±» Fatherï¼š

çˆ¶ç±» `Father`ï¼š

- åŸºæœ¬å±žæ€§ï¼š`name`
- å¼•ç”¨å±žæ€§ï¼š`color`
- æ–¹æ³•ï¼š`sayName()`

å­ç±» `Son`ï¼š

- åŸºæœ¬å±žæ€§ï¼š`age`
- æ–¹æ³•ï¼š`sayAge()`

äº‹å®žä¸Šï¼Œæ²¡æœ‰å¿…è¦åŽ»åŒºåˆ†å¼•ç”¨å±žæ€§å’ŒåŸºæœ¬å±žæ€§ã€‚å¼•ç”¨å±žæ€§æ˜¯å¼•ç”¨ç±»åž‹ï¼Œä¿å­˜çš„æ˜¯ä¸€ä¸ªåœ°å€å€¼ï¼Œè¿™ä¸€ç‚¹å’Œç±»ä¸­çš„æ–¹æ³•ä¸€æ ·ã€‚ä¸Žæ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œé€šå¸¸å¼•ç”¨å±žæ€§ï¼ˆæ¯”å¦‚æ•°ç»„ï¼‰æ˜¯å®žä¾‹å±žæ€§ï¼Œè¦åœ¨å®žä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™åˆå§‹åŒ–ä¸€ä¸ªå®žä¾‹åŒ–å¯¹è±¡ç‹¬æœ‰çš„å±žæ€§ï¼›è€Œæ–¹æ³•åˆ™æ˜¯è¦é€šè¿‡åŽŸåž‹é“¾å…±äº«ï¼Œä¸ä¼šåœ¨å®žä¾‹åŒ–å¯¹è±¡ä¸­é‡æ–°å†åˆ›å»ºä¸€éã€‚



### å¼•å­3ï¼šå…¶ä»–æ¦‚å¿µ

#### 1. å¤šæ€

> çˆ¶ç±»çš„é€šç”¨è¡Œä¸ºï¼Œå¯ä»¥è¢«å­ç±»ç”¨æ›´ç‰¹æ®Šçš„è¡Œä¸ºé‡å†™ï¼Œè¿™å°±æ˜¯å¤šæ€ã€‚
>
> å®žé™…ä¸Šï¼Œç›¸å¯¹å¤šæ€æ€§å…è®¸æˆ‘ä»¬ä»Žé‡å†™è¡Œä¸ºä¸­å¼•ç”¨åŸºç¡€è¡Œä¸ºã€‚

æ‰€ä»¥ï¼Œå½“å­ç±»ä½¿ç”¨å’Œçˆ¶ç±»ç›¸åŒçš„åç§°å‘½åä¸€ä¸ªæ–°æ–¹æ³•æ—¶ï¼Œå°±å‘ç”Ÿäº†å¤šæ€ã€‚

- æ¯”å¦‚çˆ¶ç±»æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š`Person.prototype.callName()`ï¼Œå­ç±»æ‹¥æœ‰ä¸€ä¸ªç›¸åŒçš„æ–¹æ³•ï¼š`Student.prototype.callName()`ï¼Œå°±ä¼šå‘ç”Ÿè¦†ç›–ï¼Œè¿™å°±æ˜¯å¤šæ€ã€‚

#### 2. æž„é€ å‡½æ•°

ç±»çš„å®žä¾‹åŒ–æ˜¯é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ **æ–¹æ³•** æž„é€ çš„ï¼Œè¿™ä¸ªæ–¹æ³•çš„åç§°é€šå¸¸å’Œç±»åç›¸åŒï¼Œè¢«ç§°ä¸º **æž„é€ å‡½æ•°**ã€‚

æž„é€ å‡½æ•°çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯åˆå§‹åŒ–å®žä¾‹éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯å’ŒçŠ¶æ€ã€‚

#### 3. ç»§æ‰¿

å®šä¹‰å¥½ä¸€ä¸ªå­ç±»ä¹‹åŽï¼Œç›¸å¯¹äºŽçˆ¶ç±»æ¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹å¹¶ä¸”å®Œå…¨ä¸åŒçš„ç±»ã€‚

å­ç±»ä¼šåŒ…å«çˆ¶ç±»è¡Œä¸ºçš„åŽŸå§‹å‰¯æœ¬ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥é‡å†™æ‰€æœ‰ç»§æ‰¿çš„è¡Œä¸ºç”šè‡³å®šä¹‰æ–°çš„è¡Œä¸ºã€‚

#### 4. æ··å…¥ mixin

å®šä¹‰ï¼šæŠŠå¦ä¸€ä¸ªå¯¹è±¡ä¸­çš„éƒ¨åˆ†æ–¹æ³•å’Œå±žæ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œè¾¾åˆ°å¢žå¼ºç›®æ ‡å¯¹è±¡åŠŸèƒ½çš„æ•ˆæžœã€‚

æœ€å…¸åž‹çš„æ··å…¥ï¼Œå°±æ˜¯ `Object.assign(targetObj, ...sourcesObj)` æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šå°† source å¯¹è±¡é‡Œé¢çš„**å¯æžšä¸¾å±žæ€§**å¤åˆ¶åˆ°`targetObj`ã€‚å¦‚æžœå’Œ target å¯¹è±¡å·²æœ‰å±žæ€§é‡åï¼Œåˆ™ä¼šè¦†ç›–ã€‚åŒæ—¶åŽç»­çš„ sourceå¯¹è±¡ ä¼šè¦†ç›–å‰é¢çš„ source å¯¹è±¡çš„åŒåå±žæ€§ã€‚



### å¼•å­4ï¼šåŽŸåž‹å¯¹è±¡

ç±»ä¸­åŽŸåž‹å¯¹è±¡ä¸»è¦æœ‰ 3 ä¸ªä½œç”¨ï¼š

- é€šè¿‡åŽŸåž‹å¯¹è±¡çš„ `.constructor`ï¼Œè®©å®žä¾‹åŒ–å¯¹è±¡æ‰¾åˆ°æž„é€ å®ƒçš„å‡½æ•°ï¼›
- å®žä¾‹å¯¹è±¡å…¬ç”¨çš„æ–¹æ³•ï¼Œä¼šç»‘å®šåœ¨å®ƒçš„åŽŸåž‹å¯¹è±¡ä¸Šã€‚
- é€šè¿‡åŽŸåž‹å¯¹è±¡ï¼Œå½¢æˆä¸€æ¡æœ€ç»ˆé€šå‘ `Object.prototype` çš„å®Œæ•´åŽŸåž‹é“¾ï¼Œå®žçŽ°å…¶ä»–æ–¹æ³•çš„ç»§æ‰¿ã€‚



## 1 åŽŸåž‹é“¾ç»§æ‰¿

åŸºæœ¬æ€æƒ³ï¼šç»§æ‰¿çˆ¶ç±»çš„å±žæ€§å’Œæ–¹æ³•ï¼Œå…¨éƒ¨ä¾èµ–åŽŸåž‹é“¾å®žçŽ°ã€‚

æ ¸å¿ƒä»£ç ï¼š`Son.prototype = new Father();` 

1. å¾—åˆ°çˆ¶ç±»çš„å®žä¾‹åŒ–å¯¹è±¡ï¼Œ
2. æŠŠå­ç±»åŽŸåž‹å¯¹è±¡ä¿®æ”¹ä¸ºç¬¬ä¸€æ­¥å¾—åˆ°çš„å®žä¾‹åŒ–å¯¹è±¡ã€‚

Sonçš„åŽŸåž‹å¯¹è±¡ `Son.prototype` ä¸å†æ˜¯åŽŸé…ï¼Œè€Œå˜æˆ Fatherçš„å®žä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥æ­¤æ—¶ Son åŽŸåž‹å¯¹è±¡çš„æž„é€ å‡½æ•°å±žæ€§`Son.prototype.constructor`  ä¸¢å¤±ï¼Œéœ€è¦é‡æ–°ç»‘å®šã€‚

![æˆªå±2022-07-26 15.57.02](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2015.57.02.png)

ä¼˜ç‚¹ï¼š

- **æ–¹æ³•å¤ç”¨**ï¼Œçˆ¶ç±»çš„æ–¹æ³•ç»‘å®šåœ¨åŽŸåž‹é“¾ä¸Šï¼Œå¯ä»¥è¢«æ­£ç¡®çš„å¤ç”¨ã€‚

ç¼ºç‚¹ï¼š

- **å±žæ€§ä¸ç‹¬ç«‹**ï¼ŒåŽŸåž‹é“¾ç»§æ‰¿ï¼Œçˆ¶ç±»çš„å±žæ€§æ— æ³•å®žä¾‹åŒ–åˆ°å¯¹è±¡ä¸Šï¼Œè€Œæ˜¯å’Œæ–¹æ³•ä¸€æ ·è¢«å¤ç”¨ã€å…±ç”¨ã€‚
  1. **ä¸å¯åˆå§‹åŒ–**ã€‚å­ç±»å®žä¾‹å¯¹è±¡æ— æ³•å¯¹ç»§æ‰¿çš„çˆ¶ç±»å±žæ€§è¿›è¡Œåˆå§‹åŒ–ï¼Œåªèƒ½åˆå§‹åŒ–å­ç±»çš„å±žæ€§ã€‚
  2. **å†…å®¹ä¿®æ”¹**ã€‚å­ç±»å®žä¾‹å¯¹è±¡ï¼ˆinstance1 å’Œ instance2ï¼‰ä¼šæŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨å±žæ€§ï¼ˆå¦‚ arrayï¼‰ï¼Œè¿™å¯¼è‡´å¦‚æžœå…¶ä¸­ä¸€ä¸ªå®žä¾‹å¯¹è±¡å¯¹å¼•ç”¨å±žæ€§çš„ **å†…å®¹** è¿›è¡Œä¿®æ”¹ `instance1.color.push('pink')`ï¼Œinstance2 çš„ color ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚
  3. **æ˜¾å¼æ‰“å°**ã€‚ç»§æ‰¿çš„çˆ¶ç±»å±žæ€§ï¼Œæ— æ³•æ˜¾å¼é€šè¿‡ `console.log(instance1)` æ‰“å°å‡ºæ¥ã€‚
- å­ç±»åŽŸåž‹å¯¹è±¡çš„æž„é€ å‡½æ•°å±žæ€§ä¸¢å¤±ï¼Œéœ€è¦é‡æ–°ç»‘å®š `.constructor`ã€‚

```js
// çˆ¶ç±»æž„é€ å‡½æ•°ã€çˆ¶ç±»å±žæ€§
function Father() {
    this.name = "Moxy";
    this.color = ['red', 'yellow', 'black'];
}
// çˆ¶ç±»åŽŸåž‹ã€çˆ¶ç±»æ–¹æ³•
Father.prototype.sayName = function () {
    console.log(this.name);
};	

// å­ç±»æž„é€ å‡½æ•°ã€å­ç±»å±žæ€§
function Son(age) {
    this.age = age;
};
// å­ç±»åŽŸåž‹ã€ç»§æ‰¿çˆ¶ç±»å±žæ€§
Son.prototype = new Father();
// å­ç±»æ–¹æ³•
Son.prototype.sonFunc = function() {
	console.log("Son Function");
}

// å®žä¾‹åŒ–æµ‹è¯•ï¼š 
let instance1 = new Son("12");
let instance2 = new Son("18");
console.log(instance1.__proto__.color === instance2.__proto__.color) 
											// trueï¼Œçˆ¶ç±»å±žæ€§è¢«å­ç±»å®žä¾‹åŒ–å¯¹è±¡å…¬ç”¨
instance1.sayName(); 	// Moxyï¼Œæ–¹æ³•æˆåŠŸç»§æ‰¿


// å…³äºŽå…¬ç”¨å±žæ€§æµ‹è¯•ï¼š
instance1.color.push('pink');   // 4
instance2.color;      // ['red', 'yellow', 'black', 'pink'] å¯¹å¼•ç”¨å±žæ€§çš„æ“ä½œï¼Œä¸ä¼šå‘ç”Ÿèµ‹å€¼å±è”½

instance1.name = "ninjee"   // 'ninjee' å¯¹åŽŸåž‹é“¾ä¸Šçš„å±žæ€§ name èµ‹å€¼å±è”½ï¼Œ
instance2.name;       // 'Moxy' è€Œä¸æ˜¯ç›´æŽ¥ä¿®æ”¹åŽŸåž‹é“¾çš„åŽŸå±žæ€§å€¼

instance1.color = "hello world";  //'hello world' è¿™é‡Œå‘ç”Ÿäº†èµ‹å€¼å±è”½ã€‚
instance2.color;   // ['red', 'yellow', 'black', 'pink']
```



## 2 ç»å…¸ç»§æ‰¿ / å€Ÿç”¨æž„é€ å‡½æ•°

åŸºæœ¬æ€æƒ³ï¼šåœ¨å­ç±»çš„æž„é€ å‡½æ•°å†…ï¼Œè°ƒç”¨çˆ¶ç±»çš„æž„é€ å‡½æ•°ï¼Œä»Žè€Œå¼•å…¥çˆ¶ç±»çš„å±žæ€§å’Œæ–¹æ³•ã€‚

æ€»ä½“è¯„ä»·ï¼šæ€»ä½“æ¥è¯´ï¼Œç»å…¸ç»§æ‰¿å’ŒåŽŸåž‹é“¾ç»§æ‰¿çš„ä¼˜ç¼ºç‚¹æ˜¯ç›¸åçš„ã€‚ç»å…¸ç»§æ‰¿è§£å†³äº†åŽŸåž‹é“¾ç»§æ‰¿çš„ç¼ºç‚¹ï¼ŒåŽŸåž‹é“¾ç»§æ‰¿è§£å†³äº†ç»å…¸ç»§æ‰¿çš„ç¼ºç‚¹ã€‚åŒæ—¶ï¼Œçˆ¶ç±»çš„æ‰€æœ‰å±žæ€§ï¼ˆæ–¹æ³•ï¼‰ï¼Œå…¨éƒ¨é‡æ–°åˆ›å»ºåˆ°äº†å­ç±»ä¸­ã€‚

![æˆªå±2022-07-26 15.57.22](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2015.57.22.png)

ä¼˜ç‚¹ï¼š

- **å±žæ€§ç‹¬ç«‹**ï¼ŒåŽŸåž‹é“¾ä¸­å¼•ç”¨ç±»åž‹å€¼ç‹¬ç«‹ï¼Œä¸è¢«æ‰€æœ‰å®žä¾‹å…±äº«;
- **å¯ä¼ é€’å‚æ•°**ï¼Œå­ç±»åž‹åˆ›å»ºæ—¶ä¹Ÿèƒ½å¤Ÿå‘çˆ¶ç±»åž‹ä¼ é€’å‚æ•°ï¼Œç”¨äºŽä¸åŒå®žä¾‹å±žæ€§å€¼çš„åˆå§‹åŒ–ã€‚

Ã¥ç¼ºç‚¹ï¼š

- **æ–¹æ³•æ— æ³•å¤ç”¨ã€‚**
  - è¦ç»§æ‰¿çš„æ–¹æ³•å¿…é¡»åœ¨çˆ¶ç±»çš„æž„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œè°ƒç”¨çˆ¶ç±»æž„é€ å‡½æ•°åŽï¼Œå®žä¾‹åŒ–å¯¹è±¡å†…éƒ¨ä¹Ÿåˆ›å»ºäº†å¯¹åº”çš„æ–¹æ³•ï¼Œæ²¡æœ‰å¤ç”¨å‡½æ•°ã€‚
  - çˆ¶ç±»å®šä¹‰çš„æ–¹æ³•ï¼ˆä¸åœ¨æž„é€ å‡½æ•°å†…éƒ¨çš„ï¼‰ï¼Œå¯¹å­ç±»ä¸å¯è§ï¼Œå› ä¸ºæ­¤å¤„ **æ²¡æœ‰æ¶‰åŠåˆ°åŽŸåž‹é“¾**ã€‚

```js
function Father(name){
  this.name = name;
	this.colors = ["red","blue","green"];
}
function Son(name){
	Father.call(this, arguments);  //ç»§æ‰¿äº†Father,ä¸”å‘çˆ¶ç±»åž‹ä¼ é€’å‚æ•°
}

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy");
let instance2 = new Son("Ninjee");

instance1.colors.push("black");
console.log(instance1.colors);  //"red,blue,green,black"
console.log(instance2.colors);  //"red,blue,green" å¼•ç”¨ç±»åž‹å€¼æ˜¯ç‹¬ç«‹çš„
```

### å°æ€»ç»“ï¼š

åŽŸåž‹é“¾ç»§æ‰¿å’Œå€Ÿç”¨æž„é€ å‡½æ•°ç»§æ‰¿ï¼Œå®Œå…¨åˆ°äº†ä¸¤ç§ä¸åŒçš„æ€è·¯ï¼Œä¼˜ç¼ºç‚¹å‡ ä¹Žå¯ä»¥è®¤ä¸ºæ˜¯äº’æ–¥çš„ï¼š

åŽŸåž‹é“¾ç»§æ‰¿è§£å†³äº†çˆ¶ç±» **æ–¹æ³•å¤ç”¨** çš„é—®é¢˜ï¼Œå‡ºçŽ°äº†çˆ¶ç±» **å±žæ€§ä¸ç‹¬ç«‹** çš„é—®é¢˜ã€‚

å€Ÿç”¨æž„é€ å‡½æ•°è§£å†³äº†çˆ¶ç±» **å±žæ€§ç‹¬ç«‹** çš„é—®é¢˜å‡ºçŽ°äº†çˆ¶ç±» **æ–¹æ³•æ— æ³•å¤ç”¨** çš„é—®é¢˜ã€‚

- å°¤å…¶æ³¨æ„ï¼šå¼•ç”¨æ•°æ®ç±»åž‹çš„å¤ç”¨é—®é¢˜ã€‚



æ ¸å¿ƒï¼šæž„é€ å‡½æ•°å†…éƒ¨ï¼Œåªé€‚ç”¨äºŽå­˜æ”¾æœªæ¥ä¼šå®žä¾‹åŒ–çš„å±žæ€§ï¼›åŽŸåž‹é“¾ï¼Œåªé€‚ç”¨äºŽç»‘å®šå¤ç”¨çš„æ–¹æ³•ã€‚



## 3 ç»„åˆç»§æ‰¿

æ€»ä½“è¯„ä»·ï¼šåŽŸåž‹é“¾ + ç»å…¸ç»§æ‰¿ã€‚JavaScript ä¸­ **æœ€å¸¸ç”¨** çš„ç»§æ‰¿æ¨¡å¼ã€‚

åŸºæœ¬æ€æƒ³ï¼š

1. åˆ©ç”¨æž„é€ å‡½æ•°ï¼šå­ç±»å€Ÿç”¨æž„é€ å‡½æ•°ï¼Œæ¥å®žçŽ°å¯¹çˆ¶ç±»å±žæ€§çš„ç»§æ‰¿ã€‚

   `Father.call(this,name); `

2. åˆ©ç”¨åŽŸåž‹é“¾ï¼šå­ç±»åŽŸåž‹æŒ‡å‘å®žä¾‹åŒ–çš„çˆ¶ç±»ï¼Œæ¥å®žçŽ°å¯¹çˆ¶ç±»æ–¹æ³•çš„ç»§æ‰¿ã€‚
   `Son.prototype = new Father();`

![æˆªå±2022-07-26 15.57.38](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2015.57.38.png)

ä¼˜ç‚¹

é¿å…äº†åŽŸåž‹é“¾å’Œå€Ÿç”¨æž„é€ å‡½æ•°çš„å„è‡ªçš„ç¼ºé™·ï¼Œèžåˆäº†å®ƒä»¬çš„ä¼˜ç‚¹ã€‚

1. åŽŸåž‹é“¾ä¼˜ç‚¹ï¼šçˆ¶ç±»çš„æ–¹æ³•å¾—åˆ°äº†å¤ç”¨ï¼›

2. æž„é€ å‡½æ•°ä¼˜ç‚¹ï¼šçˆ¶ç±»å±žæ€§éƒ½å¯ä»¥é‡å®šä¹‰åœ¨å®žä¾‹åŒ–å¯¹è±¡ä¸­ã€‚

3. æ­¤å¤–ï¼Œ`instanceof` å’Œ `isPrototypeOf( )` å¯æ­£ç¡®ä½¿ç”¨ï¼Œè¡¨æ˜Žå®žä¾‹åŒ–å¯¹è±¡çš„ç±»åž‹ã€‚

ç¼ºç‚¹ï¼š

**é¢å¤–çš„å¼€é”€**ã€‚åœ¨å®šä¹‰å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³•çš„æ—¶å€™ï¼Œç›´æŽ¥è°ƒç”¨ `Son.prototype = new Father()` è¿™é€ æˆäº†ä¸¤ä¸ªåŽæžœï¼š

1. é¢å¤–è°ƒç”¨äº† 1 æ¬¡ `Father()`ï¼Œé€ æˆäº†é¢å¤–çš„å¼€é”€ã€‚å¦‚æžœæœ‰å®žä¾‹åŒ– n ä¸ªå¯¹è±¡ï¼Œä¸€å…±è°ƒç”¨äº† 1 + n æ¬¡ã€‚
2. `new Father()` é™„å¸¦äº†çˆ¶ç±»æž„é€ å‡½æ•°çš„å±žæ€§ï¼Œè¿™äº›å±žæ€§ä¹Ÿç»‘å®šåœ¨äº† `Son.prototype` å­ç±»åŽŸåž‹ä¸Šï¼Œå¤šäº†é¢å¤–æ— ç”¨çš„å˜é‡ã€‚
3. Son çš„æ–°åŽŸåž‹å¯¹è±¡ï¼ˆFather å®žä¾‹å¯¹è±¡ï¼‰ï¼Œéœ€è¦é‡æ–°æŒ‡å‘`.constructor`ã€‚

```js
// çˆ¶ç±»æž„é€ å‡½æ•°ã€çˆ¶ç±»å±žæ€§
function Father(name){
	this.name = name;
	this.colors = ["red","blue","green"];
}
// çˆ¶ç±»åŽŸåž‹ã€çˆ¶ç±»æ–¹æ³•
Father.prototype.sayName = function(){
	console.log(this.name);
};

// å­ç±»æž„é€ å‡½æ•°ã€å­ç±»å±žæ€§ã€ç»§æ‰¿çˆ¶ç±»å±žæ€§
function Son(name,age){
	Father.call(this,name);   //ç»§æ‰¿çˆ¶ç±»å±žæ€§ã€‚å®žä¾‹åŒ–1æ¬¡ï¼Œå°±è°ƒç”¨1æ¬¡Father()
	this.age = age;
}
// å­ç±»åŽŸåž‹ã€ç»§æ‰¿çˆ¶ç±»æ–¹æ³•
Son.prototype = new Father(); //åªåœ¨å®šä¹‰å­ç±»æ—¶ï¼Œè°ƒç”¨1æ¬¡Father()
Son.prototype.sayAge = function(){
	console.log(this.age);
}


// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy",16);
let instance2 = new Son("Ninjee",26);
instance1.colors.push("black");

instance1  // SonÂ {name: "Moxy", colors: Array(4), age: 16}
instance2  // SonÂ {name: "Ninjee", colors: Array(3), age: 26}
```



## 4 åŽŸåž‹å¼ç»§æ‰¿

åœºæ™¯ï¼šå½“ä½ æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œæƒ³åœ¨å®ƒçš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œç„¶åŽå†å¯¹æ–°å¯¹è±¡è¿›è¡Œé€‚å½“çš„ä¿®æ”¹ï¼Œä½¿ç”¨æ­¤æ–¹å¼ç»§æ‰¿ã€‚

åŸºæœ¬æ€æƒ³ï¼šåˆ©ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ `object()` æ–¹æ³•ï¼Œå°†æ—§å¯¹è±¡ï¼ˆçˆ¶å¯¹è±¡ï¼‰ç»‘å®šåˆ°å®žä¾‹åŒ–å¯¹è±¡ï¼ˆå­å¯¹è±¡ï¼‰ä¸­ã€‚è¿™é‡Œæ²¡æœ‰äº†çˆ¶ç±»å’Œå­ç±»çš„æ¦‚å¿µï¼Œè€Œæ˜¯åªæœ‰çˆ¶å¯¹è±¡å’Œå­å¯¹è±¡ã€‚



#### å½¢å¼ä¸€ï¼šè‡ªå®šä¹‰ `object()`ï¼›

1. åˆ›å»ºä¸€ä¸ªç©ºçš„å­ç±»æž„é€ å‡½æ•° `Son`ï¼›
2. æŠŠè¦å®šä¹‰çš„çˆ¶ç±»å¯¹è±¡å’Œæ–¹æ³•ï¼Œç»‘å®šåœ¨å­ç±»åŽŸåž‹çš„åŽŸåž‹é“¾ä¸Šã€‚
3. è°ƒç”¨å­ç±»æž„é€ å‡½æ•°ï¼Œå®žä¾‹åŒ–å¯¹è±¡ã€‚
4. è¿”å›žå®žä¾‹åŒ–çš„å¯¹è±¡ã€‚

![æˆªå±2022-07-26 15.58.12](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2015.58.12.png)

ä¼˜ç‚¹ï¼š

1. å¼±åŒ–äº†å­ç±»å’Œçˆ¶ç±»çš„æ¦‚å¿µï¼Œåªæ˜¯æŠŠ"å­ç±»"çš„æž„é€ å‡½æ•°å½“ä½œä¸€ä¸ªå£³å­ï¼Œç”¨äºŽæŠŠåŽŸæœ‰å¯¹è±¡ç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šï¼Œç›¸å½“äºŽï¼š`son1.__proto__` æŒ‡å‘ `father`ã€‚
2. å³ä½¿ä¸è‡ªå®šä¹‰ç±»åž‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŽŸåž‹å®žçŽ°å¯¹è±¡ä¹‹é—´çš„å±žæ€§ã€æ–¹æ³•å…±äº«ï¼Œå°±åƒä½¿ç”¨åŽŸåž‹æ¨¡å¼ä¸€æ ·ã€‚
3. æ¢å¥è¯è¯´ï¼Œå¦‚æžœä½ æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œæƒ³åœ¨å®ƒçš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚åˆ™åˆ©ç”¨ `object()` ä¾¿å¯ä»¥å®žçŽ°ã€‚

ç¼ºç‚¹ï¼š

1. **å±žæ€§å’Œæ–¹æ³•å…¨éƒ¨å…±ç”¨**ã€‚è¿™å…¶å®žç›¸å½“äºŽæŠŠåŽŸæœ‰å¯¹è±¡ï¼ˆä»£ç ä¸­çš„ `father`ï¼‰çš„å…¨éƒ¨å±žæ€§å’Œæ–¹æ³•ï¼Œå…¨ç»‘å®šåˆ°å®žä¾‹åŒ–å¯¹è±¡çš„ **åŽŸåž‹é“¾** ä¸Šã€‚è¿™å¯¼è‡´æ‰€æœ‰å®žä¾‹åŒ–å¯¹è±¡ï¼ˆ`son1`, `son2`ï¼‰éƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œè€Œä¸”å±žæ€§å’Œæ–¹æ³•å…¨éƒ¨å…±ç”¨ã€‚
2. çˆ¶å¯¹è±¡çš„æ–¹æ³•ã€å±žæ€§åŽŸå°ä¸åŠ¨çš„ç…§æ¬ã€‚æ— æ³•åœ¨å®žä¾‹åŒ–å­å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºæ–°çš„å±žæ€§å’Œæ–¹æ³•ï¼ˆ`object` ä¸­ï¼Œå­å¯¹è±¡çš„æž„é€ å‡½æ•°æ˜¯ç©ºçš„ï¼‰ã€‚

```js
// å½¢å¼ä¸€ï¼šè‡ªå®šä¹‰object()
function object(obj) {
    function Son() {}
    Son.prototype = obj;
    return new Son();
}

// or ES6
function object2(obj) {
		const son = {};	
  	Object.setPrototypeOf(son, obj);
  	return son;
}

// or ES5
// Object.create(obj) å°±æ˜¯è§„èŒƒåŒ–äº†çš„ object å‡½æ•°ï¼Œç›´æŽ¥ä½¿ç”¨

// å®šä¹‰çˆ¶å¯¹è±¡ï¼ˆæ— æž„é€ å‡½æ•°ã€æ— åŽŸåž‹é“¾ï¼‰
const father = {
    name: "Moxy",
    colors: ["red", "blue", "green"],
    sayName: function () {
        console.log(this.name)
    }
};

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
const son1 = object(father);
const son2 = object(father);
son1.colors.push("black");
son2.colors.push("pink");
console.log(father.colors); //(5)Â ["red", "blue", "green", "black", "pink"]
```



#### å½¢å¼äºŒï¼šES5 çš„æ–¹æ³• `object.create()`

åœ¨ ECMAScript5 ä¸­,é€šè¿‡æ–°å¢ž `object.create()` æ–¹æ³•è§„èŒƒåŒ–äº†ä¸Šé¢çš„åŽŸåž‹å¼ç»§æ‰¿ï¼Œåœ¨å®žçŽ°åŽŸç†ä¸Šæ˜¯ä¸€æ‘¸ä¸€æ ·çš„ã€‚



`object.create()` ä¼šè¿”å›žä¸€ä¸ªç»‘å®šå¥½åŽŸåž‹é“¾çš„æ–°å¯¹è±¡ï¼Œå¯ä»¥æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š

1. ä¸€ä¸ªå¯¹è±¡ï¼šæ–°å¯¹è±¡åŽŸåž‹é“¾æŒ‡å‘çš„å¯¹è±¡ï¼›

2. ä¸€ä¸ªå¯¹è±¡ï¼ˆå¯é€‰ï¼‰ï¼šä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±žæ€§ã€‚


- ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸Ž `Object.defineProperties()` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ ¼å¼ç›¸åŒ: 
  1. æ¯ä¸ªå±žæ€§éƒ½æ˜¯é€šè¿‡è‡ªå·±çš„æè¿°ç¬¦å®šä¹‰çš„ï¼›
  2. ä»¥è¿™ç§æ–¹å¼æŒ‡å®šçš„ **ä»»ä½•å±žæ€§** éƒ½ä¼šè¦†ç›–åŽŸåž‹å¯¹è±¡ä¸Šçš„åŒåå±žæ€§ã€‚

![æˆªå±2022-07-26 16.22.07](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2016.22.07.png)

ä¼˜ç‚¹ï¼š

1. è§„èŒƒäº†å½¢å¼ä¸€ï¼ˆå¼•å­ï¼‰ï¼Œè¿™é‡Œé¢å¤–å¢žåŠ äº†ç±»ä¸Žç±»ä¹‹é—´çš„å…³ç³»ã€‚
2. å®žä¾‹å±žæ€§å’Œå…±ç”¨æ–¹æ³•éƒ½å¯ä»¥æ­£ç¡®çš„è¢«å®šä¹‰ï¼šçˆ¶ç±»çš„æ–¹æ³•å¯ä»¥è¢«å­ç±»å¤ç”¨ï¼Œçˆ¶ç±»çš„å®žä¾‹å±žæ€§å­ç±»å¯ä»¥å•ç‹¬åˆ›å»ºå‡ºæ¥ã€‚

ç¼ºç‚¹ï¼šè°ƒç”¨ `Student.prototype = Object.create(Person.prototype)` ï¼š

- `Object.create()` ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŽŸæœ‰çš„ Student åŽŸåž‹å¯¹è±¡è¢«æ›¿æ¢æŽ‰äº†ã€‚è¿™å¯¼è‡´ 3 ä¸ªé—®é¢˜ï¼š
  1. **`.constructor` ä¸¢å¤±** ï¼Œå­ç±»æ–°çš„åŽŸåž‹å¯¹è±¡çš„ `.constructor` å±žæ€§éœ€è¦é‡æ–°æŒ‡å‘å…¶æž„é€ å‡½æ•°ã€‚
  2. **å­ç±»æ–¹æ³•é¡ºåº** ï¼Œéœ€è¦å…ˆæ›¿æ¢å­ç±»çš„åŽŸåž‹å¯¹è±¡ `Student.prototype` ï¼ŒåŽåœ¨æ–°åŽŸåž‹å¯¹è±¡ä¸Šå®šä¹‰å­ç±»çš„å…¬æœ‰æ–¹æ³•ã€‚
  3. **æ€§èƒ½æŸå¤±**ã€‚å­ç±»çš„æ—§åŽŸåž‹å¯¹è±¡æ²¡æœ‰å®žé™…ç”¨å¤„ï¼Œå‡ºç”Ÿå°±è¢«å¼ƒç”¨ï¼Œé€ æˆé¢å¤–çš„å†…å­˜å’Œä»»åŠ¡å¼€é”€ã€‚

```js
// å®šä¹‰çˆ¶ç±»ï¼šå®žä¾‹å±žæ€§ + å…¬æœ‰æ–¹æ³•
function Father(name) {
    this.name = name
    this.colors = ["red", "blue", "green"]
}
Father.prototype.printName = function () {
    console.log(this.name)
}

// å®šä¹‰å­ç±»ï¼šå®žä¾‹å±žæ€§
function Son(name, age) {
    Father.call(this, name)
    this.age = age
};
// æ–¹æ³•äºŒï¼šåŽŸåž‹å¼ç»§æ‰¿ã€‚å­ç±»é‡æ–°åˆ›å»ºä¸€ä¸ªåŽŸåž‹å¯¹è±¡ï¼Œç„¶åŽæ¢å¤constructorçš„æ­£ç¡®æŒ‡å‘ã€‚
Son.prototype = Object.create(Father.prototype);
Son.prototype.constructor = Son;

// å®šä¹‰å­ç±»ï¼šå…¬æœ‰æ–¹æ³•ï¼Œåªæœ‰åœ¨æ›´æ¢äº†åŽŸåž‹å¯¹è±¡åŽï¼Œå­ç±»æ‰èƒ½å®šä¹‰å…¬æœ‰æ–¹æ³•
Son.prototype.printAge = function () {
    console.log(this.age)
}

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 99);	// SonÂ {name: "Moxy", colors: Array(3), age: 99}
let instance2 = new Son("Ninjee", 5);	// SonÂ {name: "Ninjee", colors: Array(3), age: 5}
instance1.printName === instance2.printName // true
Son.prototype.__proto__ === Father.prototype  // true
```



#### å½¢å¼ä¸‰ï¼šES6 æ–¹æ³•ï¼š`Object.setPrototypeOf(Son, Father)`

**ðŸŒŸæœ€ä½³å®žè·µ**ï¼šè¯¥æ–¹æ³•æ˜¯ ES6çš„æœ€ä½³å®žè·µï¼Œä¹Ÿæ˜¯å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ã€‚

æ­£å› ä¸º ES5 `Object.create()` ä¼šæœ‰é‡æ–°å®šä¹‰å­ç±»åŽŸåž‹å¯¹è±¡çš„é—®é¢˜ã€‚æ‰€ä»¥ ES6 çš„æ–°æ–¹æ³• `Object.setPrototypeOf(Son.prototype, Father.prototype)` åº”è¿è€Œç”Ÿã€‚

å®ƒçš„å®žé™…ä½œç”¨å°±æ˜¯ï¼š`Son.prototype.__proto__ == Father.prototype`

- ä¸ºä»€ä¹ˆä¸ç›´æŽ¥ä½¿ç”¨ `__proto__` å±žæ€§å‘¢ï¼Ÿå› ä¸ºç›´æŽ¥ä½¿ç”¨ `__proto__` ä¸å®‰å…¨ï¼Œå®ƒä¸æ˜¯ JS å®˜æ–¹æ ‡å‡†ï¼Œè€Œæ˜¯ä¸»æµæµè§ˆå™¨ä¸ºäº†æ–¹ä¾¿åŽ»å®šä¹‰çš„ä¸€ä¸ªå±žæ€§ã€‚è¿™ä¸ªå±žæ€§å¹¶ä¸èƒ½å®Œå…¨çš„å…¼å®¹æ‰€æœ‰æµè§ˆå™¨ç­‰å…¶ä»–çŽ¯å¢ƒã€‚

![æˆªå±2022-07-26 16.25.18](images/09-%E7%BB%A7%E6%89%BF.assets/%E6%88%AA%E5%B1%8F2022-07-26%2016.25.18.png)

ä¼˜ç‚¹ï¼šè§£å†³ä¸Šå½¢å¼äºŒçš„ 3 ä¸ªç¼ºç‚¹ã€‚

1. æ²¡æœ‰ `Object.Object()` çš„æ€§èƒ½æŸå¤±ã€‚å› ä¸ºä¸éœ€è¦æŠ›å¼ƒå­ç±»çš„æ—§åŽŸåž‹å¯¹è±¡ï¼Œè€Œä¸ä¼šå¯¼è‡´åžƒåœ¾å›žæ”¶ï¼›
2. æ²¡æœ‰ `Object.Object()` çš„æ··ä¹±ä»£ç é¡ºåºå’Œ `.constroctor` çš„é‡å®šå‘é—®é¢˜ã€‚

ç¼ºç‚¹ï¼š

1. çœŸçœ‹ä¸å‡ºæœ‰ä»€ä¹ˆç¼ºç‚¹ã€‚å¯èƒ½æœ€é‡è¦çš„ç¼ºç‚¹å°±æ˜¯ï¼Œè¯¥æ–¹æ³•æ˜¯ ES6 æ–¹æ³•ï¼Œéœ€è¦ JS æ”¯æŒ ES6 çŽ¯å¢ƒã€‚

```js
// å®šä¹‰çˆ¶ç±»ï¼šå®žä¾‹å±žæ€§ + å…¬æœ‰æ–¹æ³•
function Father(name) {
    this.name = name
    this.colors = ["red", "blue", "green"]
}
Father.prototype.printName = function () {
    console.log(this.name)
}

// å®šä¹‰å­ç±»ï¼šå®žä¾‹å±žæ€§ + å…¬æœ‰æ–¹æ³•ã€‚çŽ°åœ¨å…¬æœ‰æ–¹æ³•å¯ä»¥ç´§æŽ¥ç€å®žä¾‹å±žæ€§åŽ»å®šä¹‰äº†
function Son(name, age) {
    Father.call(this, name)
    this.age = age
};
Son.prototype.printAge = function () {
    console.log(this.age)
}
// æ–¹æ³•ä¸‰ï¼šåŽŸåž‹å¼ç»§æ‰¿ã€‚ä½¿ç”¨ES6æ–¹æ³•ï¼Œ
Object.setPrototypeOf(Son.prototype, Father.prototype)

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 99);	// SonÂ {name: "Moxy", colors: Array(3), age: 99}
let instance2 = new Son("Ninjee", 5);	// SonÂ {name: "Ninjee", colors: Array(3), age: 5}
instance1.printName === instance2.printName // true
Son.prototype.__proto__ === Father.prototype  // true
```



## 5 å¯„ç”Ÿå¼ç»§æ‰¿

åŸºæœ¬æ€æƒ³ï¼š

1. â€œå¯„â€ï¼šåˆ©ç”¨åŽŸåž‹å¼ï¼Œåœ¨æœ‰ä¸€ä¸ªå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œåˆ›å»ºå‡ºå­å¯¹è±¡ã€‚è®©å­å¯¹è±¡é€šè¿‡åŽŸåž‹é“¾ç»§æ‰¿çˆ¶å¯¹è±¡çš„å…¨éƒ¨å±žæ€§å’Œæ–¹æ³•ã€‚
2. â€œç”Ÿâ€ï¼šå¢žå¼ºå­å¯¹è±¡ï¼Œä¸ºå­å¯¹è±¡åˆ›å»ºè‡ªå·±çš„å±žæ€§å’Œæ–¹æ³•ã€‚



ä¼˜ç‚¹ï¼š

1. åŽŸåž‹å¼ç»§æ‰¿çš„å…¨éƒ¨ä¼˜ç‚¹ï¼šä¸å®šä¹‰ç±»åž‹ï¼Œä¾¿å¯ä»¥é€šè¿‡åŽŸåž‹å®žçŽ°å¯¹è±¡ä¹‹é—´çš„å±žæ€§ã€æ–¹æ³•å…±äº«ã€‚
2. é¿å…äº†åŽŸåž‹å¼ç»§æ‰¿çš„ç¬¬äºŒä¸ªç¼ºç‚¹ã€‚å¯„ç”Ÿå¼ç»§æ‰¿å¯ä»¥åœ¨å®žä¾‹åŒ–å­å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºæ–°çš„å±žæ€§å’Œæ–¹æ³•ã€‚

ç¼ºç‚¹ï¼š

1. çˆ¶ç±»çš„å±žæ€§å’Œæ–¹æ³•å…¨éƒ¨å¤ç”¨ã€‚
1. å­ç±»çš„å±žæ€§æ— æ³•åœ¨åˆ›å»ºæ—¶åˆå§‹åŒ–

```js
// å½¢å¼äºŒï¼šè‡ªå®šä¹‰object()
function object(obj) {
    function Son() {}
    Son.prototype = obj;
    return new Son();
}

// å®šä¹‰çˆ¶å¯¹è±¡ï¼ˆæ— æž„é€ å‡½æ•°ã€æ— åŽŸåž‹é“¾ï¼‰
const father = {
    name: "Moxy",
    colors: ["red", "blue", "green"],
    sayName: function () {
        console.log(this.name)
    }
};

// ã€å·¥åŽ‚å‡½æ•°ã€‘å¢žå¼ºå­å¯¹è±¡ã€ä¸ºå­å¯¹è±¡æ·»åŠ è‡ªå·±çš„æ–¹æ³•
function createSon(original, age) {
    // å½¢å¼ä¸€ï¼šES5çš„Object.create()
    // const Son = Object.create(original);
  
    const son = object(original);
    // ã€å¯„ç”Ÿã€‘å¢žå¼ºå¯¹è±¡ï¼Œæ·»åŠ å±žäºŽè‡ªå·±çš„å±žæ€§+æ–¹æ³•
  	son.age = age;
    son.sayHi = function () {
        console.log('hi')
    };
    return son
}

/// å®žä¾‹åŒ–æµ‹è¯•
const son1 = createSon(father, 12);
const son2 = createSon(father, 18);
son1  // SonÂ {age: 12, sayHi: Æ’}
son2  // SonÂ {age: 18, sayHi: Æ’}
son1.colors.push("black");
son2.colors.push("pink");
console.log(father.colors); // (5)Â ["red", "blue", "green", "black", "pink"]

son1 // SonÂ {sayHi: Æ’}
```



### å°æ€»ç»“

**æ€»ç»“1ï¼š**åŽŸåž‹å¼ç»§æ‰¿ã€å¯„ç”Ÿå¼ç»§æ‰¿å’Œæµ…æ‹·è´å¯¹è±¡ï¼š

é—®é¢˜ï¼šä¸Šæ–‡è¯´è¿‡ï¼ŒåŽŸåž‹å¼ç»§æ‰¿çš„ä¼˜ç‚¹æ˜¯å³ä½¿ä¸è‡ªå®šä¹‰ç±»åž‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŽŸåž‹å®žçŽ°å¯¹è±¡ä¹‹é—´çš„å±žæ€§ã€æ–¹æ³•å…±äº«ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ–°å¯¹è±¡ç›´æŽ¥æµ…æ‹·è´åŽŸå¯¹è±¡ï¼Œç„¶åŽåœ¨ç»™è‡ªå·±æ·»åŠ é¢å¤–çš„æ–¹æ³•ï¼Œä¸ä¹Ÿå®žçŽ°äº†å±žæ€§å’Œæ–¹æ³•çš„å…±äº«å—ï¼Ÿ

è§£ç­”ï¼šæµ…æ‹·è´ä¸æ˜¯ â€œåŠ¨æ€çš„â€ã€‚æ–°å¯¹è±¡é€šè¿‡åŽŸåž‹å¼ç»§æ‰¿ï¼ŒèŽ·å¾—äº†æ—§å¯¹è±¡çš„å…¨éƒ¨å±žæ€§å’Œæ–¹æ³•ï¼Œå¦‚æžœæ­¤åŽæ—§å¯¹è±¡çš„å±žæ€§å’Œæ–¹æ³•å‘ç”Ÿå˜åŠ¨ï¼Œå› ä¸ºåŽŸåž‹é“¾çš„å…³ç³»ï¼Œæ–°å¯¹è±¡ç»§æ‰¿çš„å±žæ€§å’Œæ–¹æ³•ä¹Ÿä¼š â€œåŠ¨æ€â€ çš„å‘ç”Ÿå˜åŠ¨ã€‚è€Œå•çº¯çš„æµ…æ‹·è´æ˜¯é™æ€çš„ï¼Œæ—§å¯¹è±¡çš„åŸºæœ¬æ•°æ®å±žæ€§å‘ç”Ÿå˜åŠ¨ï¼Œæ–°å¯¹è±¡ä¸ä¼šæ›´æ–°ã€‚ï¼ˆæ—§å¯¹è±¡çš„å¼•ç”¨æ•°æ®æºç±»åž‹å’Œæ–¹æ³•éƒ½æ˜¯åœ°å€å€¼ä¼ é€’ï¼Œæ–°å¯¹è±¡ä¹Ÿä¼šå¾—åˆ°æ›´æ–°ï¼‰



**æ€»ç»“ 2ï¼š**åŽŸåž‹å¼ç»§æ‰¿å’Œå¯„ç”Ÿå¼ç»§æ‰¿çš„åŒºåˆ«ï¼š

åŽŸåž‹å¼ç»§æ‰¿ï¼šåŸºäºŽå·²æœ‰çš„å¯¹è±¡ï¼ˆåŽŸåž‹å¯¹è±¡ï¼‰åˆ›å»ºæ–°å¯¹è±¡

- åŽŸåž‹å¼ç»§æ‰¿å®žçŽ°äº† `Object.create()` çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›

å¯„ç”Ÿå¼ç»§æ‰¿ï¼šåˆ›å»ºä¸€ä¸ªç”¨äºŽå°è£…ç»§æ‰¿è¿‡ç¨‹çš„å‡½æ•°ã€‚å‡½æ•°å†…éƒ¨ä¸ä»…å®žçŽ°äº† â€åŸºäºŽå·²æœ‰çš„å¯¹è±¡ï¼ˆåŽŸåž‹å¯¹è±¡ï¼‰åˆ›å»ºæ–°å¯¹è±¡â€œ çš„åŽŸåž‹å¼ç»§æ‰¿ï¼Œä¹Ÿå®žçŽ°äº†å¯¹æ–°å¯¹è±¡çš„å¢žå¼ºï¼Œæ·»åŠ æ›´å¤šå±žæ€§å’Œæ–¹æ³•

- å¯„ç”Ÿå¼ç»§æ‰¿å®žçŽ°äº†`Object.create()` çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ï¼›



## 6 å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

å¯„ç”Ÿç»„åˆå¼çš„æœ¬è´¨åŽŸç†å°±æ˜¯åŽŸåž‹å¼ç»§æ‰¿ï¼Œåªæ˜¯æŠŠåŽŸåž‹å¼ç»§æ‰¿çš„å¤šè¡Œä»£ç ï¼Œé€šè¿‡ `inheritPrototype` ðŸ“¦ å°è£…èµ·æ¥ï¼Œæ›´ç®€æ´äº†ã€‚

```js
// ã€ðŸ“¦ã€‘ä¸­é—´å‡½æ•°ã€ä¼ å…¥å­ç±»ã€çˆ¶ç±»ä¸¤ä¸ªæž„é€ å‡½æ•°
function inheritPrototype(Sub, Super) {
//é‡å®šä¹‰ä¸€ä¸ª[å­ç±»åŽŸåž‹å¯¹è±¡]subPrototypeï¼Œæ­¤æ—¶æœ‰__proto__å’Œconstructorä¸¤ä¸ªå±žæ€§ï¼Œå³ï¼š
    //Sub.prototype.__proto__ æŒ‡å‘ Super.prototype çˆ¶ç±»åŽŸåž‹å¯¹è±¡
    //Sub.prototype.constructor æŒ‡å‘ Sub å­ç±»æž„é€ å‡½æ•°
  // è¿™é‡Œä½¿ç”¨äº†çŽ°æˆçš„Object.createï¼Œæœ€åŽŸå§‹åº”è¯¥æ˜¯è‡ªå®šä¹‰çš„3è¡Œobjectå‡½æ•°
	  Sub.prototype = Object.create(Super.prototype);
    Sub.prototype.constructor = Sub;
}

// çˆ¶ç±»æž„é€ å‡½æ•°ï¼šå±žæ€§+æ–¹æ³•
function Father(name) {
    this.name = name;
    this.color = ["red", "green", "blue"];
}
Father.prototype.sayName = function () {
    console.log(this.name);
}

// å­ç±»æž„é€ å‡½æ•°ï¼šç»§æ‰¿çˆ¶ç±»å±žæ€§+å­ç±»å±žæ€§
function Son(name, age) {
    Father.call(this, name); // åªè°ƒç”¨ä¸€æ¬¡çˆ¶ç±»æž„é€ æ–¹æ³•
    this.age = age;
}

// å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³•
inheritPrototype(Son, Father);
// or æ–¹æ³•ä¸‰ï¼šåŽŸåž‹å¼ç»§æ‰¿ã€‚ä½¿ç”¨ES6æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰é¡ºåºè§„å®š
// Object.setPrototypeOf(Son.prototype, Father.prototype)

// å­ç±»æ–¹æ³•ï¼Œåœ¨Son.prototypeè¢«æ­£ç¡®å®šä¹‰åŽæ‰èƒ½æ·»åŠ 
Son.prototype.sayAge = function () {
    console.log(this.age);
}

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 18)
let instance2 = new Son("Ninjee", 28)
instance1.color.push("pink")
console.log(instance1.color) // (4)Â ["red", "green", "blue", "pink"]
console.log(instance2.color) // (3)Â ["red", "green", "blue"]

instance1 // SonÂ {name: "Moxy", color: Array(4), age: 18}
console.log(instance1.__proto__) // FatherÂ {constructor: Æ’, sayAge: Æ’}
console.log(instance1.__proto__.__proto__) // {sayName: Æ’, constructor: Æ’}
```

ç»„åˆå¼ç»§æ‰¿åŽŸæœ¬éœ€è¦è°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»çš„æž„é€ æ–¹æ³•ï¼š

1. åœ¨å­ç±»çš„æž„é€ å‡½æ•°ä¸­è°ƒç”¨ï¼Œç›®çš„æ˜¯æŠŠ **çˆ¶ç±»çš„å±žæ€§** å¤åˆ¶åˆ°å­ç±»çš„å®žä¾‹åŒ–å¯¹è±¡ä¸­ï¼›
2. åœ¨è®¾ç½®å­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶è°ƒç”¨ï¼Œç›®çš„æ˜¯ç»§æ‰¿ **çˆ¶ç±»çš„æ–¹æ³•** ï¼Œç”±æ­¤äº§ç”Ÿçš„ä»£ä»·å°±æ˜¯åœ¨å­ç±»çš„åŽŸåž‹é“¾ä¸Šï¼Œå¤šäº†ä¸€ç»„ çˆ¶ç±»çš„å±žæ€§ã€‚

è€Œå¯„ç”Ÿç»„åˆå¼ï¼Œåªè°ƒç”¨ä¸€æ¬¡çˆ¶ç±»æž„é€ æ–¹æ³•ï¼Œä¸ºäº†æŠŠ **çˆ¶ç±»çš„å±žæ€§** å¤åˆ¶åˆ°å®žä¾‹åŒ–å¯¹è±¡ä¸­ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡å¯„ç”Ÿæ–¹å¼è¿›è¡Œã€‚å³çˆ¶ç±»æ–¹æ³•ç›´æŽ¥è®¾ç½®åœ¨å­ç±»å®žä¾‹åŒ–å¯¹è±¡çš„ prototype åŽŸåž‹é“¾ä¸Šã€‚

- çˆ¶ç±»æ–¹æ³•çš„ç»§æ‰¿ï¼šé€šè¿‡åŽŸåž‹é“¾åœ¨å®žä¾‹åŒ–çš„æ—¶å€™ç»‘å®šã€‚
- çˆ¶ç±»å±žæ€§çš„ç»§æ‰¿ï¼šé€šè¿‡æž„é€ å‡½æ•°åœ¨å®žä¾‹åŒ–çš„æ—¶å€™é‡æ–°åˆ›å»ºã€‚



### `Object.create()` 

`Object.create()`æ–¹æ³•çš„å®žè´¨æ˜¯ï¼šæ–°å»ºä¸€ä¸ªç©ºçš„æž„é€ å‡½æ•° `F`ï¼Œç„¶åŽè®© `F.prototype` å±žæ€§æŒ‡å‘å‚æ•°å¯¹è±¡`o`ï¼Œæœ€åŽè¿”å›žä¸€ä¸ª `F` çš„å®žä¾‹ï¼Œä»Žè€Œå®žçŽ°è®©è¯¥å®žä¾‹ç»§æ‰¿ `obj` çš„å±žæ€§ã€‚

å®žé™…ä¸Šï¼Œ`Object.create()` æ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ä»£æ›¿ã€‚ 

```js
Object.create = function (o) {
  function F() {}
  F.prototype = o;
  return new F();
};

// å› ä¸ºæž„é€ å‡½æ•°Fä¸­æ²¡æœ‰ä»»ä½•ä»£ç ï¼Œ new F() è¿”å›žäº†ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¹Ÿç›¸å½“äºŽï¼š
Object.create = function (o) {
  let newObj = {};
  nreObj.__proto__ = o;
  return newObj;
}
```



åœ¨å¯„ç”Ÿå¼ç»§æ‰¿ä¸­ï¼Œ`Object.create()` å®žé™…ä¸Šåšäº†å¦‚ä¸‹æ“ä½œï¼š

```js
let obj = Object.create(superType)

// æ›¿æ¢ä¸ºï¼š
let obj = {}
obj.__proto__ = superType
```



åœ¨å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ä¸­ï¼Œ`Object.create()` å®žé™…ä¸Šåšäº†å¦‚ä¸‹æ“ä½œï¼š

```js
let subPrototype = Object.create(Super.prototype)
 
// æ›¿æ¢ä¸ºï¼š
let subPrototype = {}
subPrototype.__proto__ = Super.prototype
```



## æœ€ä½³å®žè·µï¼š

1. ES5 ç‰ˆæœ¬æœ€ä½³å®žè·µï¼šå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œä½¿ç”¨ `Object.create()`ï¼›
2. ES6 ç‰ˆæœ¬æœ€ä½³å®žè·µï¼šåŽŸåž‹å¼ç»§æ‰¿çš„å½¢å¼ä¸‰ï¼š`Object.setPrototypeOf(Son.prototype, Father.prototype)`
3. ES5 ä»¥ä¸‹æœ€ä½³å®žè·µï¼šå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œä½¿ç”¨ object è‡ªå®šä¹‰å‡½æ•°ï¼›



ï¼ˆ3ï¼‰ES5 æœ€åŽŸå§‹ç‰ˆæœ¬å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼š

```js
// ðŸ“¦ä¸­é—´å‡½æ•°
function inheritPrototype(Sub, Super) {
	  Sub.prototype = object(Super.prototype);
    Sub.prototype.constructor = Sub;

    function object(o) {
    function F() {}
    F.prototype = o;
    return new F();
  };
}

// çˆ¶ç±»
function Father(name) {
    this.name = name;
    this.color = ["red", "green", "blue"];
}
Father.prototype.sayName = function () {
    console.log(this.name);
}

// å­ç±»
function Son(name, age) {
    Father.call(this, name);
    this.age = age;
}
inheritPrototype(Son, Father);
Son.prototype.sayAge = function () {
    console.log(this.age);
}


// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 18)
let instance2 = new Son("Ninjee", 28)
instance1.color.push("pink")
console.log(instance1.color) // (4)Â ["red", "green", "blue", "pink"]
console.log(instance2.color) // (3)Â ["red", "green", "blue"]

instance1 // SonÂ {name: "Moxy", color: Array(4), age: 18}
console.log(instance1.__proto__) // FatherÂ {constructor: Æ’, sayAge: Æ’}
console.log(instance1.__proto__.__proto__) // {sayName: Æ’, constructor: Æ’}
```

ï¼ˆ2ï¼‰ES5 çš„ä¸­é—´å‡½æ•°ï¼š

```js
// ðŸ“¦ä¸­é—´å‡½æ•°
function inheritPrototype(Sub, Super) {
	  Sub.prototype = Object.create(Super.prototype);
    Sub.prototype.constructor = Sub;
}
```

ï¼ˆ1ï¼‰ES6 çš„ç»§æ‰¿ï¼š

```js
// çˆ¶ç±»
function Father(name) {
    this.name = name;
    this.colors = ["red", "blue", "green"];
}
Father.prototype.printName = function () {
    console.log(this.name);
}

// å­ç±»ï¼š
function Son(name, age) {
    Father.call(this, name);
    this.age = age;
};
Son.prototype.printAge = function () {
    console.log(this.age);
}

Object.setPrototypeOf(Son.prototype, Father.prototype);

// å®žä¾‹åŒ–æµ‹è¯•ï¼š
let instance1 = new Son("Moxy", 99);	// SonÂ {name: "Moxy", colors: Array(3), age: 99}
let instance2 = new Son("Ninjee", 5);	// SonÂ {name: "Ninjee", colors: Array(3), age: 5}
instance1.printName === instance2.printName // true
Son.prototype.__proto__ === Father.prototype  // true
```



> å¼•ç”¨ï¼š
>
> - [jså¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ - SegmentFault æ€å¦](https://segmentfault.com/a/1190000037433122)
>
> - [JSåŽŸåž‹é“¾ä¸Žç»§æ‰¿åˆ«å†è¢«é—®å€’äº† (juejin.cn)](https://juejin.cn/post/6844903475021627400#heading-5)
>

