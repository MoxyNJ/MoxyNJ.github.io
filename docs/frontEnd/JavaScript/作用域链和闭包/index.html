<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-frontEnd/JavaScript/作用域链和闭包">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="ninjee RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="ninjee Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="ninjee JSON Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Ninjee的前端篮子" href="/opensearch.xml">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0930342e569f854bebdeb485c0eac7f8",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<link rel="icon" href="/img/ninjee.jpeg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><title data-rh="true">3. 作用域链和闭包 - Ninjee的前端篮子</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" name="twitter:image" content="https://ninjee.netlify.app/img/ninjee.jpeg"><meta data-rh="true" property="og:url" content="https://ninjee.netlify.app/docs/frontEnd/JavaScript/作用域链和闭包"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="keywords" content="Moxy, Ninjee, blog, javascript, typescript, python ,node, react, vue, web, 前端, 后端"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3. 作用域链和闭包 - Ninjee的前端篮子"><meta data-rh="true" name="description" content="1 基础"><meta data-rh="true" property="og:description" content="1 基础"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/作用域链和闭包"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/作用域链和闭包" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ninjee.netlify.app/docs/frontEnd/JavaScript/作用域链和闭包" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OITUMQ5615-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7d792d30.css">
<link rel="preload" href="/assets/js/runtime~main.3a186299.js" as="script">
<link rel="preload" href="/assets/js/main.06593736.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/ninjee-icon.png" alt="ninjee" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Ninjee</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">前端知识</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/frontEnd/JavaScript">JavaScript</a></li><li><a class="dropdown__link" href="/docs/frontEnd/HTML&amp;CSS">HTML &amp; CSS</a></li><li><a class="dropdown__link" href="/docs/frontEnd/React">React</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">敲代码</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/code/algorithm">算法</a></li><li><a class="dropdown__link" href="/docs/code/writtenJs">手写Js</a></li><li><a class="dropdown__link" href="/docs/code/skill">技巧</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">面试</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/interview/internet">计算机网络</a></li><li><a class="dropdown__link" href="/docs/interview/os">操作系统</a></li><li><a class="dropdown__link" href="/docs/interview/experience">面经</a></li><li><a class="dropdown__link" href="/docs/interview/summary">总结</a></li><li><a class="dropdown__link" href="/docs/interview/iot">物联网</a></li></ul></div><a class="navbar__item navbar__link" href="/project">我的项目</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript">概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/JavaScript的执行过程">1. JavaScript的执行过程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/执行上下文">2. 执行上下文</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/frontEnd/JavaScript/作用域链和闭包">3. 作用域链和闭包</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/this与箭头函数">4. this与箭头函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/提升与暂时性死区">5. 提升与暂时性死区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/函数与函数式编程">6. 函数与函数式编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/对象">7. 对象</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/原型链">8. 原型链</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/继承和类">9. 继承和类</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/ES6+基础">10. ES6+ 基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/z模块">10. 类（ES6）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/Symbol, Set, Map">11-Symbol, Set, Map</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/Proxy, Reflect">12. Proxy, Reflect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/Promise">13. Promise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/Iterator, Generator">14. Iterator, Generator.md</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/async:await, 异步编程">15. async/await, 异步编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/Js面试题整理">浏览器相关问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/z09执行上下文(ES3)">1 执行上下文(ES3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/z11.ArrayAPI">z11.ArrayAPI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/z12.引用数据类型">z12.引用数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontEnd/JavaScript/zES6：函数、扩展、解构">4 扩展对象的功能性</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_FykI"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_DTRl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">3. 作用域链和闭包</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>3. 作用域链和闭包</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-基础">1 基础<a class="hash-link" href="#1-基础" title="标题的直接链接">​</a></h2><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-内存管理">1. 内存管理<a class="hash-link" href="#1-内存管理" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="11-生命周期">1.1 生命周期<a class="hash-link" href="#11-生命周期" title="标题的直接链接">​</a></h3><ol><li>申请：程序申请内存，系统分配你需要的内存；</li><li>使用：程序使用分配好的内存，如存放对象；</li><li>释放：当程序使用完毕后，系统释放内存资源。</li></ol><ul><li>手动管理内存：如 C、C++，包括早期的OC，需要手动来管理内存的申请和释放（malloc和free函数）； </li><li>自动管理内存：比如 Java、JavaScript、Python、Swift、Dart等，它们有自动帮助我们管理内存；</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="12-js-的内存管理">1.2 Js 的内存管理<a class="hash-link" href="#12-js-的内存管理" title="标题的直接链接">​</a></h3><ul><li>基本数据类型：内存的分配会在执行时， 直接在 <strong>调用栈</strong> 进行分配； </li><li>复杂数据类型：内存的分配会在 <strong>堆内存</strong> 中开辟一块空间，然后在调用栈中，有一个指针指向堆内存的变量。</li></ul><p>闭包也保存在堆内存中。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="13-垃圾回收">1.3 垃圾回收<a class="hash-link" href="#13-垃圾回收" title="标题的直接链接">​</a></h3><p>垃圾回收分为：栈的垃圾回收，堆的垃圾回收。</p><ul><li>栈的垃圾回收依赖于调用栈的出栈；</li><li>堆的垃圾回收依赖于 GC 机制。</li></ul><p>Garbage Collection，GC。是现代编程语言的垃圾回收机制。</p><p>常见有三种 GC 算法（浏览器相关文章 <strong>存储机制</strong> 中有介绍）：</p><ol><li><strong>引用计数</strong><ul><li>当一个对象有一个引用指向它时，那么这个对象的引用就 +1，当一个对象的引用为 0 时，这个对象就可以被销毁掉；</li><li>这个算法有一个很大的弊端就是会产生循环引用；</li></ul></li><li><strong>标记清除</strong><ul><li>这个算法是设置一个根对象（root object），垃圾回收器会定期从这个根开始，找所有从根开始有引用到的对象，对于哪些没有引用到的对象，就认为是不可用的对象； </li><li>这个算法可以很好的解决循环引用的问题，Js 使用的是该方法。</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="14-js-中垃圾回收">1.4 Js 中垃圾回收<a class="hash-link" href="#14-js-中垃圾回收" title="标题的直接链接">​</a></h3><p>更详细内容，见：浏览器-存储机制</p><p>基本原理：</p><ul><li>代际假说：大部分对象在内存中存在的时间很短。不死的对象，会活得更久。</li><li>分代收集：在 V8 中会把堆分为 <strong>新生代（副垃圾回收器）</strong> 和 <strong>老生代（主垃圾回收器）</strong> 两个区域。</li></ul><p>工作流程：</p><ol><li><p>主回收器工作流程 (3)：标记对象、回收内存、整理内存。</p></li><li><p>副回收器的工作流程(4)：标记对象、回收内存、整理内存、角色反转、对象晋升。</p><ul><li><p>Scavenge 算法：新生代把空间对半划分：对象区域 + 空闲区域。</p><ul><li><p><strong>标记对象</strong>。标记空间中活动对象和非活动的垃圾对象。</p></li><li><p><strong>回收内存</strong> + <strong>整理内存</strong>。把存活的活动对象复制到空闲区域中，在复制的过程中，同时把这些对象进行有序排列。所以回收内存的同时也完成了碎片的整理。</p></li><li><p><strong>角色反转</strong>。原来的对象区域变成空闲区域，原来的空闲区域变成了对象区域。</p></li><li><p><strong>对象晋升</strong>。经过 <strong>两次</strong> 垃圾回收依然还存活的对象，会被移动到老生区中。</p></li></ul></li></ul></li></ol><p>对象晋升：</p><p>新生代中用 <strong>标记 - 清除（Mark-Sweep）</strong>和 <strong>标记 - 整理（Mark-Compact）</strong>来处理。流程如下：</p><ol><li><strong>标记对象</strong>。挨个遍历调用栈中的全部变量，以每一个变量为根元素，遍历这组根元素。所有遍历过程中，能到达的元素称为 <strong>活动对象</strong>，没有到达的元素判断为 <strong>垃圾数据</strong>。</li><li><strong>回收内存：标记 - 清除（Mark-Sweep）</strong>。直接清理掉标记为垃圾数据的对象。</li><li><strong>整理内存：标记 - 整理（Mark-Compact）</strong>。并不是每次都执行整理工作。执行时，让所有存活的对象都向一端移动，然后直接清理掉端边界以外的内存。</li></ol><p>优化：</p><p>增量标记（Incremental Marking），解决全停顿（Stop-The-World）现象。</p><ul><li>全停顿：这是因为 Js 运行在浏览器的主线程之上，而一旦执行垃圾回收算法，就会阻塞接下来的 js 脚本执行，造成卡顿。</li><li>增量标记：V8 把标记过程划分为多个子过程，让 GC 回收不会一次性完成，而是分多次和 Js 脚本交替进行，减小 Js 阻塞，减小页面动画等卡顿（16sm 一帧，这里涉及到浏览器的调度机制）。</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-作用域链-scope-chain">2. 作用域链 Scope Chain<a class="hash-link" href="#2-作用域链-scope-chain" title="标题的直接链接">​</a></h2><p>首先，通过一段代码理解作用域链：</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210905000728729-ff3ed6b5dd10060348ace267f0e04003.png" width="1523" height="1150" class="img_E7b_"></p><p>当一个代码块嵌套在另一个代码块中时，就发生了作用域的嵌套；作用域之前发生嵌套关系，就形成了作用域链。</p><p>作用域链是 <strong>静态</strong> 的，它只受变量和函数的声明位置决定。不同作用域的嵌套关系在分析代码时可以得出，在 <strong>编译前</strong> 引擎便能确定，和 <strong>执行上下文无关</strong> 。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="12-执行上下文与作用域链">1.2 执行上下文与作用域链<a class="hash-link" href="#12-执行上下文与作用域链" title="标题的直接链接">​</a></h3><p>当引擎在逐行执行代码时，如果遇到一个函数调用，引擎就会对应的创建一个执行上下文。每个执行上下文中都有一个 <code>outer</code>（在变量环境中）。这个 <code>outer</code> 指向该函数定义的时候所在作用域，有时它是一个执行上下文，有时它是一个闭包。</p><ul><li>更多关于闭包的知识，参考 <strong>&quot;闭包 Closure&quot;</strong> 章节。闭包是一系列变量的集合，是一个执行上下文的缩减版。</li></ul><p>所以，<code>outer</code> 就是外层作用域，<code>outer</code> 永远指向外层作用域对应的执行上下文（或闭包）。外层作用域是在定义的时候就已经确定了的，和如何调用，在哪里调用无关。</p><p>作用域链：不同的执行上下文（闭包）通过 <code>outer</code> 得以形成关系，这种串联的关系就是作用域链。</p><p>这是一个代码片段在执行中的暂停：</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210902143617540-6c48ca22792e51bd0b3e3dc1f4714095.png" width="1309" height="421" class="img_E7b_"></p><p>可以从开发者工具中看到，在<code>getName</code>  执行上下文中，作用域（scope）保存了：</p><ul><li><code>this</code> 值：指向一个 Object 通常是它的调用者。</li><li><code>foo</code>  闭包（closure）：当前执行上下文（<code>getName</code>）的 <code>outer</code> 属性指向 <code>foo</code> 闭包。</li><li><code>container</code> 闭包（closure）： <code>foo</code> 闭包的 <code>outer</code> 属性指向 <code>container</code> 闭包。</li><li>Global：<code>container</code> 闭包的 <code>outer</code> 属性指向了全局执行上下文，也就是 Global。</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="23-作用域链的查找">2.3 作用域链的查找<a class="hash-link" href="#23-作用域链的查找" title="标题的直接链接">​</a></h3><p>通过上文的代码举例：</p><p>当引擎处在 <code>bar</code> 作用域中时，假设它想访问变量 <code>v1</code>。</p><ol><li>引擎会先在当前作用域中（<code>bar</code>作用域）查找同名变量；</li><li>若没有找到，就会通过执行上下文的 <code>outer</code> 属性访问外层作用域（<code>foo</code>作用域），查找同名变量；</li><li>若没有依然没有找到，就再通过 <code>foo</code> 执行上下文中的 <code>outer</code> 属性去访问更外层的作用域（全局作用域）。最终，引擎找到了 <code>v1</code> 变量。</li></ol><p>引擎会沿着作用域链，依次查找每一个执行上下文中的变量名，一旦找到同名变量，则返回这个变量。若没有找到，则会一直向上查找，直到全局作用域为止。</p><p>这就是说，一条作用域链好比一幢建筑物。最顶层表示全局作用域，逐层嵌套的作用域表示逐层向下递减的楼层，最底层就是嵌套最深的作用域。这是一个从下向上的访问链，下层可以访问上层中的变量，而上层无法访问下层中的变量，如上图的向上箭头所示。</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="lhs-和-rhs">LHS 和 RHS<a class="hash-link" href="#lhs-和-rhs" title="标题的直接链接">​</a></h4><p>影响作用域链查找的还有 LHS 和 RHS。</p><p>LHS（left-hand Side）引用：查找并引用变量的 <strong>名称</strong>（key），通常在赋值运算符的左边。</p><p>RHS（right-hand Side）引用：查找并引用变量的 <strong>值</strong>（value），通常在赋值运算符的右边。</p><p>举例来说：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 以下a变量都是 LHS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 以下a变量都是 RHS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// a是函数;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>在变量还没有被声明（在任何作用域中都无法找到变量）的情况下，这两种查询的行为是不一样的。</p><p>情况 1：如果变量没有声明，进行 <strong>RHS 操作</strong>：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ReferenceError: b is not defined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>上段代码中，第二行 <code>console.log( a + b )</code> 中的 b 变量没有进行声明。所以当执行到这里时，引擎进行 RHS 查询 b 变量的值。最终会<strong>抛错</strong>： <code>ReferenceError: b is not defined</code>。</p><p>情况 2：如果变量没有声明，进行 <strong>LHS 操作</strong>：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>上段代码中，b 变量没有任何声明，当执行到 <code>b = a</code> 时，引擎为了获取 b 变量的变量名而进行作查询。沿着当前 foo 作用域，找到全局作用域，都没有找到该变量。之后，引擎不会报错，而是会在全局作用域中通过 <code>var</code> 声明 <strong>创建一个同名变量</strong>，并返回这个变量。</p><ul><li>严格模式下，会报错：</li></ul><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;use strict&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ReferenceError: b is not defined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>所以，我们要避免未声明变量，就直接在代码调用变量。轻则报错（RHS），重则造成内存浪费（LHS）。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-闭包-closure">3. 闭包 Closure<a class="hash-link" href="#3-闭包-closure" title="标题的直接链接">​</a></h2><p>通常来讲，对闭包有以下三种理解：</p><p>概念一（浏览器工作原理与实战）：闭包是内部函数引用外部函数的变量的集合。</p><p>概念二（Js 高程）：闭包是指有权访问另一个函数作用域中的变量的函数。</p><p>概念三（MDN）：闭包是函数和声明该函数的词法环境的组合，是一个函数和对其周围状态（lexical environment, 词法环境）的引用捆绑在一起。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="31-变量的集合">3.1 变量的集合<a class="hash-link" href="#31-变量的集合" title="标题的直接链接">​</a></h3><p>本文采用概念一对闭包的定义，<strong>闭包是一系列变量的集合</strong>。</p><p>在 JavaScript 中，根据词法作用域中作用域嵌套的规则，如果外部函数内嵌套了一个内部函数，那么内部函数总是可以访问外部函数中声明的变量。</p><p>当通过调用一个外部函数返回一个内部函数后，即使这个外部函数已经执行结束了，但是若内部函数引用了外部函数的变量，那么这些被引用的变量会依然保存在内存中，我们就把这些变量的集合称为闭包。</p><p>比如外部函数是 foo，那么这些变量的集合就称为 foo 函数的闭包。</p><p>举例来说，</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Moxy&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> callName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> call </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Moxy</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>这段代码中，全局作用域是无法访问 foo 函数内部的 name 变量的。但是通过调用外部函数 foo，返回了一个名为 callName 的内部函数，该内部函数引用了 name 变量。所以，全局作用域通过这个内部函数 callName 拥有了对 name 的访问权。这就形成了一个 foo 闭包。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="32-执行上下文的精简">3.2 执行上下文的精简<a class="hash-link" href="#32-执行上下文的精简" title="标题的直接链接">​</a></h3><p><strong>闭包是对一个执行上下文的精简。在即将销毁一个执行上下文时，如果该执行上下文内部有被其他作用域引用的变量，则会把这些变量进行打包，只销毁用不到的用不到变量和其他结构，就这样形成了一个闭包 Closure。</strong></p><p>换句话说，闭包没有包含整个变量环境和词法环境，只包含用到的变量。这是因为在返回内部函数时，JS 引擎会提前分析闭包内部函数的相关内容，有被子作用域引用的变量，不会被 gc 回收；而没有被引用到的，全部被 gc 回收。</p><p>从上一小节的例子中我们知道：即使 <code>foo</code> 被执行完毕，也不会立刻从内存中销毁。这是因为全局作用域通过 <code>call</code> 变量，依然持有对 <code>callName</code> 函数和 <code>name</code> 变量的访问权。</p><p>事实上在 <code>foo</code> 执行完毕后， <code>foo</code> 的执行上下文没有全部删除，而是删掉了绝大多数不需要的内容： <code>this</code>， <code>outer</code> 等等。对于登记在 <code>foo</code> 执行上下文内的所有变量和函数，也只保留了被其他作用域所持有的变量，其他的变量和函数则全部被销毁了。</p><p>如下图，在上一小节的案例中，<code>foo</code> 的执行作用域在被销毁前，转化为了一个 <code>foo</code> 闭包。</p><p><img loading="lazy" alt="image-20210907160803336" src="/assets/images/image-20210907160803336-afe05bd76321e97bda64d43a958d584b.png" width="1532" height="665" class="img_E7b_"></p><p><code>foo</code> 中 age 变量并没有被引用，引擎会对 <code>foo</code> 闭包进行优化，只保留被引用的 <code>name</code> 和 <code>callName</code>，<code>age</code> 变量随着 <code>foo</code> 执行完毕被销毁了。</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210907160813744-56f304abf5d0b6a2fa83a29f7aef333f.png" width="814" height="1245" class="img_E7b_"></p><p>随后， <code>foo</code> 闭包被绑定在 <code>callName</code> 执行上下文中的内置特性 <code>[[scope]]</code> 作用域链上。</p><p>当在全局执行环境中调用 <code>call()</code> (第11行代码) 时， <code>callName</code> 执行上下文入栈。由下图，可以在开发者工具中看到，<code>callName</code> 执行上下文的 scope 内，存在一个名为 <code>foo</code> 的闭包（closure）。</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210905161808361-94e41e193cb2609e11d4b48b9b83ad95.png" width="1030" height="912" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="33-作用域链中的一环">3.3 作用域链中的一环<a class="hash-link" href="#33-作用域链中的一环" title="标题的直接链接">​</a></h3><p>从上一小节的例子中我们可以得出一个结论：<strong>闭包是作用域链中的一环</strong>。</p><p>到此，我们可以得出一个完整的作用域链：</p><p>查找一个变量，做作用域链的顺序是这样的：</p><ol><li>先从执行上下文的内部开始查找：词法环境栈由上至下 ------&gt; 环境变量内登记的变量 ------&gt;  <code>outer</code> 外部环境</li><li>如果在当前执行上下文内部找不到所要的变量，就会通过 <code>outer</code> 去它的外层作用域查找。<ul><li>在外层作用域中，依然会有这一套顺序：词法环境栈由上至下 ------&gt; 环境变量内登记的变量 ------&gt;  <code>outer</code> 外部环境</li></ul></li><li>....</li><li>查找会顺着 <code>outer</code> 一直到最外层的全局执行上下文中查找。</li></ol><p> 在一个执行上下文内部的作用域链：</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210905225113810-f15c849402735629e0add1414983e55b.png" width="999" height="950" class="img_E7b_"></p><p>在多个执行上下文之间的作用域链：</p><ul><li>需要注意的是，多个执行上下文之间的作用域链是通过 <code>outer</code> 属性链接的。作用域链由函数声明时的位置决定，和调用顺序无关，自然和执行上下文栈的结构无关。</li></ul><p><img loading="lazy" alt="image-20210905225136348" src="/assets/images/image-20210905225136348-258de24428796b20ec804260857e9a55.png" width="1764" height="462" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="34-堆内存中的闭包">3.4 堆内存中的闭包<a class="hash-link" href="#34-堆内存中的闭包" title="标题的直接链接">​</a></h3><p><strong>闭包是保存在堆内存中的。</strong></p><p>如果有堆和栈的知识可以知道，函数的执行上下文是保存在调用栈中的，而调用栈会保存在栈内存中，方便快速读取其中的数据。函数的执行上下文自然也保存在栈内存中。</p><p>闭包的形成：</p><p>当一个函数中有几个变量形成一个闭包后，这个闭包就会从这个函数执行上下文中拿出来，然后保存在堆内存中。同时会删除这几个变量在这个函数执行上下文中的引用信息。最后，这个函数执行上下文中会保留一份对闭包的引用，这样一个闭包就形成了。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="35-闭包的缺点">3.5 闭包的缺点<a class="hash-link" href="#35-闭包的缺点" title="标题的直接链接">​</a></h3><p><strong>内存泄漏</strong>。</p><p>通俗说，必包延长了变量的生命周期，使这些原本应当销毁的变量继续留存在内存中。当这些变量不再需要时，如果依然保持引用，则变量依然没有销毁，变量多余的生命周期就是内存泄漏。</p><ul><li>解决：当闭包不再使用时，保持的引用赋值为 <code>null</code> 等其他值，只要解除对闭包的引用，即可放它入土。</li></ul><p>对于一个闭包来说，只要有一个函数执行上下文拥有对它的引用。这个闭包就无法被 GC 回收。</p><p>如果大量使用闭包，且有常驻调用栈的函数大量引用了闭包，这导致大量闭包长期保存在堆内存中，消耗大量内存。最终影响网页的性能。</p><p>所以，闭包的使用有可能会占用大量内存、进而造成内存泄漏。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="总结一">总结一<a class="hash-link" href="#总结一" title="标题的直接链接">​</a></h2><p>通过下面的这一段代码，来理解 <strong>作用域链</strong> 和 <strong>执行上下文</strong> 之间的关系：</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cat&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">myAge</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pig&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;monkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> myAge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>当执行到 bar 函数内部的 if 语句块时，开发者工具的情况如下图所示：</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210906231702099-1752b3806cb7bf0337e1918e38d8575c.png" width="1204" height="928" class="img_E7b_"></p><p>可以看到，此时的调用栈：全局执行上下文 ==&gt; foo 执行上下文 ==&gt; bar 执行上下文</p><p>作用域：bar 执行上下文（词法环境 ==&gt; 变量环境） ==&gt; 全局执行上下文（词法环境 ==&gt; 变量环境）</p><p>此时的调用栈情况如下图：</p><p><img loading="lazy" alt="imgx" src="/assets/images/image-20210907160855256-941a9eaff9ca2fee8df11ad238df8515.png" width="1793" height="1287" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="总结二">总结二<a class="hash-link" href="#总结二" title="标题的直接链接">​</a></h2><p>下面可以通过这一段代码，完整的思考一下 <strong>调用栈</strong>、<strong>执行上下文</strong>、<strong><code>outer</code></strong> 和 <strong>闭包</strong> 的关系。</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">container</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Moxy&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> myName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Monkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> testLet </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> testConst </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> baz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function-variable function" style="color:#d73a49">getName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">testLet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">debugger</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// 查看这里的调用栈状态、执行上下文和闭包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> myName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function-variable function" style="color:#d73a49">setName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">newName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                myName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> newName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> baz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Ninjee&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">container</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>这里只分析当代码运行到 <code>debugger</code> 时， <strong>调用栈</strong>、<strong>执行上下文</strong>、<strong><code>outer</code></strong> 和 <strong>闭包</strong> 的状态：</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210905194458129-c68e37d867de2c07c955f8920024459d.png" width="1198" height="1102" class="img_E7b_"></p><p>此时的调用栈：</p><p> <img loading="lazy" alt="imgx" src="/assets/images/image-20210907160918710-4a1954380e2aa9d748ab9f977ae88583.png" width="941" height="1605" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="引用">引用<a class="hash-link" href="#引用" title="标题的直接链接">​</a></h2><blockquote><p>《你不知道的JavaScript》</p><p>winter - 重学前端</p><p>李兵 - 浏览器工作原理与实战</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/java-script">JavaScript</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/frontEnd/JavaScript/执行上下文"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">2. 执行上下文</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/frontEnd/JavaScript/this与箭头函数"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">4. this与箭头函数</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-基础" class="table-of-contents__link toc-highlight">1 基础</a></li><li><a href="#1-内存管理" class="table-of-contents__link toc-highlight">1. 内存管理</a><ul><li><a href="#11-生命周期" class="table-of-contents__link toc-highlight">1.1 生命周期</a></li><li><a href="#12-js-的内存管理" class="table-of-contents__link toc-highlight">1.2 Js 的内存管理</a></li><li><a href="#13-垃圾回收" class="table-of-contents__link toc-highlight">1.3 垃圾回收</a></li><li><a href="#14-js-中垃圾回收" class="table-of-contents__link toc-highlight">1.4 Js 中垃圾回收</a></li></ul></li><li><a href="#2-作用域链-scope-chain" class="table-of-contents__link toc-highlight">2. 作用域链 Scope Chain</a><ul><li><a href="#12-执行上下文与作用域链" class="table-of-contents__link toc-highlight">1.2 执行上下文与作用域链</a></li><li><a href="#23-作用域链的查找" class="table-of-contents__link toc-highlight">2.3 作用域链的查找</a><ul><li><a href="#lhs-和-rhs" class="table-of-contents__link toc-highlight">LHS 和 RHS</a></li></ul></li></ul></li><li><a href="#3-闭包-closure" class="table-of-contents__link toc-highlight">3. 闭包 Closure</a><ul><li><a href="#31-变量的集合" class="table-of-contents__link toc-highlight">3.1 变量的集合</a></li><li><a href="#32-执行上下文的精简" class="table-of-contents__link toc-highlight">3.2 执行上下文的精简</a></li><li><a href="#33-作用域链中的一环" class="table-of-contents__link toc-highlight">3.3 作用域链中的一环</a></li><li><a href="#34-堆内存中的闭包" class="table-of-contents__link toc-highlight">3.4 堆内存中的闭包</a></li><li><a href="#35-闭包的缺点" class="table-of-contents__link toc-highlight">3.5 闭包的缺点</a></li></ul></li><li><a href="#总结一" class="table-of-contents__link toc-highlight">总结一</a></li><li><a href="#总结二" class="table-of-contents__link toc-highlight">总结二</a></li><li><a href="#引用" class="table-of-contents__link toc-highlight">引用</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">分享</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/frontEnd/JavaScript">前端</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/code/algorithm">算法笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/project">我的项目</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/moxyNJ" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/user/2005151873514024" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a href="https://www.ninjee.co" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ninjee 的前端篮子</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p>Copyright © 2022 Ninjee Built with Docusaurus.</p><p><a href="http://beian.miit.gov.cn/">晋ICP备2021017941号-2</a></p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.3a186299.js"></script>
<script src="/assets/js/main.06593736.js"></script>
</body>
</html>