---
title: 10. ç±»ï¼ˆES6ï¼‰
sidebar_position: 10
date: 2022-07-26
tags: [JavaScript]
---

## 1 Class ç±»

class Person ç›¸å½“äº `function Person()`ï¼Œæ˜¯ä¸€ä¸ª function Person çš„è¯­æ³•ç³–ã€‚

### 1.1 ç±»çš„ç»“æ„

åŒ…å«ï¼šæ„é€ å‡½æ•° (ç±»å)ã€æ„é€ å™¨ `constructor`ã€å®ä¾‹æ–¹æ³•ã€è·å–å‡½æ•° `get`ã€è®¾ç½®å‡½æ•° `set`ã€é™æ€æ–¹æ³• `static`ã€‚

```js
// æ„é€ å‡½æ•°
class Person {
    // æ„é€ å™¨
    constructor(name, age){
        this.name = name;
        this.age = age;
        this.nickname_ = "none";
    }
    // å®ä¾‹æ–¹æ³•ï¼šåœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šå®šä¹‰
    callName(){
        console.log(this.name)
    }
    // é™æ€æ–¹æ³•ï¼šåœ¨ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰ä¸Šå®šä¹‰
    static callHello() {
        console.log("Hello")
    }
    // get å‡½æ•°ï¼šåœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šå®šä¹‰
    get nickname() {
        return this.nickname_;
    }
    // set å‡½æ•°ï¼šåœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šå®šä¹‰
    set nickname(newName) {
        if(newName !== this.nickname_) {
            this.nickname_ = newName;
        } else {
            console.log("Cannot duplicate the original nickname")
        }      
    }
    
    // åœ¨constructorå¤–è®¾ç½®å±æ€§ï¼Œå’Œåœ¨ constructor å†…ä¸€æ ·ï¼Œä¼šèµ‹å€¼åˆ°å®ä¾‹åŒ–å¯¹è±¡ä¸­ï¼Œä¸è®ºæ˜¯ å±æ€§ è¿˜æ˜¯ æ–¹æ³•ã€‚
		//	- é€šè¿‡å±æ€§åçš„æ–¹å¼å®šä¹‰çš„æ–¹æ³•ï¼Œå°±ä¼šç»‘å®šåˆ°å®ä¾‹åŒ–å¯¹è±¡ä¸Šï¼Œè€Œä¸æ˜¯åœ¨åŸå‹ä¸Šã€‚
    perName = "Happy";
	  callPerName = function() {  // å‡½æ•°è¡¨è¾¾å¼
		    console.log(this.perName)
    };
}

// æµ‹è¯•ï¼š
// ç±»çš„å®ä¾‹åŒ–ï¼š
let p = new Person("Moxy", 18)
// å®ä¾‹æ–¹æ³•
p.callName()	 	  // Moxy
// é™æ€æ–¹æ³•
Person.callHello()	  // Hello
// get å‡½æ•°
p.nickname = "Ninjee" // 'Ninjee'
// set å‡½æ•°
p.nickname;			  // 'Ninjee'
// å®ä¾‹åŒ–å±æ€§ + æ–¹æ³•
p1.perName			  // 'Happy'
p1.callPerName()	  // Happy
// typeof 
typeof Person 		// functionï¼Œclass Person å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°
```

**æ³¨æ„ï¼š**

- åœ¨ constructor å¤–å®šä¹‰æ–¹æ³•ï¼šæœ€åä¼šåœ¨ `Person.prototype` ç±»çš„åŸå‹ä¸Šå®šä¹‰ï¼Œæ˜¯å…¬æœ‰æ–¹æ³•ï¼›
- åœ¨ constructor å¤–å®šä¹‰å±æ€§ï¼šæœ€åä¼šåœ¨ "ç±»çš„å®ä¾‹åŒ–å¯¹è±¡" ä¸Šå®šä¹‰ï¼Œæ˜¯å®ä¾‹åŒ–å±æ€§çš„ç§æœ‰æ–¹æ³•ï¼›
  - å®šä¹‰å±æ€§ä¹Ÿå¯ä»¥èµ‹å€¼ä¸ºä¸€ä¸ªæ–¹æ³•ï¼ˆå‡½æ•°è¡¨è¾¾å¼ï¼‰ï¼Œè¿™æ ·å°±æ‹¥æœ‰ä¸€ä¸ªå®ä¾‹åŒ–æ–¹æ³•äº†ï¼›
  - **è¿™å…¶å®å’Œåœ¨ constructor ä¸­å®šä¹‰æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚**



##### 1.1.1 ç±»çš„å®ä¾‹åŒ–

```js
let p = new Person()
```

ä½¿ç”¨ `new` è°ƒç”¨ class ï¼Œä¼šæ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š

1. åˆ›å»ºä¸€ä¸ª **æ–°å¯¹è±¡** `{}`ï¼›
2. ä¸ºæ–°å¯¹è±¡ç»‘å®š **åŸå‹é“¾**ï¼š`{}.__proto__ = Person.prototype`ï¼›
3. å°† class çš„ä½œç”¨åŸŸ **`this`** èµ‹ç»™æ–°å¯¹è±¡ `{}`ï¼›
4. æ‰§è¡Œ class ä¸­çš„ä»£ç ï¼Œä¸º `{}` æ·»åŠ å±æ€§ï¼š `constructor.call(this, params...);`
   - åœ¨ constructor å¤–çš„ã€æ²¡æœ‰ `get`ï¼Œ`set`ï¼Œ`static` æ ‡è¯†ç¬¦çš„å±æ€§ï¼Œå…¨éƒ¨å®šä¹‰åˆ° `{}` ä¸­ã€‚
5. å¦‚æœæ„é€ å‡½æ•°æœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°±è¿”å› **æ„é€ å‡½æ•°ä¸­çš„å¯¹è±¡**ã€‚
6. å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œå°±ä¼šè¿”å› **æ–°å¯¹è±¡**ã€‚

æœ€ç»ˆï¼Œä»£ç ä¸­å·¦ä¾§çš„ `p` å˜é‡æ¥æ”¶åˆ°äº†æ–°åˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡ã€‚



#### 1.1.2 static é™æ€æ–¹æ³•

é™æ€æ–¹æ³•ï¼Œä¼šæŠŠè¿™ä¸ªæ–¹æ³•æ·»åŠ åˆ° `class` æ„é€ å‡½æ•°è‡ªèº«ï¼ˆç±»åä¸Šï¼‰ï¼Œè€Œä¸æ˜¯å…¶ `.prototype` åŸå‹é“¾ä¸Šã€‚æ‰€ä»¥å®ä¾‹åŒ–å¯¹è±¡æ— æ³•ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯é€šè¿‡ ç±»åç›´æ¥è°ƒç”¨ã€‚

```js
class Foo{
    constructor(){}
    static callHello(){
        console.log("Hello")
    }
}

Foo.callHello() // Hello

let f = new Foo()
f.callHello()	// f.callHello is not a function
```

static çš„ä¸€ç§å¸¸è§ç”¨æ³•ï¼Œå¯ä»¥éšæœºå®ä¾‹åŒ–å¯¹è±¡ï¼Œä¸‹é¢å°±æ˜¯éšæœºåŒ–ç”Ÿæˆ Person å®ä¾‹åŒ–çš„ä¾‹å­ï¼š

```js
class Person {
  constructor(name, age){
    this.name = name;
    this.age = age;
    this.nickname_ = "none";
  }

  callName(){
    console.log(this.name)
  }
  
  static randomPerson() {
    const names = ["Jack", "Marry", "Bob", "Jobs", "Happy", "Moon", "Ted"];
		const nameIndex = Math.floor(Math.random() * names.length);
		const name = names[nameIndex];
    const age = Math.floor(Math.random() * 30);
    return new Person(name, age);
	}
}

for (let i = 0; i < 10; i++)
  console.log(Person.randomPerson());
// PersonÂ {name: 'Ted', age: 21, nickname_: 'none'}
// PersonÂ {name: 'Moon', age: 15, nickname_: 'none'}
// PersonÂ {name: 'Marry', age: 6, nickname_: 'none'}
// PersonÂ {name: 'Ted', age: 14, nickname_: 'none'}
// PersonÂ {name: 'Ted', age: 26, nickname_: 'none'}
// PersonÂ {name: 'Happy', age: 20, nickname_: 'none'}
// PersonÂ {name: 'Bob', age: 22, nickname_: 'none'}
// PersonÂ {name: 'Jack', age: 5, nickname_: 'none'}
// PersonÂ {name: 'Ted', age: 20, nickname_: 'none'}
// PersonÂ {name: 'Happy', age: 3, nickname_: 'none'}
```



#### 1.1.3 å¯è¿­ä»£çš„ç±»

å¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ generatorï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠç±»æ”¹ä¸ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚

```js
class Person {
    constructor() {
        this.nicknames = ["Moxy", "Ninjee", "walnut"];
    }

    *[Symbol.iterator]() {
        yield* this.nicknames.entries();
    }
}

let p = new Person()
for (let [idx, v] of p) {
    console.log(`id: ${idx}, nickName: ${v}`)
}
// id: 0, nickName: Moxy
// id: 1, nickName: Ninjee
// id: 2, nickName: walnut
```

æˆ–è€…ç›´æ¥è¿”å›ä¸€ä¸ª iterator å®ä¾‹ã€‚

```js
class Person {
    constructor() {
        this.nicknames = ["Moxy", "Ninjee", "walnut"];
    }

    [Symbol.iterator]() {
        return this.nicknames.entries(); // entriesä¼šè¿”å›ä¸€ä¸ªiterator
    }
}

let p = new Person()
for (let [idx, v] of p) {
    console.log(`id: ${idx}, nickName: ${v}`)
}
// id: 0, nickName: Moxy
// id: 1, nickName: Ninjee
// id: 2, nickName: walnut
```



#### 1.1.4 å¤‡æ³¨ï¼š

ç±»æ–¹æ³•æ˜¯ä¸å¯æšä¸¾çš„ï¼Œå¯¹è±¡çš„æ–¹æ³•æ˜¯é»˜è®¤å¯æšä¸¾çš„ã€‚



ä¸ `function Foo` ç›¸æ¯”ï¼Œ`class Foo` çš„ç‰¹ç‚¹æ˜¯ï¼š

- ä¸æå‡ã€‚`function Foo` å­˜åœ¨å˜é‡æå‡ï¼Œè€Œ `class` ç±»ä¸å­˜åœ¨å˜é‡æå‡ã€‚
- æ— æ³•ç›´æ¥è°ƒç”¨ã€‚`class Foo` æ— æ³•ç›´æ¥è°ƒç”¨ï¼Œå¿…é¡» `new` å®ä¾‹åŒ–æœ‰æ‰å¯ä»¥è°ƒç”¨ã€‚è€Œ `function Foo` çš„å¯ä»¥å½“ä½œä¸€ä¸ªæ™®é€šå‡½æ•°é‚£æ ·ä½¿ç”¨ï¼š `Foo.call(obj)` 



### 1.2 extends ç»§æ‰¿

- `extends` ç»§æ‰¿ï¼Œæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç”¨æ¥åœ¨ä¸¤ä¸ªå‡½æ•°åŸå‹ä¹‹é—´å»ºç«‹ `[[Prototype]]` é“¾æ¥ã€‚
- `static` ï¼Œå­ç±»ä¹Ÿç»§æ‰¿äº†çˆ¶ç±»çš„ static é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ `Son.fatherStaticMethod` è°ƒç”¨ã€‚
- `super` è‡ªåŠ¨æŒ‡å‘çˆ¶æ„é€ å™¨ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘çˆ¶å¯¹è±¡ã€‚
- `super` æœ‰ä¸¤ç§ç”¨æ³•ï¼š
  - `super` æŒ‡å‘çˆ¶æ„é€ å™¨ constructorï¼Œä¸»è¦æ˜¯ä¸ºäº†å®ç°çˆ¶ç±»å±æ€§çš„ç»§æ‰¿ï¼›
  - `super` æŒ‡å‘çˆ¶å¯¹è±¡ classï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©å­ç±»å¯ä»¥åœ¨è‡ªå®šä¹‰æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚



ç”¨æ³•ä¸€ï¼š`super` å®ç°ç»§æ‰¿

```js
class Foo {
    constructor(a, b) {
        this.x = a;
        this.y = b;
    }
    gimmeXY() {
        return this.x * this.y;
    }
}

class Bar extends Foo {
    constructor(a, b, c) {
        super(a, b);
        this.z = c;
    }
    gimmeXYZ() {
        return super.gimmeXY() * this.z;
    }
}

let b = new Bar(5, 15, 25);
b.x;            // 5
b.y;            // 15
b.z;            // 25
b.gimmeXYZ()    // 1875

Foo.prototype === Bar.prototype.__proto__	// true
```

- `class Bar extends Foo` è¡¨ç¤ºæŠŠ `Bar.prototype` çš„ `[[Prototype]]` æŒ‡å‘äº† `Foo.prototype`ã€‚
- `super` æ˜¯é™æ€ç»‘å®šçš„ã€‚
- å­ç±»æ„é€ å™¨ `constructor` ä¸­ï¼Œå¿…é¡»å…ˆä½¿ç”¨ `super`ï¼Œæ‰èƒ½ä½¿ç”¨ `this`ã€‚
- å¦‚æœåœ¨ç»§æ‰¿çˆ¶ç±»åï¼Œæ²¡æœ‰å®šä¹‰ `constructor`ï¼Œåˆ™å¼•æ“ä¼šé»˜è®¤å¸®ä½ è°ƒä¸€æ¬¡ `constructor`ï¼Œå¹¶åœ¨å…¶ä¸­ä¹Ÿè°ƒç”¨ä¸€æ¬¡ `super`ï¼Œä¼ é€’æ‰€æœ‰å€¼ç»™ `super`ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š

```js
// é»˜è®¤çš„ constructor
constructor(...args){
    super(...args);
}
```



ç”¨æ³•äºŒï¼š`super` å­ç±»è°ƒç”¨çˆ¶ç±»æ–¹æ³•

ä¸‹ä¾‹ä¸­ï¼Œå­ç±»é‡è½½äº†çˆ¶ç±»çš„ func æ–¹æ³•ï¼Œä½¿ç”¨ superï¼Œå­ç±»çš„ func æ–¹æ³•å…ˆæ‰§è¡Œäº†çˆ¶ç±»åŸæ–¹æ³•ï¼Œå†é¢å¤–æ–°å¢é€»è¾‘ï¼š

```js
class Father {
	func() {
		console.log('é€»è¾‘1');
    console.log('é€»è¾‘2');
    console.log('é€»è¾‘3');
  }
  
  static StaticMethod() {
   	console.log('Father StaticMethod');
	}
  
  static FatherStaticMethod() {
   	console.log('Father FatherStaticMethod');
	}
}

class Son extends Father {
  constructor(){
    super();
  }
  
  // é‡å†™çˆ¶ç±»æ–¹æ³•
  func() {
    super.func();  // å¤ç”¨çˆ¶ç±»æ–¹æ³•
		console.log('æ–°å¢ï¼šé€»è¾‘4');
    console.log('æ–°å¢ï¼šé€»è¾‘5');
	}
  
  // é‡å†™çˆ¶ç±»é™æ€æ–¹æ³•
  static StaticMethod() {
    super.StaticMethod() // å¤ç”¨çˆ¶ç±»é™æ€æ–¹æ³•ï¼Œâš ï¸è¿™é‡Œé™æ€æ–¹æ³•çš„è°ƒç”¨é‡‡ç”¨ super.ï¼Œè€Œä¸æ˜¯ç±»å Father.
   	console.log('son static method');
	}
}

const s = new Son();

// çˆ¶ç±»æ–¹æ³•çš„å¤ç”¨å’Œé‡è½½
s.func() 
	// é€»è¾‘1
	// é€»è¾‘2
	// é€»è¾‘3
	// æ–°å¢ï¼šé€»è¾‘4
	// æ–°å¢ï¼šé€»è¾‘5


// çˆ¶ç±»é™æ€æ–¹æ³•çš„å¤ç”¨å’Œé‡è½½
Son.StaticMethod()
	// Father StaticMethod
	// son static method


// çˆ¶ç±»é™æ€æ–¹æ³•çš„ç»§æ‰¿
Son.FatherStaticMethod()
	// Father FatherStaticMethod
```



#### 1.2.1 new.target

`new.target` æ˜¯ä¸€ä¸ªå…ƒå±æ€§ï¼ˆmeta propertyï¼‰ï¼Œå®ƒæ€»æ˜¯æŒ‡å‘ new å®é™…ä¸Šç›´æ¥è°ƒç”¨çš„æ„é€ å™¨ã€‚

```js
class Foo {
    constructor() {
        console.log("Foo:", new.target.name)
    }
}

class Bar extends Foo {
    constructor() {
        super()
        console.log("Bar:", new.target.name)
    }
    baz() {
        console.log("baz:", new.target)
    }
}
let a = new Bar()
// Foo: Bar
// Bar: Bar
a.baz()
// baz: undefined
```

å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿åœ¨å­ç±»ä¸­é€šè¿‡ `super` å»è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œ`new.target` ä¹Ÿä¼šæ­£ç¡®çš„æŒ‡å‘å­ç±»æ„é€ å™¨ï¼š `new`  è°ƒç”¨çš„æ˜¯è° (`Bar`)ï¼Œ`new.target` å°±æ°¸è¿œæŒ‡å‘è°çš„æ„é€ å™¨  (`Bar` çš„ `constructor`)ã€‚

å¦‚æœ `new.target` å€¼ä¸º `undefined` ï¼Œåˆ™è¡¨æ˜è¿™ä¸ªå‡½æ•°ä¸æ˜¯é€šè¿‡ `new` æ¥è°ƒç”¨çš„ã€‚



#### 1.2.2 æŠ½è±¡åŸºç±»ï¼ˆæ¥å£ï¼‰

æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒå¯ä»¥ä¾›å…¶ä»–ç±»ç»§æ‰¿ï¼Œä½†æœ¬èº«ä¸ä¼šè¢«å®ä¾‹åŒ–ã€‚å¯ä»¥é€šè¿‡ `new.target` æ¥å®ç°ã€‚

é€šè¿‡åœ¨å®ä¾‹åŒ–æ—¶ï¼Œæ£€æµ‹ `new.target`ï¼Œåˆ¤æ–­è¯¥ç±»æ˜¯å¦ä¸ºä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç„¶åé˜»æ­¢å¯èƒ½çš„å®ä¾‹åŒ–åŠ¨ä½œã€‚

```js
// æ¥å£
class Vehicle {
    constructor() {
        console.log(new.target.name);
        if (new.target === Vehicle) 
            throw new Error('Vehicle cannot be derectly instantiated')
    }
}
// æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰
class Bus extends Vehicle {}

// å®ä¾‹åŒ–æµ‹è¯•
new Vehicle()	// Vehicle
							// Uncaught Error: Vehicle cannot be derectly instantiated
new Bus()	 // Bus
```



### 1.3 ä½¿ç”¨ Bebel è½¬åŒ–

> ğŸ”—é“¾æ¥ï¼š
>
> [Babel å®˜ç½‘](https://babeljs.io)
>
> [Babel ä»£ç è½¬åŒ–æµ‹è¯•](https://babeljs.io/repl)
>
> - Targetsï¼šnot ie 10 è®©æµè§ˆå™¨æ”¯æŒ ie 10 ä»¥ä¸Šç‰ˆæœ¬ï¼ˆES6ä»¥ä¸‹ï¼‰



è®©ä¸€ä¸ªå‡½æ•°åªèƒ½é€šè¿‡ `new` è°ƒç”¨ï¼š

```js
// es6 è¯­æ³•ï¼š
Person {}

// bebel è½¬åŒ–çš„ es5è¯­æ³•ï¼š
function _classCallCheck(instance, Constructor) { 
  if (!(instance instanceof Constructor)) {  // åˆ¤æ–­ instance å®ä¾‹åŸå‹é“¾ä¸Šæ˜¯å¦æœ‰ Constructor
    throw new TypeError("Cannot call a class as a function"); 
  } 
}

var Person = /*#__PURE__*/(function() {
  function Person() {
  // å¦‚æœæ˜¯ new è°ƒç”¨ï¼Œthisæ˜¯ä¸€ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå…¶åŸå‹é“¾æŒ‡å‘äº†Person
  _classCallCheck(this, Person);
  }
  return Person;
})();

// test
new Person()  // PersonÂ {}
Person()			// Uncaught TypeError: Cannot call a class as a function
```

- ä½¿ç”¨ `var Person = (function() {}) ... `
  - è¿™é‡Œä½¿ç”¨ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œéš”ç»äº†å¤–éƒ¨ä½œç”¨åŸŸï¼Œä½¿å†…éƒ¨å˜é‡çš„åç§°ä¸ä¼šæ³„éœ²åˆ°å¤–éƒ¨ã€‚
  - `/*#__PURE__#*/` è¡¨æ˜äº†è¿™ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°æ˜¯ä¸€ä¸ª **çº¯å‡½æ•°**ï¼Œè¿™å¯ä»¥è®© webpack åœ¨æ‰“åŒ…æ—¶çš„ tree shaking ç¯èŠ‚æ—¶åˆ¤æ–­ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°æ²¡æœ‰å®é™…ä½¿ç”¨è¿‡ï¼Œåˆ™ä¼šåˆ æ‰è¿™ä¸ªçº¯å‡½æ•°ï¼Œä»è€Œå‡å°æ‰“åŒ…ä½“ç§¯ã€‚



å®ç° class Personï¼š

```js
// ğŸ  es6 æºä»£ç 
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age
  }

  eating() {
    console.log(this.name + " eating~")
  }
}

// ğŸ”¥ babel è½¬æ¢
"use strict";

// åˆ¤æ–­æ˜¯å¦ç”¨ new è°ƒç”¨ï¼Œå¦‚æœä¸æ˜¯åˆ™æŠ›å‡ºé”™è¯¯
function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

// éå†æ‰€æœ‰çš„å±æ€§ï¼Œç„¶åè®¾ç½®æ¯ä¸ªå±æ€§çš„ç‰¹æ€§enumerable, configurable, writable
function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

// ç»™æ„é€ å‡½æ•°æ·»åŠ æ–¹æ³•ï¼ˆå…¬æœ‰æ–¹æ³•+é™æ€æ–¹æ³•ï¼‰
function _createClass(Constructor, protoProps, staticProps) {
	// å®šä¹‰æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³•
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  // å®šä¹‰æ„é€ å‡½æ•°ä¸Šçš„é™æ€æ–¹æ³•ï¼ˆå¦‚æœæœ‰ï¼‰
  if (staticProps) _defineProperties(Constructor, staticProps);
  return Constructor;
}


var Person = /*#__PURE__*/ (function () {
  // æ„é€ å‡½æ•°
  function Person(name, age) {
    this.name = name;
    this.age = age;
  }
	// åŸå‹å¯¹è±¡ä¸Šæ·»åŠ æ–¹æ³• + æ„é€ å‡½æ•°ä¸Šæ·»åŠ é™æ€æ–¹æ³•
  _createClass(Person, [
    {
      key: "eating",
      value: function eating() {
        console.log(this.name + " eating~");
      }
    }
  ]);

  return Person;
})();
```





## 2 Module æ¨¡å—

å³ ES Moduleã€‚å…¶åŒ…å«çš„ä¸¤ä¸ªå…³é”®è¯`export` å’Œ `import `å‡åªèƒ½ç”¨åœ¨æœ€é¡¶å±‚çš„ä½œç”¨åŸŸä¸­ã€‚



### 2.1 export å¯¼å‡º

`export` å…³é”®å­—æ”¾åœ¨å£°æ˜çš„å‰é¢ã€‚

- `default export` å¯¼å‡ºçš„æ˜¯è¿™äº›å˜é‡ / å‡½æ•°çš„åœ°å€ï¼ˆç±»ä¼¼æŒ‡é’ˆï¼‰ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„å€¼ã€‚æ‰€ä»¥ï¼Œåœ¨ä¸€ä¸ªå‡½æ•° / å˜é‡è¢«å¯¼å‡ºåï¼Œè¿™ä¸ªå‡½æ•° / å˜é‡çš„ç»“æ„æˆ–å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œå¤–éƒ¨ä¹Ÿä¼šå¾—åˆ°å¯¹åº”çš„æ›´æ–°ã€‚

- `export` å¯¼å‡ºçš„æ˜¯å˜é‡åç§°ï¼ˆæ ‡è¯†ç¬¦ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å½“è¿™ä¸ªå˜é‡æŒ‡å‘äº†æ–°çš„å‡½æ•°ï¼Œå°±ä¼šå¯¼å‡ºæ–°çš„å‡½æ•°ã€‚

ç‰¹ç‚¹ï¼š

1. **ä¸æ”¯æŒåŒå‘ç»‘å®š**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ”¯æŒå¯¹ä¸€ä¸ªå¯¼å…¥çš„æ¨¡å—è¿›è¡Œä¿®æ”¹ï¼Œåªèƒ½è¯»å–å’Œä½¿ç”¨ã€‚
2. åœ¨æ¨¡å—å†…æ²¡æœ‰å…¨å±€ä½œç”¨åŸŸã€‚åœ¨æ¨¡å—å†…æ˜¯ä¸€ä¸ªæ¨¡å—çš„ä½œç”¨åŸŸã€‚
3. æ¨¡å—å†…æ²¡æœ‰ç”¨ `export` æ ‡è¯†çš„å˜é‡ / å‡½æ•°éƒ½åœ¨è«å—ä½œç”¨åŸŸå†…éƒ¨ä¿æŒç§æœ‰ï¼Œè¢«æ ‡è¯†çš„åˆ™ä¼šè¢«å¯¼å‡ºã€‚

#### 1 å‘½åå¯¼å‡º

å‘½åå¯¼å‡ºï¼šå¯¼å‡ºå˜é‡ / å‡½æ•°æ—¶ï¼ŒæŠŠæ ‡è¯†ç¬¦åç§°å¯¼å‡ºï¼š

```js
// æ–¹å¼ä¸€
export function foo() {...}
export let arr = [1,2,3]
export let a = 42

// æ–¹å¼äºŒ
function foo() {...}
let arr = [1, 2, 3]
let a = 42
export {foo, arr, a}
```

å¯¼å‡ºæ—¶å¯ä»¥é‡å‘½åï¼š

```js
function foo() {...}
export {foo as bar}
```



#### 2 é»˜è®¤å¯¼å‡º

é»˜è®¤å¯¼å‡ºï¼ŒæŠŠä¸€ä¸ªç‰¹å®šå¯¼å‡ºï¼Œç»‘å®šè®¾ç½®ä¸ºå¯¼å…¥æ¨¡å—æ—¶çš„é»˜è®¤å¯¼å‡ºã€‚ç»‘å®šçš„åç§°å°±æ˜¯ `default`ã€‚

- **æ¯ä¸ªæ¨¡å—å®šä¹‰åªèƒ½æœ‰ä¸€ä¸ª `default`  é»˜è®¤å¯¼å‡ºã€‚**

- **åªæœ‰ `export default` å¯¼å‡ºçš„æ˜¯å…·ä½“å‡½æ•°åœ°å€ï¼Œå…¶ä½™ export éƒ½æ˜¯å¯¼å‡ºæ ‡è¯†ç¬¦ã€‚**

```js
// æƒ…å†µä¸€: å¯¼å‡ºçš„æ˜¯å…·ä½“å‡½æ•°
function foo() {...}
export default foo
                
// æƒ…å†µäºŒ: å¯¼å‡ºçš„æ˜¯å…·ä½“å‡½æ•°
export default function foo() {...}

// æƒ…å†µä¸‰: å¯¼å‡ºçš„æ˜¯fooæ ‡è¯†ç¬¦
function foo() {...}
export { foo as default }
```

`export default ..` æ¥æ”¶ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯¼å‡ºçš„æ˜¯è¿™ä¸ªè¡¨è¾¾å¼è¿”å›åœ°å€å€¼ã€‚

æƒ…å†µä¸€ å’Œ æƒ…å†µäºŒï¼šé»˜è®¤å¯¼å‡ºçš„æ˜¯ `foo` ç»‘å®šçš„é‚£ä¸ªè¡¨è¾¾å¼åœ°å€ï¼Œè€Œä¸æ˜¯æ ‡è¯†ç¬¦ `foo`ã€‚è¿™æ„å‘³ç€å¦‚æœåç»­ä»£ç æŠŠ `foo` ä¿®æ”¹å¼•ç”¨äº†å…¶ä»–å‡½æ•° / å˜é‡ï¼Œé»˜è®¤å¯¼å‡ºçš„ä¾ç„¶æ˜¯æœ€åˆçš„é‚£ä¸ªå‡½æ•°ã€‚

- æƒ…å†µä¸€å’Œæƒ…å†µäºŒï¼Œæ˜¯ä¸¤ç§ä¸åŒçš„è¡¨è¾¾æ–¹å¼ï¼Œé€šå¸¸ä¼šä½¿ç”¨æ›´ç®€æ´çš„æƒ…å†µäºŒã€‚

æƒ…å†µä¸‰ï¼šé»˜è®¤å¯¼å‡ºçš„æ˜¯æ ‡è¯†ç¬¦ `foo`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåç»­å¦‚æœæŠŠ `foo` æ ‡è¯†ç¬¦å¼•ç”¨åˆ«çš„å‡½æ•° / å˜é‡ï¼Œå¯¼å‡ºçš„å€¼ä¹Ÿå°±è·Ÿç€å‘ç”Ÿæ”¹å˜ï¼Œ



#### 3 è¿ç»­å¯¼å‡º

è¿ç»­å¯¼å‡ºï¼Œå½“ä»ä¸€ä¸ªæ¨¡å—å¯¼å…¥ä¸€äº›å‡½æ•° / å˜é‡åï¼Œå¯ä»¥é€‰æ‹©å†æ¬¡å°†å®ƒä»¬å¯¼å‡ºï¼š

```js
export {foo, bar} from "baz";
export {foo as f, bar as b} from "baz";
export * from "baz";
```



### 2.2 import å¯¼å…¥

å¯¼å…¥ä¸€ä¸ªæ¨¡å— API çš„æŸä¸ªç‰¹å®šæˆå‘˜åˆ°å½“å‰æ¨¡å—çš„é¡¶å±‚ä½œç”¨åŸŸä¸­ã€‚

```js
import {foo, bar, baz} from "foo";

// æ”¯æŒé‡å‘½å
import {foo as f} from "foo";

// åªæœ‰ä¸€ä¸ªå¯¼å…¥æ¨¡å—æ—¶ï¼Œçœç•¥æ‹¬å·
import foo from "foo";

// æŠŠfoo.js é»˜è®¤å¯¼å‡º å’Œ å‘½åå¯¼å‡º çš„æˆå‘˜ï¼Œå…¨éƒ¨ä¸€èµ·å¯¼å…¥ï¼š
import defaultFoo, {bar, baz as b} from "foo";
// defaultFoo å°±æ˜¯é»˜è®¤å¯¼å‡ºçš„æˆå‘˜ï¼Œæ­¤ä¸ºå¯¹è¿™ä¸ªæˆå‘˜è¿›è¡Œå‘½å
```



**å‘½åç©ºé—´å¯¼å…¥ namespace import**

```js
import * as foo from "foo"

// è¯¥æ–¹å¼å¿…é¡»ç”¨é€šé…ç¬¦ï¼Œä¸å¯ä»¥åƒä¸‹é¢è¿™æ ·åªå¯¼å…¥ä¸€éƒ¨åˆ†ï¼š
import {bar,baz} as foo from "foo"
```

è¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼š

1. æŠŠ `foo.js` æ–‡ä»¶ä¸­ï¼Œå¯¼å‡ºçš„æˆå‘˜å…¨éƒ¨å¯¼å…¥åˆ°å½“å‰æ¨¡å—ä¸­ï¼›
2. æŠŠè¿™äº›æˆå‘˜å…¨éƒ¨ç»‘å®šåˆ° `foo` å¯¹è±¡åä¸‹ã€‚

å¦‚æœå…¨éƒ¨å¯¼å…¥ä¸­ï¼Œæœ‰é»˜è®¤æˆå‘˜ï¼Œåˆ™è¿™ä¸ªé»˜è®¤æˆå‘˜çš„åç§°å°±æ˜¯ `default`ã€‚æ¯”å¦‚ä¸Šä¾‹ä¸­ï¼Œè¯¥æ¨¡å—ä¸­å¯¼å…¥çš„é»˜è®¤æˆå‘˜åç§°ä¸º `foo.default`ã€‚

æ‰€æœ‰å¯¼å…¥çš„æˆå‘˜æ˜¯åªè¯»çš„ï¼Œä¸å¯ä¿®æ”¹ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š`TypeError!`



































